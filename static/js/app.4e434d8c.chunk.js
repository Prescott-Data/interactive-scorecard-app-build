"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[2143],{75329:function(e,t,n){n.r(t),n.d(t,{default:function(){return W}});var r=n(36991),i=n(52618),o=n(39467),a=n(38976),l=n(21549),s=n(74529),c=n(88151),u=n(6341),d=n(96091),m=n(96692),g=n(51326),v=n(69995),f=n(30576),p=n(57193),h=n(7105),y=n(31648),A=n(13571),E=n(90527),S=n(81195);const w="4",b="cv";async function C(){if("caches"in window)try{const e=(await caches.keys()).filter((e=>e.includes("hisptz-scorecard"))).map((e=>caches.delete(e)));await Promise.all(e),console.log("Caches cleared")}catch(e){console.warn("Error clearing caches:",e)}}async function U(){if("serviceWorker"in navigator)try{const e=await navigator.serviceWorker.getRegistrations();for(const t of e)await t.unregister();console.log("Service workers unregistered")}catch(e){console.warn("Error unregistering service workers:",e)}}var D={initialize:async function(){const e=new URL(window.location.href),t=e.searchParams.get(b);if(t!==w){if(sessionStorage.setItem("scrollPosition",window.scrollY),t)return e.searchParams.set(b,w),void window.location.replace(e.toString());e.searchParams.set(b,w),window.history.replaceState({},"",e)}sessionStorage.getItem(`cacheCleared_${w}`)||(sessionStorage.setItem(`cacheCleared_${w}`,"true"),Promise.all([C(),U(),new Promise((e=>{setTimeout((()=>{!function(){try{const e=[];for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith("hisptz-scorecard")&&e.push(n)}e.forEach((e=>localStorage.removeItem(e))),sessionStorage.clear()}catch(e){console.warn("Error clearing storage:",e)}}(),e()}),1e3)}))]).catch(console.error)),console.log("Cache buster: Running version",w)}},k=n(40652),P=n(91394),T=n(98132),N=n(6585),I=n(97519),R=n(25435),O=n(20558),Z=n(29989);const L=S.lazy((()=>Promise.all([n.e(6520),n.e(8808)]).then(n.bind(n,88808)))),F=S.lazy((()=>Promise.all([n.e(2544),n.e(804),n.e(3331),n.e(7935)]).then(n.bind(n,97935)))),B=S.lazy((()=>Promise.resolve().then(n.bind(n,6585)).then((e=>({default:e.ScorecardView}))))),G=[{pathname:"/migrate",component:S.lazy((()=>n.e(3983).then(n.bind(n,33983))))},{pathname:"/edit/:id",component:F},{pathname:"/add",component:F},{pathname:"/view/:id",component:B},{pathname:"/",component:L}];function x(){return(0,R.useRecoilValue)(N.SystemSettingsState),S.createElement(O.UT,null,S.createElement(I.ErrorBoundary,{FallbackComponent:N.FullPageError},S.createElement(S.Suspense,{fallback:S.createElement(N.FullPageLoader,null)},S.createElement(Z.rs,null,G.map((e=>{let{pathname:t,component:n}=e;const r=n;return S.createElement(Z.AW,{key:t,path:t},S.createElement(I.ErrorBoundary,{FallbackComponent:N.FullPageError},S.createElement(r,null)))})),S.createElement(Z.AW,{path:"/*"},S.createElement(Z.l_,{to:"/"}))))))}var _=n(26874),V=JSON.parse('{"Welcome to Scorecard App!":"Welcome to Scorecard App!","Create a scorecard instantly, over tea break":"Create a scorecard instantly, over tea break","New Scorecard":"New Scorecard","Please select at least one organisation unit":"Please select at least one Project","Organisation Unit":"Project","Select Access":"Select Access","Add":"Add","Edit":"Edit","Delete":"Delete","Sharing":"Sharing","Shared With":"Shared With","Add Access":"Add Access","No Access":"No Access","Can Read":"Can Read","Can Read and Write":"Can Read and Write","Save":"Save","Cancel":"Cancel","Click to configure, drag to rearrange":"Click to configure, drag to rearrange","Click to {{linkAction}}":"Click to {{linkAction}}","unlink":"unlink","link":"link","Click to {{action}}, drag to rearrange":"Click to {{action}}, drag to rearrange","collapse":"collapse","expand":"expand","Add a data source":"Add a data source","Add Item":"Add Item","Organisation Unit(s)":"Project(s)","Change":"Change","Organisation Unit Specific Targets":"Project Specific Targets","Other Periods":"Other Periods","Update":"Update","Period Specific Targets":"Period Specific Targets","Period":"Period","Change Period":"Change Period","Organisation unit(s)":"Project(s)","Organisation unit levels":"Project levels","Legends":"Legends","Other Organisation Units":"Other Projects","Set Specific Targets":"Set Specific Targets","Specific target type":"Specific target type","Organisation Unit Level":"Project Level","Add Data source":"Add Data source","Please select at least one data source for this group":"Please select at least one data source for this group","Add Group":"Add Group","Configure Data Sources":"Configure Data Sources","Add a data source group":"Add a data source group","Modify the group name":"Modify the group name","Add different data sources to a group":"Add different data sources to a group","Click on a data source to configure it":"Click on a data source to configure it","View the changes on the preview panel above":"View the changes on the preview panel above","Select a data source to configure":"Select a data source to configure","Search for Indicator":"Search for Indicator","Groups":"Groups","Name":"Name","Label":"Label","Label is required":"Label is required","Weight":"Weight","Effective Gap":"Effective Gap","Display Arrows":"Display Arrows","High is Good":"High is Good","Show Colors":"Show Colors","Title":"Title","Title is required":"Title is required","A scorecard with the title \'{{value}}\' already exists. Please select another title":"A scorecard with the title \'{{value}}\' already exists. Please select another title","Subtitle":"Subtitle","Description":"Description","Period Type":"Period Type","Custom Header":"Custom Header","Additional Labels (Tags)":"Additional Labels (Tags)","Legend Definitions":"Legend Definitions","Year":"Year","Period type is required":"Period type is required","Fixed Periods":"Fixed Periods","Relative Periods":"Relative Periods","Highlighted Indicators":"Highlighted Indicators","Add Highlighted Indicator":"Add Highlighted Indicator","Scorecard updated successfully":"Scorecard updated successfully","Scorecard added successfully":"Scorecard added successfully","Please fill in all required fields":"Please fill in all required fields","Help":"Help","Saving":"Saving","Save and exit":"Save and exit","Save and continue":"Save and continue","Exit without saving":"Exit without saving","General":"General","Data Configuration":"Data Configuration","Access":"Access","Options":"Options","Scorecard deleted successfully":"Scorecard deleted successfully","Confirm scorecard delete":"Confirm scorecard delete","Are you sure you want to delete scorecard ":"Are you sure you want to delete scorecard ","View":"View","No scorecards found":"No scorecards found","Could not find scorecards matching the keyword ":"Could not find scorecards matching the keyword ","Start a guided tour":"Start a guided tour","Documentation":"Documentation","Search":"Search","Switch to {{viewType}} view":"Switch to {{viewType}} view","list":"list","grid":"grid","Add New Scorecard":"Add New Scorecard","Preparing migration...":"Preparing migration...","Migrating scorecards":"Migrating scorecards","of":"of"}');_.Z.addResources("en","default",V);n(27832);var M=()=>{const{initializeState:e}=(0,N.useInitApp)();return S.createElement(k.PH,{namespace:N.DATASTORE_NAMESPACE,loadingComponent:S.createElement(N.FullPageLoader,null)},S.createElement(P.z,null),S.createElement(R.RecoilRoot,{initializeState:e},S.createElement(I.ErrorBoundary,{FallbackComponent:N.FullPageError},S.createElement(T.G9,null,S.createElement(S.Suspense,{fallback:S.createElement(N.FullPageLoader,null)},S.createElement("div",{className:"main-container"},S.createElement(x,null)))))))},j="App_sidebar__EbNVl",Q="App_logo__h5EGN",z="App_menu__Y4oQE";const{Sider:Y,Content:J}=y.default,H={me:{resource:"me",params:{fields:["firstName","surname","email"]}}};var W=()=>{(0,S.useEffect)((()=>{D.initialize()}),[]);const[e,t]=(0,S.useState)(!1),[n,w]=(0,S.useState)(["3"]),{loading:b,error:C,data:U}=(0,h.u_)(H);if(b||C)return null;const{firstName:k,surname:P,email:T}=U.me,N=(null===k||void 0===k||k[0],null===P||void 0===P||P[0],S.createElement(A.Z,null,S.createElement(A.Z.Item,{key:"profile-settings",icon:S.createElement(r.Z,null)},S.createElement("a",{href:"/sims-web-user-profile/#/profile"},"Settings")),S.createElement(A.Z.Item,{key:"account",icon:S.createElement(i.Z,null)},S.createElement("a",{href:"/sims-web-user-profile/#/account"},"Account")),S.createElement(A.Z.Item,{key:"logout",icon:S.createElement(o.Z,null)},S.createElement("a",{href:"/dhis-web-commons-security/logout.action"},"Logout")))),I=(a.Z,a.Z,a.Z,a.Z,[{key:"5.1",icon:S.createElement(l.Z,null),label:S.createElement("a",{href:"/sims-web-usage-analytics/"},"Usage Analytics")},{key:"5.2",icon:S.createElement(s.Z,null),label:S.createElement("a",{href:"/sims-web-user/"},"User Management")},{key:"5.3",icon:S.createElement(r.Z,null),label:S.createElement("a",{href:"/sims-web-settings/"},"System Settings")},{key:"5.4",icon:S.createElement(a.Z,null),label:S.createElement("a",{href:"/sims-web-maintenance/#/organisationUnitSection/hierarchy"},"Hierarchy Operations")}]),R=[{key:"3.1",label:S.createElement("a",{href:"/sims-web-capture/"},"Forms"),icon:S.createElement(c.Z,null)},{key:"3.2",label:S.createElement("a",{href:"/sims-web-aggregate-data-entry/"},"Spreadsheets"),icon:S.createElement(u.Z,null)},{key:"3.3",label:S.createElement("a",{href:"/sims-web-import-export/"},"Data Import & Export"),icon:S.createElement(d.Z,null)}];return S.createElement(y.default,{style:{height:"100vh"}},S.createElement(Y,{trigger:null,collapsible:!0,width:"20%",collapsedWidth:80,collapsed:e,onCollapse:e=>t(e),breakpoint:"lg",onBreakpoint:e=>t(e),className:j,style:{padding:"10px 0",transition:"width 0.2s",background:"#003D8F",borderRight:"1px solid #d9d9d9",overflow:"hidden"}},S.createElement("div",{style:{display:"flex",flexDirection:"column",background:"#003D8F",height:"100%"}},S.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:"10px",flexShrink:0}},S.createElement("div",{className:Q,style:{flexDirection:e&&"column-reverse"}},S.createElement(E.ZP,{type:"text",className:"",icon:S.createElement(m.Z,{fontSize:"medium"}),onClick:()=>t(!e),style:{width:"16px",height:"16px",color:"#fff"}}),S.createElement("div",null,S.createElement("img",{src:"./sims-sidebar-logo.png",alt:"SIMS",style:{width:e?"30px":"40px",height:e?"30px":"40px",objectFit:"cover",transition:"all 0.2s",filter:"brightness(0) invert(1)"}})))),S.createElement("div",{style:{overflowY:"auto",overflowX:"hidden",display:"flex",flexDirection:"column",height:"100%"}},S.createElement(A.Z,{selectedKeys:["1"],openKeys:n,onOpenChange:e=>{const t=e.find((e=>!n.includes(e)));["2","5"].includes(t)?w(t?[t]:[]):w(e)},style:{height:"100%"},className:z,defaultSelectedKeys:["1"],defaultOpenKeys:["sub1"],mode:"inline",inlineCollapsed:e},S.createElement(A.Z.Item,{key:"1",icon:S.createElement(g.Z,null)},S.createElement("a",{href:"/sims-web-app/"},"Home")),S.createElement(A.Z.Divider,null),S.createElement(A.Z.SubMenu,{key:"2",icon:S.createElement(v.Z,null),title:"Activation"},S.createElement(A.Z.Item,{key:"2.1",title:"Thematic Areas",icon:S.createElement(a.Z,null)},S.createElement("a",{href:"/sims-web-maintenance/#/list/organisationUnitSection/organisationUnit"},"Thematic Areas")),S.createElement(A.Z.Item,{key:"2.2",icon:S.createElement(a.Z,null)},S.createElement("a",{href:"/sims-web-maintenance/#/list/organisationUnitSection/programsHierarchy"},"Programs")),S.createElement(A.Z.Item,{key:"2.3",icon:S.createElement(a.Z,null)},S.createElement("a",{href:"/sims-web-maintenance/#/list/programSection/program"},"Projects")),S.createElement(A.Z.Item,{key:"2.4",icon:S.createElement(a.Z,null)},S.createElement("a",{href:"/sims-web-maintenance/#/list/dataElementSection/dataElement"},"Data Elements")),S.createElement(A.Z.Item,{key:"2.5",icon:S.createElement(a.Z,null)},S.createElement("a",{href:"/sims-web-maintenance/#/list/dataSetSection/dataSet"},"Data Sets"))),S.createElement(A.Z.Divider,null),S.createElement(A.Z.SubMenu,{key:"3",icon:S.createElement(f.Z,null),title:"Data Collection"},R.map((e=>S.createElement(A.Z.Item,{key:e.key,icon:e.icon},e.label)))),S.createElement(A.Z.Divider,null),S.createElement(A.Z.Item,{key:"4",icon:S.createElement(p.Z,null)},S.createElement("a",{href:"/sims-web-dashboard/"},"Visualization")),S.createElement(A.Z.Divider,null),S.createElement(A.Z.SubMenu,{key:"5",icon:S.createElement(i.Z,null),title:"Admin Centre",style:{marginTop:"auto"}},I.map((e=>S.createElement(A.Z.Item,{key:e.key,icon:e.icon},e.label)))))),S.createElement("div",null,N))),S.createElement(y.default,{style:{padding:"0 15px 15px 15px",height:"100vh",overflow:"hidden"}},S.createElement("div",{style:{backgroundColor:"#F9FAFB",borderRadius:"8px",padding:"10px 16px"}}),S.createElement(J,{style:{margin:0,display:"flex",flexDirection:"column",padding:0,height:"100%",overflow:"auto"}},S.createElement(M,null))))}},81589:function(e,t,n){n.d(t,{Z:function(){return y}});var r=n(26874),i=n(22020),o=n(53040),a=n(86900),l=n(13488),s=n(98914),c=n(86837),u=n(44464),d=n(99136),m=n(55112),g=n(477),v=n.n(g),f=n(81195),p=n(29989);function h(e){let{error:t,onClose:n}=e;const{details:u}=null!==t&&void 0!==t?t:{};return f.createElement(i.u,{position:"middle",onClose:n},f.createElement(o.r,null,r.Z.t("Error Details")),f.createElement(a.h,null,f.createElement("div",{style:{background:l.O.grey050,padding:24,border:`1px solid ${l.O.grey300}`}},f.createElement("code",{style:{fontSize:14}},JSON.stringify(u)))),f.createElement(s.n,null,f.createElement(c.z,{onClick:n},r.Z.t("Close"))))}function y(e){var t,n;let{error:i,resetErrorBoundary:o}=e;const[a,s]=(0,f.useState)(!1),g=(0,p.k6)(),v=()=>{o?o():window.location.reload()};return f.createElement("div",{className:"column center ",style:{height:"100%",textAlign:"center"}},f.createElement(u.M,null,f.createElement("div",{className:"column align-items-center"},f.createElement(m.Z,{style:{color:l.O.grey700,fontSize:64},fontSize:"large"}),f.createElement("h2",{style:{color:l.O.grey700,margin:8}},null!==(t=null===i||void 0===i?void 0:i.title)&&void 0!==t?t:r.Z.t("Something Went Wrong")),f.createElement("p",{style:{color:l.O.grey700}},"string"===typeof i?i:null===i||void 0===i?void 0:i.message),f.createElement(d.J,{center:!0},404===(null===i||void 0===i||null===(n=i.details)||void 0===n?void 0:n.httpStatusCode)?f.createElement(c.z,{primary:!0,onClick:()=>{g?null===g||void 0===g||g.replace("/"):v()}},r.Z.t("Back to scorecard list")):f.createElement(c.z,{onClick:v},r.Z.t("Refresh")),(null===i||void 0===i?void 0:i.details)&&f.createElement(c.z,{onClick:()=>s(!0)},r.Z.t("View error logs")))),a&&f.createElement(h,{error:i,onClose:()=>s(!1)})))}h.propTypes={error:v().object.isRequired,onClose:v().func.isRequired},y.propTypes={error:v().any,resetErrorBoundary:v().func}},69948:function(e,t,n){n.d(t,{Z:function(){return a}});var r=n(44464),i=n(84415),o=n(81195);function a(){return o.createElement("div",{className:"w-100 h-100"},o.createElement(r.M,null,o.createElement(i.V,{small:!0})))}},48439:function(e,t,n){n.d(t,{B:function(){return l},M:function(){return a}});var r=n(477),i=n.n(r),o=n(81195);const a=e=>{let{x:t,y:n,decreasing:r,fontSize:i}=e;return o.createElement("path",{d:`M ${t} ${n} L ${t-i/2} ${n+i} L ${t+i/2} ${n+i} Z`,fill:"black",transform:r&&"rotate(90)"})};a.propTypes={fontSize:i().number.isRequired,x:i().number.isRequired,y:i().number.isRequired,decreasing:i().bool};const l=e=>{let{x:t,y:n,fontSize:r}=e;return o.createElement("path",{d:`M ${t} ${n} L ${t-r/2} ${n-r} L ${t+r/2} ${n-r} Z`,fill:"black"})};l.propTypes={fontSize:i().number.isRequired,x:i().number.isRequired,y:i().number.isRequired}},57081:function(e,t,n){n.d(t,{I:function(){return C},Z:function(){return U}});var r=n(26874),i=n(22020),o=n(53040),a=n(86900),l=n(84415),s=n(98914),c=n(86837),u=n(69987),d=n(477),m=n.n(d),g=n(81195),v=n(25435),f=n(13488),p=n(21386),h=n(19511);function y(e){let{legends:t}=e;const n=(0,v.useRecoilValue)((0,h.jw)("legendDefinitions"));return g.createElement("div",{className:"column gap-8"},g.createElement("table",null,g.createElement("col",{width:"60%"}),g.createElement("col",{width:"20%"}),g.createElement("col",{width:"20%"}),g.createElement("thead",null,g.createElement("tr",null,g.createElement("th",{align:"left"},r.Z.t("Legend")),g.createElement("th",null,r.Z.t("Min")),g.createElement("th",null,r.Z.t("Max")))),g.createElement("tbody",null,null===t||void 0===t?void 0:t.map((e=>{const t=(0,u.find)(n,{id:e.legendDefinitionId});return g.createElement("tr",{key:`${e.id}-view`},g.createElement("td",null,g.createElement("table",null,g.createElement("col",{width:"20%"}),g.createElement("col",{width:"80%"}),g.createElement("tbody",null,g.createElement("tr",null,g.createElement("td",null,g.createElement("div",{style:{height:24,width:32,background:t.color}})),g.createElement("td",null,t.name))))),g.createElement("td",{align:"center"},null===e||void 0===e?void 0:e.startValue),g.createElement("td",{align:"center"},null===e||void 0===e?void 0:e.endValue))})))))}function A(e){var t;let{dataSourceLabel:n,specificTarget:i}=e;const{items:o,legends:a}=null!==i&&void 0!==i?i:{},l=(0,v.useRecoilValue)((0,h.YI)(o));return g.createElement("div",{style:{maxWidth:350,border:`1px solid ${f.O.grey600}`,borderRadius:4},className:"column gap-16 p-16"},g.createElement("div",{className:"column gap-16"},g.createElement("div",null,g.createElement("b",null,r.Z.t("Organisation Unit(s)"),": ")," ",null===l||void 0===l||null===(t=l.map((e=>e.displayName)))||void 0===t?void 0:t.join(", ")),g.createElement("div",null,g.createElement("b",null,r.Z.t("Data Source"),": "),n)),g.createElement(y,{legends:a}))}function E(e){var t;let{dataSourceLabel:n,specificTarget:i}=e;const{items:o,legends:a}=null!==i&&void 0!==i?i:{};return g.createElement("div",{style:{maxWidth:350,border:`1px solid ${f.O.grey600}`,borderRadius:4},className:"column gap-16 p-16"},g.createElement("div",{className:"column gap-16"},g.createElement("div",null,g.createElement("b",null,r.Z.t("Period"),": ")," ",null===o||void 0===o||null===(t=o.map((e=>{var t;return null===(t=(new p.Period).setPreferences({allowFuturePeriods:!0}).getById(e))||void 0===t?void 0:t.name})))||void 0===t?void 0:t.join(", ")),g.createElement("div",null,g.createElement("b",null,r.Z.t("Data Source"),": "),n)),g.createElement(y,{legends:a}))}function S(e){let{dataSourceLabel:t,legends:n}=e;const i=(0,v.useRecoilValue)(h.Ee);return g.createElement(g.Fragment,null,g.createElement("div",{className:"row gap-16 page-break-avoid"},null===i||void 0===i?void 0:i.map((e=>{var i;return g.createElement(g.Fragment,null,g.createElement("div",{key:`${e.id}- specific-level-view`,style:{maxWidth:350,border:`1px solid ${f.O.grey600}`,borderRadius:4},className:"column gap-16 p-16"},g.createElement("div",{className:"column gap-16"},g.createElement("div",null,g.createElement("b",null,r.Z.t("Organisation Unit Level"),": ")," ",null!==(i=e.displayName)&&void 0!==i?i:e.name),g.createElement("div",null,g.createElement("b",null,r.Z.t("Data Source"),": "),t)),g.createElement(y,{legends:n[e.id]})),g.createElement("div",{className:"page-break"}))}))),g.createElement("div",{className:"page-break"}))}y.propTypes={legends:m().array},S.propTypes={dataSourceLabel:m().string,legends:m().object},A.propTypes={dataSourceLabel:m().string,specificTarget:m().object},E.propTypes={dataSourceLabel:m().string,specificTarget:m().object};var w={"specific-targets-lib":"SpecificTargetsLibrary_specific-targets-lib__Fce6Y"},b=n(62685);function C(){var e,t,n;const{dataGroups:i}=(0,v.useRecoilValue)((0,h.jw)("dataSelection")),o=(0,g.useMemo)((()=>(0,b.on)(i)),[i]),a=(0,g.useMemo)((()=>{const e=(0,u.filter)(o,(e=>e.specificTargetsSet)),t=(0,u.groupBy)((0,u.filter)(e,(e=>!(0,u.isEmpty)(e.specificTargets))),(e=>{var t;return null===(t=(0,u.head)(e.specificTargets))||void 0===t?void 0:t.type}));return t.orgUnitLevel=e.filter((e=>(0,u.isEmpty)(e.specificTargets))),t}),[o]);return g.createElement(g.Fragment,null,g.createElement("div",{className:"column gap-16"},!(0,u.isEmpty)(null===a||void 0===a?void 0:a.orgUnit)&&g.createElement("div",null,g.createElement("h3",null,r.Z.t("Organisation Units Specific targets")),g.createElement("div",{className:"row gap-16"},null===a||void 0===a||null===(e=a.orgUnit)||void 0===e?void 0:e.map((e=>g.createElement(g.Fragment,null,g.createElement(A,{key:`${e.id}-orgUnit-specific-target`,specificTarget:(0,u.head)(e.specificTargets),dataSourceLabel:e.label}),g.createElement("div",{className:"page-break"}))))),g.createElement("div",{className:"page-break"})),!(0,u.isEmpty)(null===a||void 0===a?void 0:a.period)&&g.createElement("div",null,g.createElement("h3",null,r.Z.t("Period Specific targets")),g.createElement("div",{className:"row gap-16"},null===a||void 0===a||null===(t=a.period)||void 0===t?void 0:t.map((e=>g.createElement(g.Fragment,null,g.createElement(E,{key:`${e.id}-orgUnit-specific-target`,specificTarget:(0,u.head)(e.specificTargets),dataSourceLabel:e.label}),g.createElement("div",{className:"page-break"}))))),g.createElement("div",{className:"page-break"})),!(0,u.isEmpty)(null===a||void 0===a?void 0:a.orgUnitLevell)&&g.createElement("div",null,g.createElement("h3",null,r.Z.t("Organisation unit level targets")),g.createElement("div",{className:"column gap-16"},null===a||void 0===a||null===(n=a.orgUnitLevel)||void 0===n?void 0:n.map((e=>g.createElement(S,{key:`${e.id}-orgUnit-specific-target`,legends:e.legends,dataSourceLabel:e.label})))),g.createElement("div",{className:"page-break"}))))}function U(e){let{open:t,onClose:n}=e;return g.createElement(i.u,{onClose:n,className:w["specific-targets-lib"],large:!0,position:"middle",hide:!t},g.createElement(o.r,null,"Specific Targets Library"),g.createElement(a.h,null,g.createElement(g.Suspense,{fallback:g.createElement("div",{className:"column align-items-center justify-content-center",style:{height:"60vh",width:"100%"}},g.createElement(l.V,{small:!0}))},g.createElement(C,null))),g.createElement(s.n,null,g.createElement(c.z,{onClick:n},r.Z.t("Cancel"))))}U.propTypes={open:m().bool.isRequired,onClose:m().func.isRequired}},74073:function(e,t,n){n.d(t,{Xx:function(){return p},k8:function(){return me},BL:function(){return ge.B},Pz:function(){return Ae},Lb:function(){return he},yM:function(){return de.Z},By:function(){return g},WW:function(){return M},Mz:function(){return ge.M},VB:function(){return fe},C7:function(){return pe.Z},Rs:function(){return j},u2:function(){return z},yy:function(){return ue},$T:function(){return ve}});var r=n(26874),i=n(69987),o=n(81195),a=n(29989),l=n(25435),s=n(44464),c=n(84415),u=n(13488),d=n(477),m=n.n(d);function g(e){let{text:t,small:n}=e;return o.createElement("div",{className:"column center",style:{height:"100%",width:"100%"}},o.createElement(s.M,null,o.createElement("div",null,o.createElement(c.V,{small:n}),o.createElement("p",{style:{color:u.O.default}},t))))}g.propTypes={small:m().bool,text:m().string};var v=n(86837),f=n(53386);function p(e){let{accessType:t}=e;const n=(0,a.k6)();return o.createElement("div",{className:"column center align-items-center w-100 h-100"},o.createElement(s.M,null,o.createElement("div",{className:"column align-items-center"},o.createElement(f.Z,{style:{color:u.O.grey700,fontSize:64},fontSize:"large"}),o.createElement("p",{style:{color:u.O.grey700,fontWeight:"bold",fontSize:"1vw"}},r.Z.t("You do not have access to {{accessType}} this Scorecard",{accessType:t})),o.createElement(v.z,{primary:!0,onClick:()=>{n.replace("/")}},r.Z.t("Back to scorecard list")))))}function h(){return o.createElement("div",{className:"flex-1 column center align-items-center"},o.createElement("h2",{style:{color:u.O.grey700}},r.Z.t("Select Organisation Units and Period to start")))}p.propTypes={accessType:m().oneOf(["edit","view"]).isRequired};var y=n(19511),A=n(62685);function E(e){var t;let{highlightedIndicator:n}=e;const r=(0,l.useRecoilValue)(y.Ee),i=(0,l.useRecoilValue)((0,y.jw)("legendDefinitions")),a=(0,l.useRecoilValue)((0,y.L4)(!0)),{displayName:s,legends:c,id:u,weight:d}=null!==n&&void 0!==n?n:{},m=(0,l.useRecoilValue)((0,y.zT)(u)),{color:g}=null!==(t=(0,A.EM)(m,c,{max:d,defaultLegends:a,orgUnitLevels:r,dataOrgUnitLevel:1,legendDefinitions:i}))&&void 0!==t?t:{};return o.createElement("div",{style:{background:"white",border:"1px solid rgb(232, 237, 242)",margin:8}},o.createElement("div",{id:"test-highlighted-indicator",className:"row flex-1 space-between align-items-center"},o.createElement("p",{style:{margin:0,padding:"0 8px",fontSize:14}},s),o.createElement("div",{style:{width:60,minHeight:"100%",background:g,padding:16,display:"flex",alignItems:"center",justifyContent:"center"}},o.createElement("p",{style:{fontSize:14,margin:0}},m))))}function S(){var e,t,n,a;const s=(0,l.useRecoilValue)((0,y.jw)("highlightedIndicators")),{highlightedIndicators:u}=null!==(e=(0,l.useRecoilValue)((0,y.jw)("options")))&&void 0!==e?e:{},{state:d,contents:m}=(0,l.useRecoilValueLoadable)(y.Hu);return u&&!(0,i.isEmpty)(s)?o.createElement("div",{className:"column"},o.createElement("div",null,o.createElement("h3",null,r.Z.t("Highlighted Indicators"))),"loading"===d&&o.createElement("div",{className:"row center align-items-center p-16"},o.createElement(c.V,{small:!0})),"hasError"===d&&o.createElement("div",{className:"row center align-items-center"},o.createElement(ErrorIcon,{size:24}),o.createElement("div",{style:{paddingLeft:16}},null!==(t=null!==(n=null!==(a=null===m||void 0===m?void 0:m.message)&&void 0!==a?a:null===m||void 0===m?void 0:m.details)&&void 0!==n?n:m.toString())&&void 0!==t?t:"Error")),"hasValue"===d&&o.createElement("div",{className:"grid highlighted-indicators-container"},null===s||void 0===s?void 0:s.map((e=>o.createElement(E,{key:null===e||void 0===e?void 0:e.id,highlightedIndicator:e}))))):null}E.propTypes={highlightedIndicator:m().object.isRequired};var w=n(99136),b=n(19465),C=n(89020),U=n(13414),D=n(42622);function k(e){var t;let{onClose:n,onDownload:i}=e;return o.createElement(C.q,{dataTest:"download-menu"},null===(t=Object.values(D.UX))||void 0===t?void 0:t.map((e=>o.createElement(U.s,{dataTest:`${e}-download-menu`,onClick:()=>{i(e),n()},key:`${e}-download-menu`,label:e}))),o.createElement(U.s,{dataTest:"ALMA-download-menu",label:"ALMA"},o.createElement(U.s,{dataTest:"test-alma-data-json",label:`${r.Z.t("Data")}(JSON)`,onClick:()=>{i("ALMAData"),n()}}),o.createElement(U.s,{dataTest:"test-alma-meta-data",label:r.Z.t("Metadata"),onClick:()=>{i("ALMAMeta"),n()}})))}k.propTypes={onClose:m().func.isRequired,onDownload:m().func.isRequired};var P=n(7105),T=n(13409),N=n(92558),I=n(5164);function R(e){let{periods:t,data:n,orgUnits:r,dataHolders:o,title:a,type:l}=e;try{const e=function(e){let{periods:t=[],data:n={},orgUnits:r=[],dataSources:i=[]}=e;return null===r||void 0===r?void 0:r.map((e=>{let{displayName:r,id:o}=e;const a={"Organisation Unit":r};for(const s of i){const{id:e,displayName:r,label:i}=null!==s&&void 0!==s?s:{};for(const s of t){var l;const{id:t,name:c}=null!==s&&void 0!==s?s:{};a[`${null!==r&&void 0!==r?r:i}-${c}`]=null===(l=n[`${e}_${o}_${t}`])||void 0===l?void 0:l.current}}return a}))}({periods:t,data:n,orgUnits:r,dataSources:(0,i.flatten)(null===o||void 0===o?void 0:o.map((e=>{let{dataSources:t}=e;return t})))}),s=I.P6.json_to_sheet(e),c=I.P6.book_new();I.P6.book_append_sheet(c,s,`${a}`),(0,I.NC)(c,`${a}.${l}`)}catch(s){return s}}function O(e){let{orgUnits:t,dataSources:n,periods:o,legendDefinitions:a}=e;function l(e){if(Array.isArray(e))return null===e||void 0===e?void 0:e.map((e=>{var t;let{startValue:n,endValue:r,legendDefinitionId:o}=e;return{min:n,max:r,color:null===(t=(0,i.find)(a,["id",o]))||void 0===t?void 0:t.color}}));{const t={};return(0,i.forIn)(e,((e,n)=>{t[n]=null===e||void 0===e?void 0:e.map((e=>{var t;let{startValue:n,endValue:r,legendDefinitionId:o}=e;return{min:n,max:r,color:null===(t=(0,i.find)(a,["id",o]))||void 0===t?void 0:t.color}}))})),t}}return{dimensions:function(e,t,n){return{ou:null===e||void 0===e?void 0:e.map((e=>{let{id:t}=e;return t})),pe:null===n||void 0===n?void 0:n.map((e=>{let{id:t}=e;return t})),dx:null===t||void 0===t?void 0:t.map((e=>{let{id:t}=e;return t})),co:[]}}(t,n,o),items:function(e,t){const n={};for(const r of t){const{displayName:e,id:t,legends:o}=null!==r&&void 0!==r?r:{};(0,i.set)(n,[t],{name:e,legendSet:l(o)})}for(const r of e){const{id:e,displayName:t}=null!==r&&void 0!==r?r:{};(0,i.set)(n,[e],{name:t})}return(0,i.set)(n,"dx",{name:r.Z.t("Data")}),(0,i.set)(n,"pe",{name:r.Z.t("Period")}),(0,i.set)(n,"ou",{name:r.Z.t("Organisation Unit")}),n}(t,n)}}function Z(e){const t=[];return(0,i.forIn)(e,((e,n)=>{const[r,i,o]=null===n||void 0===n?void 0:n.split("_");t.push([r,o,i,null===e||void 0===e?void 0:e.current])})),t}function L(e,t){const n=(0,l.useRecoilValue)((0,y.jw)("title")),r=(0,l.useRecoilValue)((0,y.jw)("legendDefinitions")),a=(0,l.useRecoilValueLoadable)(y.R6),s=(0,o.useMemo)((()=>{var e;return"hasValue"===a.state?null===(e=a.contents)||void 0===e?void 0:e.orgUnits:[]}),[a]),c=(0,o.useMemo)((()=>null===s||void 0===s?void 0:s.map((e=>{let{id:t}=e;return t}))),[s]),{filteredOrgUnits:u,childrenOrgUnits:d}=(0,l.useRecoilValue)((0,y.z)(c)),m=(0,l.useRecoilValue)(y.ip),g=(0,o.useMemo)((()=>[...u,...d]),[u,d]),v=(0,l.useRecoilValue)(y.gi),f=(0,l.useRecoilValue)((0,y.Mm)(c)),[p,h]=(0,o.useState)(),{show:A}=(0,P.VY)((e=>{let{message:t}=e;return t}),(e=>{let{type:t}=e;return{...t,duration:3e3}})),E=(0,T.useReactToPrint)({content:()=>null===e||void 0===e?void 0:e.current,documentTitle:`${n}`});(0,o.useEffect)((function(){if(void 0!==f&&!f&&"hasValue"===a.state){const e=t.getAllOrgUnitData(null===g||void 0===g?void 0:g.map((e=>{let{id:t}=e;return t}))).subscribe(h);return()=>e.unsubscribe()}}),[f,g,t]);const S=e=>{if(void 0!==f&&!f&&"hasValue"===a.state)switch(e){case D.UX.EXCEL:return function(e){let{periods:t,data:n,orgUnits:r,dataHolders:i,title:o}=e;return R({periods:t,data:n,orgUnits:r,dataHolders:i,title:o,type:"xlsx"})}({periods:v,data:p,orgUnits:g,dataHolders:m,title:n});case D.UX.CSV:return function(e){let{periods:t,data:n,orgUnits:r,dataHolders:i,title:o}=e;return R({periods:t,data:n,orgUnits:r,dataHolders:i,title:o,type:"csv"})}({periods:v,data:p,orgUnits:g,dataHolders:m,title:n});case D.UX.PDF:return E();case"ALMAData":return function(e){let{periods:t,data:n,orgUnits:r,dataHolders:o,title:a,legendDefinitions:l}=e;try{const e=JSON.stringify({dataValues:[{headers:D.zi,metaData:O({orgUnits:r,dataSources:(0,i.flatten)(null===o||void 0===o?void 0:o.map((e=>{let{dataSources:t}=e;return t}))),periods:t,legendDefinitions:l}),rows:Z(n)}]}),s=new Blob([e],{type:"application/json"});(0,N.saveAs)(s,`${a}.json`)}catch(s){return s}}({periods:v,data:p,orgUnits:s,dataHolders:m,title:n,legendDefinitions:r});case"ALMAMeta":return function(e){let{orgUnits:t,dataHolders:n,title:r}=e;try{const e=JSON.stringify({organisationUnits:null===t||void 0===t?void 0:t.map((e=>{var t,n;let{id:r,level:i,displayName:o,path:a}=e;const l=a.split("/"),s=l.length>=2&&null!==(t=null===l||void 0===l?void 0:l[l.length-2])&&void 0!==t?t:"";return{id:r,name:o,level:null!==i&&void 0!==i?i:(null===a||void 0===a||null===(n=a.split("/"))||void 0===n?void 0:n.length)-1,parent:l.length<=2?{id:s}:void 0}})),indicators:(0,i.flatten)(null===n||void 0===n?void 0:n.map((e=>{let{dataSources:t}=e;return null===t||void 0===t?void 0:t.map((e=>{let{id:t,displayName:n}=e;return{id:t,name:n}}))})))}),o=new Blob([e],{type:"application/json"});(0,N.saveAs)(o,`${r}-metadata.json`)}catch(o){return o}}({orgUnits:g,dataHolders:m,title:n});default:return}};return{download:e=>{const t=S(e);var n,r;t&&A({message:null!==(n=null!==(r=null===t||void 0===t?void 0:t.message)&&void 0!==r?r:t.details)&&void 0!==n?n:null===t||void 0===t?void 0:t.toString()})}}}var F=n(22020),B=n(53040),G=n(86900),x=n(98914),_=n(60509),V=n(27731);function M(e){let{helpSteps:t}=e;const n=(0,l.useSetRecoilState)(y.QY);return(0,o.useEffect)((()=>(n((e=>[...e,...t])),()=>{n((e=>{const n=[...e];return(0,i.pullAllWith)(n,t,i.isEqual),n}))})),[t]),null}function j(e){let{options:t,onChange:n}=e;return o.createElement("div",{className:"container p-16"},o.createElement(M,{helpSteps:D.CP}),o.createElement("div",{className:"row"},o.createElement("div",{className:"column "},o.createElement("h3",null,r.Z.t("Visibility")),o.createElement("div",{className:"column visibility-options"},o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.legend,onChange:n("legend"),value:"legend",label:r.Z.t("Legend")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.title,onChange:n("title"),value:"title",label:r.Z.t("Title")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.itemNumber,onChange:n("itemNumber"),value:"itemNumber",label:r.Z.t("Item Number")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.emptyRows,onChange:n("emptyRows"),value:"emptyRows",label:r.Z.t("Empty Rows")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.showHierarchy,onChange:n("showHierarchy"),value:"showHierarchy",label:r.Z.t("Show Hierarchy")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.averageColumn,onChange:n("averageColumn"),value:"averageColumn",label:r.Z.t("Average Column")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.averageRow,onChange:n("averageRow"),value:"averageRow",label:r.Z.t("Average Row")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.highlightedIndicators,onChange:n("highlightedIndicators"),value:"highlightedIndicators",label:r.Z.t("Highlighted Indicators")})),o.createElement("h3",null,r.Z.t("Average")),o.createElement("div",{className:"column average-options"},o.createElement(V.Y,{onChange:()=>n("averageDisplayType")(D.PG.ALL),checked:(null===t||void 0===t?void 0:t.averageDisplayType)===D.PG.ALL,value:D.PG.ALL,label:r.Z.t("All")}),o.createElement(V.Y,{onChange:()=>n("averageDisplayType")(D.PG.BELOW_AVERAGE),checked:(null===t||void 0===t?void 0:t.averageDisplayType)===D.PG.BELOW_AVERAGE,value:D.PG.BELOW_AVERAGE,label:r.Z.t("Below Average")}),o.createElement(V.Y,{onChange:()=>n("averageDisplayType")(D.PG.ABOVE_AVERAGE),checked:(null===t||void 0===t?void 0:t.averageDisplayType)===D.PG.ABOVE_AVERAGE,value:D.PG.ABOVE_AVERAGE,label:r.Z.t("Above Average")})),o.createElement("h3",null,r.Z.t("Options")),o.createElement("div",{className:"column other-options"},o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.arrows,onChange:n("arrows"),value:"arrows",label:r.Z.t("Arrows")}),o.createElement(_.j,{checked:null===t||void 0===t?void 0:t.showDataInRows,onChange:n("showDataInRows"),value:"showDataInRows",label:r.Z.t("Show Data in Rows")})))))}M.propTypes={helpSteps:m().arrayOf(m().object).isRequired},j.propTypes={options:m().object.isRequired,onChange:m().func.isRequired};var Q=n(23985);function z(e){let{onSelect:t,onClose:n,initialValues:i}=e;const[a,l]=(0,o.useState)(i);return o.createElement(F.u,{onClose:n,large:!0},o.createElement(B.r,null,r.Z.t("Options")),o.createElement(G.h,null,o.createElement("div",{className:"column"},o.createElement(j,{options:a,onChange:e=>t=>{l((n=>{var r;return Q.TI.set(n,e,null!==(r=null===t||void 0===t?void 0:t.checked)&&void 0!==r?r:t)}))}}))),o.createElement(x.n,null,o.createElement(w.J,null,o.createElement(v.z,{onClick:n},r.Z.t("Cancel")),o.createElement(v.z,{dataTest:"update-button-on-options",primary:!0,onClick:()=>{t(a),n()}},r.Z.t("Update")))))}function Y(e){let{downloadAreaRef:t,dataEngine:n,widget:i}=e;const s=(0,l.useSetRecoilState)(y.uu),[c,u]=(0,l.useRecoilState)((0,y.jw)("options")),[d,m]=(0,o.useState)(!1),{baseUrl:g,serverVersion:f}=(0,P.zw)(),{download:p}=L(t,n),h=(0,l.useRecoilValue)(y.Jm),E=(0,l.useRecoilValue)((0,y.Vu)(h)),S=null===E||void 0===E?void 0:E.write,C=(0,a.k6)(),U=(0,l.useRecoilCallback)((e=>{let{set:t,reset:n}=e;return()=>{n((0,y.jw)("orgUnitSelection")),n((0,y.jw)("periodSelection")),t(y.Do,(e=>e+1))}})),T=()=>{if(S){if(s((e=>({...e,previous:`/view/${h}`}))),i){const e=(0,A.Jc)(g,{name:D.iC,title:D.XI},f);return window.parent.open(e+"#/edit/"+h)}C.push(`/edit/${h}`)}};return o.createElement("div",{className:"row end print-hide"},o.createElement("div",{className:"column align-items-end"},!i&&o.createElement(w.J,null,o.createElement(v.z,{className:"option-button",dataTest:"scorecard-option-button",onClick:()=>m(!0)},r.Z.t("Options")),S&&o.createElement(v.z,{dataTest:"edit-scorecard-button",className:"scorecard-view-edit-button",onClick:T},r.Z.t("Edit")),o.createElement(b.P,{component:o.createElement(k,{onClose:()=>{},onDownload:p}),className:"download-button",dataTest:"download-button"},r.Z.t("Download")),o.createElement(v.z,{className:"refresh-button",onClick:U},r.Z.t("Refresh")))),i&&S?o.createElement(v.z,{dataTest:"edit-scorecard-button",className:"scorecard-view-edit-button",onClick:T},r.Z.t("Edit")):null,d&&o.createElement(z,{onClose:()=>m(!1),initialValues:c,onSelect:u}))}z.propTypes={initialValues:m().object.isRequired,onClose:m().func.isRequired,onSelect:m().func.isRequired},Y.propTypes={dataEngine:m().instanceOf(Q.Oq).isRequired,downloadAreaRef:m().any.isRequired};var J=n(28362),H=n.n(J);function W(){var e;const{title:t}=(0,l.useRecoilValue)((0,y.jw)("options")),n=(0,l.useRecoilValue)((0,y.jw)("customHeader")),r=(0,l.useRecoilValue)(y.gi),a=(0,l.useRecoilValue)((0,y.jw)("title")),s=(0,l.useRecoilValue)((0,y.jw)("subtitle"));return t&&!(0,i.isEmpty)(r)?o.createElement("div",{className:"row space-between",id:"scorecard-header"},o.createElement("div",{className:"row"},n?o.createElement(H(),{autoCloseVoidElements:!0,className:"w-100",onError:console.error,bindings:{title:a,subtitle:s,period:1===r.length?null===(e=(0,i.head)(r))||void 0===e?void 0:e.name:""},jsx:n}):o.createElement("div",{className:"column center align-items-center"},o.createElement("h1",{style:{margin:8},id:"data-test-score-card-title"},a," ",""+(1===r.length?` - ${r[0].name}`:"")),o.createElement("h3",{style:{color:u.O.grey600,margin:0}},s)))):null}var q=n(94225),K=n(98132),X=n(12307),$=n(31813),ee=n(6997),te=n(82459),ne=n(13534);function re(){return re=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},re.apply(this,arguments)}const ie=1;function oe(e){let{type:t,onClick:n,selectedItems:a=[],id:l,...s}=e;const c=t===D.o2.PERIOD?r.Z.t("Selected period"):r.Z.t("Selected organisation unit"),u=(0,i.head)((0,i.chunk)(a,ie));return o.createElement("div",{id:l,onClick:n},o.createElement(ee.u,{content:o.createElement("div",null,null===a||void 0===a?void 0:a.map((e=>{let{name:t,displayName:n,id:r}=e;return o.createElement("p",{style:{margin:4},key:`${r}-tooltip`},null!==t&&void 0!==t?t:n)})))},o.createElement(te.x,re({className:"selection-box"},s),o.createElement("p",{className:"selection-box-header"},c),o.createElement(te.x,{className:"selection-text-box",width:"90%",height:"40%"},null===u||void 0===u?void 0:u.map((e=>{let{name:t,displayName:n,id:r}=e;return o.createElement(ne.A,{key:r},null!==t&&void 0!==t?t:n)})),(null===a||void 0===a?void 0:a.length)>ie&&o.createElement(ne.A,null,r.Z.t("and {{number}} more",{number:a.length-ie}))))))}function ae(){var e;const[t,n]=(0,l.useRecoilState)(y.V),{calendar:i}=null!==(e=(0,l.useRecoilValue)(y.tU))&&void 0!==e?e:{},s=(0,a.k6)(),c=(0,l.useRecoilValue)(y.Jm),u=(0,l.useRecoilValue)(y.Ee),d=(0,l.useRecoilValue)(y.tR),[m,g]=(0,l.useRecoilState)((0,y.jw)("orgUnitSelection")),[f,p]=(0,l.useRecoilState)((0,y.jw)("periodSelection")),[h,E]=(0,o.useState)(!1),[S,b]=(0,o.useState)(!1),C=(0,l.useRecoilCallback)((e=>{let{reset:t}=e;return()=>{t(y.Jm),t((0,y.WK)(c))}}),[c]);(0,o.useEffect)((()=>()=>{C()}),[]);const U=(0,o.useMemo)((()=>(0,A.O_)(m,{orgUnitGroups:d,orgUnitLevels:u})),[d,u,m]);return o.createElement("div",{className:"selection-card"},o.createElement($.Rg,{options:D.E4,steps:D.tm,enabled:t,initialStep:0,onExit:()=>{n(!1)}}),o.createElement(q.Z,null,o.createElement("div",{className:"row space-between align-items-center pl-16 pr-16"},o.createElement("div",{className:"row align-items-center"},o.createElement(oe,{id:"org-unit-selector",selectedItems:U,name:"Organisation Unit",dataTest:"test-selected-organization-unit",onClick:()=>{E(!0)},type:D.o2.ORG_UNIT}),o.createElement(oe,{id:"period-selector",selectedItems:null===f||void 0===f?void 0:f.periods,dataTest:"test-selected-period",name:"Period",onClick:()=>{b(!0)},type:D.o2.PERIOD})),o.createElement("div",{className:"column align-items-end"},o.createElement(w.J,{className:"pb-8"},o.createElement(v.z,{className:"home-button",onClick:()=>{s.replace("/")}},r.Z.t("Back to all scorecards")),o.createElement(v.z,{onClick:()=>n(!0)},r.Z.t("Help")))),h&&o.createElement(K.e5,{value:m,showGroups:!0,showLevels:!0,showUserOptions:!0,hide:!h,onClose:()=>E(!1),onUpdate:e=>{g(e),E(!1)}}),S&&o.createElement(K.rJ,{enablePeriodSelector:!0,excludedPeriodTypes:D.zP,calendar:i,selectedPeriods:f.periods.map((e=>{let{id:t}=e;return t})),hide:!S,onClose:()=>b(!1),onUpdate:e=>{p({periods:e.map((e=>X._M.getPeriodById(e)))}),b(!1)}}))))}oe.defaultProps={type:"",name:""},oe.propTypes={name:m().string.isRequired,type:m().oneOf([D.o2.PERIOD,D.o2.ORG_UNIT]).isRequired,onClick:m().func.isRequired,id:m().string,selectedItems:m().array};var le=n(57081);const se=(0,o.lazy)((()=>n.e(98).then(n.bind(n,10098)))),ce=(0,o.lazy)((()=>Promise.all([n.e(804),n.e(3810),n.e(1723)]).then(n.bind(n,11723))));function ue(e){var t;let{widget:n}=e;const{id:s}=(0,a.UO)(),c=(0,l.useSetRecoilState)(y.Jm),u=(0,l.useRecoilValueLoadable)(y.R6),d=(0,o.useMemo)((()=>{var e,t,n;return"hasValue"===u.state&&null!==(e=null===(t=u.contents)||void 0===t||null===(n=t.orgUnits)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id)))&&void 0!==e?e:[]}),[u.state,u.contents]),{read:m}=(0,l.useRecoilValue)((0,y.Vu)(s)),v=(0,o.useRef)(),f=(0,l.useRecoilValue)(y.gi),A=(0,l.useRecoilValue)(y.Yx),E=(0,o.useMemo)((()=>new Q.Oq),[]),w=(0,l.useRecoilCallback)((e=>{let{reset:t}=e;return()=>{t((0,y.jw)("periodSelection")),t((0,y.jw)("orgUnitSearchKeyword")),t((0,y.Gs)(d)),t((0,y.jw)("options")),t(y.Jm),t(y.kq),t(y.ip)}}));return(0,o.useEffect)((()=>(c(s),()=>{w()})),[]),m?o.createElement(o.Suspense,{fallback:o.createElement(g,null)},!n&&o.createElement(ae,null),o.createElement(o.Suspense,{fallback:o.createElement(g,null)},o.createElement("div",{ref:v,className:"column p-16  print-visible",style:{height:"100%",width:"100%",overflow:"visible"}},o.createElement(Y,{widget:n,dataEngine:E,downloadAreaRef:v}),o.createElement(W,null),o.createElement(se,null),o.createElement(S,null),o.createElement("div",{className:"column align-items-center pt-16 flex-1"},(0,i.isEmpty)(null===u||void 0===u||null===(t=u.contents)||void 0===t?void 0:t.orgUnits)||(0,i.isEmpty)(f)?o.createElement(h,null):o.createElement(o.Suspense,{fallback:o.createElement(g,{small:!0})},o.createElement(ce,{initialDataEngine:E,nested:!1,orgUnits:d})),A&&o.createElement("div",{className:"hide print-show always-page-break"},o.createElement("div",{className:"always-page-break"}),o.createElement("h1",null,r.Z.t("Specific Targets Legends")),o.createElement(le.I,null)))))):o.createElement(p,{accessType:"view"})}var de=n(81589);function me(e){let{height:t}=e;return o.createElement("div",{style:{height:null!==t&&void 0!==t?t:"100%",minHeight:null!==t&&void 0!==t?t:"100%"},className:"column center align-items-center"},o.createElement(c.V,{small:!0}))}me.propTypes={height:m().oneOfType([m().string,m().number])};var ge=n(48439);function ve(e){let{cellRef:t,color:n,value:r,status:i,bold:a}=e;const l=(null===t||void 0===t?void 0:t.offsetWidth)-1||100,s=(null===t||void 0===t?void 0:t.offsetHeight)-1||47,c=12,u="decreasing"===i;return o.createElement("svg",{width:l,height:s,style:{display:"block"}},o.createElement("polygon",{points:`0 0 0 ${s} ${l} ${s} ${l} 0`,style:{fill:null!==n&&void 0!==n?n:"#FFFFFF"}}),i&&(u?o.createElement(ge.B,{x:l/2-24,y:(s-10)/2+10,fontSize:10}):o.createElement(ge.M,{fontSize:10,y:(s-10)/2,x:l/2-24})),o.createElement("text",{id:"test-average-column",style:{fontWeight:a&&"bold"},lengthAdjust:"spacingAndGlyphs",fontSize:c,x:l/2-c,y:(s-c)/2+c},r))}function fe(e){let{bold:t,topValue:n,bottomValue:r,topColor:i,bottomColor:a,topStatus:l,bottomStatus:s,cellRef:c}=e;const u=(null===c||void 0===c?void 0:c.offsetWidth)-1||100,d=(null===c||void 0===c?void 0:c.offsetHeight)-1||47;return o.createElement("svg",{width:u,height:d,viewBox:`0 0 ${u} ${d}`,style:{display:"block"}},o.createElement("polygon",{points:`0,0 0,${d} ${u}, 0`,style:{fill:null!==i&&void 0!==i?i:"#FFFFFF",strokeWidth:1,stroke:"rgb(232, 237, 242)"}}),o.createElement("text",{style:{fontWeight:t&&"bold"},id:"test-cell-selector",lengthAdjust:"spacingAndGlyphs",textLength:(null===n||void 0===n?void 0:n.length)>4?28:null,fontSize:12,x:18,y:18},n),l&&("increasing"===l?o.createElement(ge.M,{fontSize:10,y:6,x:12}):o.createElement(ge.B,{fontSize:10,y:18,x:12})),o.createElement("polygon",{points:`${u},0 ${u},${d} 0,${d}`,style:{fill:null!==a&&void 0!==a?a:"#FFFFFF",strokeWidth:1,stroke:"rgb(232, 237, 242)"}}),o.createElement("text",{style:{fontWeight:t&&"bold"},id:"test-cell-selector",lengthAdjust:"spacingAndGlyphs",textLength:(null===r||void 0===r?void 0:r.length)>4?28:null,fontSize:12,x:u/2+6,y:d-6},r),s&&("increasing"===s?o.createElement(ge.M,{fontSize:10,y:d-18,x:u-12}):o.createElement(ge.B,{fontSize:10,y:d-6,x:u-12})))}ve.propTypes={value:m().string.isRequired,bold:m().bool,color:m().string,status:m().oneOf(["increasing","decreasing"])},fe.propTypes={bottomValue:m().any.isRequired,topValue:m().any.isRequired,bold:m().bool,bottomColor:m().string,bottomStatus:m().oneOf(["increasing","decreasing"]),topColor:m().string,topStatus:m().oneOf(["increasing","decreasing"])};var pe=n(69948);class he{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.defaultsDeep)(this,e,this.defaults)}get defaults(){return{}}}var ye=n(55112);function Ae(e){let{size:t,color:n}=e;return o.createElement(ye.Z,{style:{color:null!==n&&void 0!==n?n:u.O.grey500,fontSize:null!==t&&void 0!==t?t:24}})}Ae.propTypes={size:m().number.isRequired,color:m().string}},42622:function(e,t,n){n.d(t,{rT:function(){return se},vc:function(){return V},zi:function(){return m},iC:function(){return r},XI:function(){return i},pW:function(){return _},PG:function(){return Y},CK:function(){return p},a5:function(){return g},TP:function(){return a},UK:function(){return u},f_:function(){return o},vX:function(){return c},hL:function(){return s},m5:function(){return l},LD:function(){return ie},MC:function(){return oe},U4:function(){return ne},uE:function(){return O},oT:function(){return R},zI:function(){return E},M4:function(){return x},UX:function(){return h},aV:function(){return y},o2:function(){return M},Z3:function(){return W},CA:function(){return $},N_:function(){return ae},ed:function(){return le},Uj:function(){return re},he:function(){return te},Xd:function(){return q},Cs:function(){return I},Fb:function(){return X},sZ:function(){return ee},CP:function(){return ce},i5:function(){return Z},sR:function(){return K},tS:function(){return L},ds:function(){return A},a4:function(){return d},wR:function(){return H},tm:function(){return ue},E4:function(){return J},rm:function(){return G},jl:function(){return j},BQ:function(){return Q},zP:function(){return F},O1:function(){return C},ey:function(){return w},lN:function(){return S},KR:function(){return b},Xv:function(){return U},Hg:function(){return de}});const r="hisptz-scorecard",i="Interactive Scorecard",o="hisptz-scorecard",a="dataStore/hisptz-scorecard",l="scorecard-summary",s=[{key:"title",path:["title"]},{key:"description",path:["description"]},{key:"id",path:["id"]},{key:"user",path:["user","id"]},{key:"userAccesses",path:["userAccesses"]},{key:"userGroupAccesses",path:["userGroupAccesses"]},{key:"publicAccess",path:["publicAccess"]},{key:"additionalLabels",path:["additionalLabels"]}],c="dataStore/scorecards",u="dataStore/functions",d="https://docs.dhis2.org/en/use/optional-apps/interactive-scorecard-app/app-version-01/scorecard-and-demo.html",m=[{name:"dx",column:"Data",valueType:"TEXT",type:"java.lang.String",hidden:!1,meta:!0},{name:"pe",column:"Period",valueType:"TEXT",type:"java.lang.String",hidden:!1,meta:!0},{name:"ou",column:"Organisation unit",valueType:"TEXT",type:"java.lang.String",hidden:!1,meta:!0},{name:"value",column:"Value",valueType:"NUMBER",type:"java.lang.Double",hidden:!1,meta:!1}],g={ETHIOPIAN:"ethiopian",GREGORIAN:"gregorian"};var v=n(26874),f=n(50963);const p=[{type:"column",description:v.Z.t("Column chart"),icon:f.sg},{type:"line",description:v.Z.t("Line chart"),icon:f.qF},{type:"bar",description:v.Z.t("Bar chart"),icon:f.$Q},{type:"area",description:v.Z.t("Area chart"),icon:f.uN},{type:"pie",description:v.Z.t("Pie chart"),icon:f.by}],h={EXCEL:"Excel",PDF:"PDF",CSV:"CSV"},y={DATA_COLUMN:"dataColumn",ORG_UNIT_COLUMN:"orgUnitColumn",DATA_ROW:"dataRow",ORG_UNIT_ROW:"orgUnitRow",OU_LAYOUT:"ou",DX_LAYOUT:"dx",PE_LAYOUT:"pe"},A=["title","description","periodType"],E={INTEGER:{name:"INTEGER",formName:"number"},TRUE_ONLY:{name:"TRUE_ONLY",formName:"checkbox"},TEXT:{name:"TEXT",formName:"text"},NUMBER:{name:"NUMBER",formName:"number"},DATE:{name:"DATE",formName:"date"},LONG_TEXT:{name:"LONG_TEXT",formName:"textarea"},LEGEND_DEFINITION:{name:"LEGEND_DEFINITION",formName:"legendDefinition"},RICH_TEXT:{name:"RICH_TEXT",formName:"richText"},LEGEND_MIN_MAX:{name:"LEGEND_MIN_MAX",formName:"legendMinMax"},NORMAL_LEGEND_MIN_MAX:{name:"NORMAL_LEGEND_MIN_MAX",formName:"normalLegendMinMax"},LEVEL_LEGEND_MIN_MAX:{name:"LEVEL_LEGEND_MIN_MAX",formName:"levelLegendMinMax"},MULTIPLE_FIELDS:{name:"MULTIPLE_FIELDS",formName:"multipleFields"}},S=["title","subtitle","description","periodType","periodSelection","legendDefinitions","additionalLabels"],w=["dataSelection","dataSelection.dataGroups"],b=[],C=[],U=[];var D=n(13488),k=n(4111),P=n(3219),T=n(57214),N=n(81195);const I={dx:{name:"data",displayName:v.Z.t("Data"),icon:N.createElement(T.Z,{style:{color:D.O.grey700}})},ou:{name:"orgUnit",displayName:v.Z.t("Organisation Unit"),icon:N.createElement(P.Z,{style:{color:D.O.grey700}})},pe:{name:"period",displayName:v.Z.t("Period"),icon:N.createElement(k.Z,{style:{color:D.O.grey700}})}},R={column:["dx"],row:["pe"],filter:["ou"]},O="skipMigration",Z={ORG_UNIT_VS_DATA:"orgUnitsVsData",DATA_VS_ORG_UNIT:"dataVsOrgUnits"},L={RELATIVE:{name:v.Z.t("Relative Periods"),key:"relative"},FIXED:{name:v.Z.t("Fixed Periods"),key:"fixed"}},F=["RelativeWeek","RelativeFinancialYear"];function B(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class G{}B(G,"READ_WRITE","rw----"),B(G,"READ_ONLY","r-----"),B(G,"NO_ACCESS","------");const x={read:!1,write:!1,delete:!1},_={USER:"user",USER_GROUP:"userGroup"},V=[G.NO_ACCESS,G.READ_ONLY,G.READ_WRITE],M={ORG_UNIT:"ORG_UNIT",PERIOD:"PERIOD"},j={CELL_WIDTH:102},Q={ASC:"asc",DESC:"desc",DEFAULT:"default"};function z(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class Y{}z(Y,"ALL","ALL"),z(Y,"BELOW_AVERAGE","BELOW_AVERAGE"),z(Y,"ABOVE_AVERAGE","ABOVE_AVERAGE");const J={nextLabel:v.Z.t("Next"),prevLabel:v.Z.t("Previous"),skipLabel:v.Z.t("Skip"),doneLabel:v.Z.t("Done"),hideNext:!1,hidePrev:!0,showProgress:!1,disableInteraction:!1,tooltipClass:"custom-tooltip"},H=[{intro:N.createElement("div",null,N.createElement("h1",null,v.Z.t("Welcome to the most interactive scorecard ever!")))},{element:".search-input",intro:v.Z.t("Search here for scorecards by name, id, or description")},{element:".change-view-button",intro:v.Z.t("Click here to change the scorecards view to either list or grid")},{element:".add-scorecard-button",intro:v.Z.t("Click here to add a new scorecard")},{element:".scorecard-list",intro:v.Z.t("Click on View or anywhere on the scorecard to view, click on Edit to edit configurations and click on Delete to delete the scorecard")}],W=[{intro:N.createElement("div",{style:{width:200}},N.createElement("h3",null,v.Z.t("Scorecard Management")),v.Z.t("Here you can modify your scorecard configuration"))},{element:".general-settings",intro:v.Z.t("Set your title and subtitle here")},{element:".description-settings",intro:v.Z.t("Describe your scorecard")},{element:".period-type-settings",intro:v.Z.t("Set the default period type here. This will determine which periods will be selected as defaults")},{element:".custom-header-settings",intro:v.Z.t("Modify the scorecard header here. You can add different styling, icons, images,and much more")},{element:".legend-definitions-settings",intro:v.Z.t("Define legends here. Set the title and color")},{element:".additional-labels-settings",intro:v.Z.t("Set additional labels here")},{element:".settings-next-button",intro:v.Z.t("Click on next to move to data configuration page")}],q=[{intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Data Configuration")),v.Z.t("On this page, you can configure different data sources (indicators, dataElements, e.t.c) for the scorecard. You can also preview the scorecard table."))}],K=[{element:".preview-table-area",intro:v.Z.t("This is the preview area. It shows how your scorecard will look like.")}],X=[{element:".groups-configuration-area",intro:N.createElement("div",null,N.createElement("p",null,v.Z.t("You can configure different data sources on this area.")),N.createElement("p",null,v.Z.t("Indicators are configured and displayed in groups")))},{element:".scorecard-add-group-button",intro:v.Z.t("Click Here to add a group")}],$=[{element:".groups-configuration-area",intro:N.createElement("div",null,N.createElement("p",null,v.Z.t("You can configure different data sources on this area.")),N.createElement("p",null,v.Z.t("Indicators are configured and displayed in groups")))},{element:".group-name-area",intro:v.Z.t("Double click or click on the edit button to edit the group name")},{element:".expand-group-icon",intro:v.Z.t("Click here to expand or collapse the group area")},{element:".delete-group-icon",intro:v.Z.t("Click here to delete the group")},{element:".scorecard-add-group-button",intro:v.Z.t("Click Here to add more groups")}],ee=[{element:".scorecard-indicator-add",intro:v.Z.t("Click here to add an indicator")}],te=[{element:".data-holders-area",intro:v.Z.t("Selected indicators appear here")},{element:".data-holder",intro:v.Z.t("Click here to configure this indicator. You can also drag this to rearrange the indicators within a group")},{element:".link-button",intro:v.Z.t("Click here to link two adjacent indicators or to unlink linked indicators")},{element:".data-source.close-icon",intro:v.Z.t("Click here to delete this indicator")},{element:".scorecard-indicator-add",intro:v.Z.t("Click here to add more indicators")}],ne=[{element:".groups-configuration-area",intro:v.Z.t("You can configure different data sources on this area")},{element:".target-on-level-selector",intro:v.Z.t("Check this box to set legend configuration according to organisation unit levels")},{element:".scorecard-add-group-button",intro:v.Z.t("Click Here to add a group")},...$,...te],re=[{element:".data-source-form-container",intro:v.Z.t("You can edit indicator configuration here")},{element:'input[name="label"]',intro:v.Z.t("Edit indicator label here. This label will displayed on the scorecard table header")},{element:'input[name="weight"]',intro:v.Z.t("You can set the indicator weight here. This is the indicator's maximum value")},{element:".effective-gap-settings",intro:v.Z.t("You can set the effective gap here.")},{element:".indicator-options-settings-area",intro:N.createElement("div",null,v.Z.t("Here you can set different options for the indicator"),N.createElement("p",null,N.createElement("b",null,v.Z.t("Display Arrows"),":"),v.Z.t("Check this to display increasing/decreasing arrows on this indicator's value")),N.createElement("p",null,N.createElement("b",null,v.Z.t("High is Good"),":"),v.Z.t("Check this to indicate that higher values are good for this indicator  ")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Show Colors"),":"),v.Z.t("Check this to enable legend color on an indicator value ")))},{element:".legend-settings-area",intro:v.Z.t("Here you can configure the maximum and minimum values for each legend")}],ie=[],oe={introduction:{start:0,end:q.length-1},emptyGroups:{start:1,end:X.length-1},groupConfig:{start:X.length,end:$.length-1},emptyIndicators:{start:$.length,end:ee.length-1},indicatorSetup:{start:ee.length,end:te.length-1},indicatorConfiguration:{start:te.length,end:re.length-1}},ae=[{intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Highlighted Indicators")),N.createElement("p",null,v.Z.t("In this page you can add and configure highlighted indicators. These indicators appear on top of the scorecard table")))},{element:".add-highlighted-indicator-button",intro:v.Z.t("To add a highlighted indicator click here")}],le=[{element:".highlighted-indicator-table",intro:v.Z.t("Selected indicators will appear here")},{element:".highlighted-indicator-row",intro:v.Z.t("Click on the row to configure the indicator")},{element:".highlighted-indicator-delete",intro:v.Z.t("Click on the remove button to delete the indicator from the list")},{element:".add-highlighted-indicator-button",intro:v.Z.t("To add more highlighted indicators click here")}],se=[{intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Access Settings")),N.createElement("p",null,v.Z.t("In this page you can configure the default organisation unit and sharing access")))},{element:".access-org-unit-filter",intro:v.Z.t("Choose the default organisation unit from this selector")},{element:".add-sharing-access",intro:v.Z.t("You can add a new user or user group to share the scorecard with here")},{element:".user-selector",intro:v.Z.t("Search and select a user or user group here")},{element:".access-selector",intro:v.Z.t("Select the appropriate access here")},{element:".add-access-button",intro:v.Z.t("Click here to add the access settings")},{element:".sharing-list",intro:v.Z.t("List of shared users and user groups will appear here")},{element:".edit-delete-access",intro:v.Z.t("You can edit or delete access here")}],ce=[{intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Default Options Settings")),N.createElement("p",null,v.Z.t("In this page you can set default options for the scorecard view")))},{element:".visibility-options",intro:N.createElement("div",null,v.Z.t("These options affect the scorecard view"),N.createElement("p",null,N.createElement("b",null,v.Z.t("Legend"),":"),v.Z.t("Allows the legends on the scorecard header to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Title"),":"),v.Z.t("Allows the title on the scorecard header to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Item Number"),":"),v.Z.t("Allows row numbers on the scorecard to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Empty Rows"),":"),v.Z.t("Allows the empty rows on the scorecard to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Show Hierarchy"),":"),v.Z.t("Allows the organisation units hierarchy to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Average Column"),":"),v.Z.t("Allows the average column to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Average Row"),":"),v.Z.t("Allows the average row to be displayed when checked")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Highlighted Indicators"),":"),v.Z.t("Allows the highlighted indicators to be displayed when checked")))},{element:".average-options",intro:N.createElement("div",null,v.Z.t("These options allow to view data based on the average"),N.createElement("p",null,N.createElement("b",null,v.Z.t("All"),":"),v.Z.t("Allows all data to be displayed")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Below Average"),":"),v.Z.t("Allows data that is below the overall average to be displayed")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Above Average"),":"),v.Z.t("Allows data that is above the overall average to be displayed")))},{element:".other-options",intro:N.createElement("div",null,N.createElement("p",null,N.createElement("b",null,v.Z.t("Arrows"),":"),v.Z.t("Allows increasing or decreasing indicators on data cells to be displayed")),N.createElement("p",null,N.createElement("b",null,v.Z.t("Show Data in Rows"),":"),v.Z.t("Changes the table layout, the indicators are shown in rows and orgaunisation units in columns")))}],ue=[{intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Scorecard View")),N.createElement("p",null,v.Z.t("This is the default view for your scorecard")))},{element:"#org-unit-selector",intro:v.Z.t("Click here to select different organisation units")},{element:"#period-selector",intro:v.Z.t("Click here to select different periods")},{element:".home-button",intro:v.Z.t("Click here to return to scorecard list")},{element:".refresh-button",intro:v.Z.t("Click here to refresh the scorecard page. This will reset organisation units, periods, and options to default values")},{element:".option-button",intro:v.Z.t("Click here to customize the scorecard look. Add numbering, enable average rows and columns, hide or show arrows and many more")},{element:".scorecard-view-edit-button",intro:v.Z.t("Click here to edit scorecard configuration")},{element:".download-button",intro:v.Z.t("Click here to download the scorecard in Excel, PDF, CSV, and JSON formats")},{element:".scorecard-table",intro:N.createElement("div",null,N.createElement("h3",null,v.Z.t("Here is the scorecard!")),`${v.Z.t("Here you can")}: `,N.createElement("ul",null,N.createElement("li",null,v.Z.t("Sort table based on organisation unit names or values")),N.createElement("li",null,v.Z.t("Search organisation units")),N.createElement("li",null,v.Z.t("Change the table layout")),N.createElement("li",null,v.Z.t("Further analyse data in the cells"))))},{element:".org-unit-search",intro:v.Z.t("Search here for a specific organisation unit")},{element:'[data-test="dhis2-uicore-tableheadercellaction"]',intro:v.Z.t("Click on the arrows to sort the table based on the name or values")},{element:"th.parent-org-unit-cell",intro:v.Z.t("To change the table layout, click, hold, and drag this cell to the table headers")},{element:".data-cell",intro:N.createElement("div",null,N.createElement("p",{style:{margin:2}},v.Z.t("Click on a data cell to see further analysis")),N.createElement("br",null),N.createElement("p",{style:{margin:2}},v.Z.t("You can also right click to view the cell data in different options")))},{element:'[data-test="orgUnit-children-table-column-cell"] > td:nth-child(1)',intro:v.Z.t("Click on the arrow to drill down to the scorecard of this organisation unit's lower level")}],de=[{id:"general",content:v.Z.t("Here you can set your scorecard general information \n You can set name, period type, legends and additional labels of your scorecard.")},{id:"dataConfiguration",content:v.Z.t("On this page, you can configure different data sources (indicators, dataElements, e.t.c) for the scorecard. You can also preview the scorecard table.")},{id:"highlightedIndicators",content:v.Z.t("In this page you can add and configure highlighted indicators. These indicators appear on top of the scorecard table")},{id:"access",content:v.Z.t("In this page you can configure the default organisation unit and sharing access for the scorecard.")},{id:"option",content:v.Z.t("In this page you can set default options for the scorecard view. These options affect the scorecard view")}]},35667:function(e,t,n){n.d(t,{B9:function(){return u},G$:function(){return C},R4:function(){return D},bQ:function(){return I},kD:function(){return w},NW:function(){return N},cZ:function(){return T},ac:function(){return g},a:function(){return s},VL:function(){return U},$f:function(){return d},jk:function(){return b}});var r=n(7105),i=n(69987),o=n(81195),a=n(25435),l=n(19511);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const[t,n]=(0,o.useState)(e),{state:r,contents:i}=(0,a.useRecoilValueLoadable)((0,l.Gw)(t));return{loading:"loading"===r,orgUnits:"hasValue"===r?i:[],error:"hasError"===r?i:void 0,setId:n}}const c={nameQuery:{resource:"organisationUnits",params:e=>{let{keyword:t}=e;return{filter:[`displayName:ilike:${t}`],fields:["id","displayName","path","level"]}}},idQuery:{resource:"organisationUnits",params:e=>{let{keyword:t}=e;return{filter:[`id:ilike:${t}`],fields:["id","displayName","path","level"]}}}};async function u(e,t){if(!(0,i.isEmpty)(e)){const l=await t.query(c,{variables:{keyword:e}});if(!(0,i.isEmpty)(l)){var n,r,o,a;const e=null!==(n=null===l||void 0===l||null===(r=l.idQuery)||void 0===r?void 0:r.organisationUnits)&&void 0!==n?n:[],t=null!==(o=null===l||void 0===l||null===(a=l.nameQuery)||void 0===a?void 0:a.organisationUnits)&&void 0!==o?o:[];return[...e,...t].map((e=>({...e,hierarchy:e.displayName})))}}return[]}function d(){const[e,t]=(0,o.useState)(),{data:n,error:a,loading:l,refetch:s}=(0,r.u_)(c,{lazy:!0}),u=(0,o.useRef)((0,i.debounce)(t,1e3,{trailing:!0,leading:!1})),d=(0,o.useMemo)((()=>{if(!(0,i.isEmpty)(n)){var e,t,r,o;return[...null!==(e=null===n||void 0===n||null===(t=n.idQuery)||void 0===t?void 0:t.organisationUnits)&&void 0!==e?e:[],...null!==(r=null===n||void 0===n||null===(o=n.nameQuery)||void 0===o?void 0:o.organisationUnits)&&void 0!==r?r:[]]}return[]}),[n]);return(0,o.useEffect)((()=>{(0,i.isEmpty)(e)||s({keyword:e})}),[e]),{orgUnits:d,error:a,loading:l,updateKeyword:u.current}}function m(){const{innerWidth:e,innerHeight:t}=window;return{width:e>1366?e:1366,height:(t>763?t:763)-48}}function g(){const[e,t]=(0,o.useState)(m());return(0,o.useLayoutEffect)((()=>{function e(){t(m())}return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),e}var v=n(68820),f=n(42622);const p={type:"update",resource:f.TP,id:f.m5,data:e=>{let{data:t}=e;return t}};function h(){const[e,t]=(0,o.useState)(),[n,s]=(0,a.useRecoilState)(l.Cw),[c,{error:u,loading:d}]=(0,r.GB)(p),m=(0,a.useRecoilCallback)((e=>{let{set:t}=e;return async e=>{try{var r;const o=null!==(r=(0,i.cloneDeep)(n))&&void 0!==r?r:[];o.push(e),await c({data:o}),t(l.Cw,(()=>o))}catch(o){console.error(o)}}}),[n,c]),g=(0,o.useCallback)((async(e,r)=>{try{var o;const t=null!==(o=(0,i.cloneDeep)(n))&&void 0!==o?o:[];t.splice((0,i.findIndex)(t,["id",e]),1,r),await c({data:t}),s(t)}catch(a){t(a)}}),[s,n,c]),f=(0,o.useCallback)((async e=>{try{const t=(0,v.ZP)(n,(t=>{t.splice((0,i.findIndex)(t,["id",e]),1)}));await c({data:t}),s(t)}catch(r){console.error(r),t(r)}}),[s,n,c]);return{summary:n,error:null!==e&&void 0!==e?e:u,loading:d,updateSingleScorecardSummary:g,removeSingleScorecardSummary:f,addSingleScorecardSummary:m}}var y=n(62685);const A={scorecard:{resource:f.TP,id:e=>{let{id:t}=e;return t}}},E={type:"update",resource:f.TP,id:e=>{let{id:t}=e;return t},data:e=>{let{data:t}=e;return t}},S={type:"delete",resource:f.TP,id:e=>{let{id:t}=e;return t}};function w(e){var t;const[n,i]=(0,o.useState)(),[a,{loading:l,error:s}]=(0,r.GB)(S,{variables:{id:e}}),{removeSingleScorecardSummary:c,error:u}=h();return{remove:async()=>{try{await a({id:e}),await c(e)}catch(t){console.error(t),i(t)}},error:null!==(t=null!==s&&void 0!==s?s:n)&&void 0!==t?t:u,loading:l}}function b(e){const t=(0,a.useSetRecoilState)((0,l.z2)(e)),[n,{loading:i}]=(0,r.GB)(E,{variables:{id:e}}),{updateSingleScorecardSummary:o}=h();return{update:async r=>{const i=(0,y.zp)(r);await o(e,i),await n({id:e,data:r}),t((e=>e+1))},loading:i}}function C(){const e=(0,r.bQ)(),{addSingleScorecardSummary:t}=h();return{add:async n=>{const r=(0,y.zp)(n);await e.mutate((0,y.H3)(null===n||void 0===n?void 0:n.id),{variables:{data:n}}),await t(r)}}}function U(e){const t=(0,a.useSetRecoilState)((0,l.WK)(e)),{loading:n,data:i,error:s,refetch:c}=(0,r.u_)(A,{lazy:!0});return(0,o.useEffect)((()=>{null!==i&&void 0!==i&&i.scorecard&&t((()=>null===i||void 0===i?void 0:i.scorecard))}),[i]),{loading:n,error:s,set:async e=>{await c({id:e})}}}function D(){const{removeSingleScorecardSummary:e,error:t,loading:n,summary:r,updateLoading:i}=h(),{remove:o,loading:a,error:l}=w("");return{scorecards:r,error:null!==t&&void 0!==t?t:l,loading:n,removeLoading:a||i,remove:async t=>{await o({id:t}),await e(t)}}}var k=n(48666),P=n(8434);function T(){(0,P.d)();const{baseUrl:e,apiVersion:t}=(0,r.zw)();k.Fn.init({baseUrl:`${e}/api/${t}/`});const n=(0,r.bQ)();return{initializeState:function(e){let{set:t}=e;t(l.EE,(0,y.iv)()),t(l.Gj,n)}}}function N(e){const t=(0,a.useSetRecoilState)((0,l.UB)(e));return{forceUpdate:()=>{t((e=>e+1))}}}function I(){const e=(0,a.useSetRecoilState)(l.Gj),t=(0,r.bQ)();(0,o.useEffect)((()=>{e(t)}),[])}},6585:function(e,t,n){n.r(t),n.d(t,{ACCESS_HELP_STEPS:function(){return r.rT},ACCESS_TYPES:function(){return r.vc},ALMA_HEADERS:function(){return r.zi},APP_NAME:function(){return r.iC},APP_TITLE:function(){return r.XI},AccessDeniedPage:function(){return i.Xx},AccessTypes:function(){return r.pW},AllScorecardsSummaryState:function(){return s.JU},Area:function(){return u.uN},AverageDisplayType:function(){return r.PG},Bar:function(){return u.$Q},CHART_TYPES:function(){return r.CK},CalendarTypes:function(){return r.a5},Column:function(){return u.sg},ContainerLoader:function(){return i.k8},CustomFunctionsKeysState:function(){return s.r9},CustomFunctionsState:function(){return s.FK},DATASTORE_ENDPOINT:function(){return r.TP},DATASTORE_FUNCTIONS_ENDPOINT:function(){return r.UK},DATASTORE_NAMESPACE:function(){return r.f_},DATASTORE_OLD_SCORECARD_ENDPOINT:function(){return r.vX},DATASTORE_SCORECARD_SUMMARY_INCLUDE_KEYS:function(){return r.hL},DATASTORE_SCORECARD_SUMMARY_KEY:function(){return r.m5},DATA_CONFIGURATION_HELP_STEPS:function(){return r.LD},DATA_CONFIGURATION_STEPS_MAP:function(){return r.MC},DATA_CONFIGURATION_WITH_DATA_HELP_STEPS:function(){return r.U4},DATA_MIGRATION_CHECK:function(){return r.uE},DEFAULT_LAYOUT:function(){return r.oT},DHIS2ValueTypes:function(){return r.zI},DataGroupErrorState:function(){return s.rL},DataModel:function(){return a.vQ},DataSelection:function(){return a.jf},DecreasingArrows:function(){return i.BL},DefaultAuthority:function(){return r.M4},Dotted:function(){return u.qF},DownloadTypes:function(){return r.UX},DraggableItems:function(){return r.aV},EngineState:function(){return s.Gj},ErrorIcon:function(){return i.Pz},ErrorState:function(){return s.Te},FieldErrorState:function(){return s.Y$},FilterComponentTypes:function(){return r.o2},FormFieldModel:function(){return i.Lb},FullPageError:function(){return i.yM},FullPageLoader:function(){return i.By},GENERAL_HELP_STEPS:function(){return r.Z3},GROUPS_CONFIG_HELP_STEPS:function(){return r.CA},Gauge:function(){return u.aC},HIGHLIGHTED_INDICATOR_HELP_STEPS:function(){return r.N_},HIGHLIGHTED_TABLE_HELP_STEPS:function(){return r.ed},Help:function(){return i.WW},HelpIndex:function(){return s.oC},HelpState:function(){return s.V},HelpSteps:function(){return s.QY},HighlightedIndicatorsState:function(){return s.Hu},INDICATOR_CONFIGURATION_STEPS:function(){return r.Uj},INDICATOR_SETUP_HELP_STEPS:function(){return r.he},INTRODUCTION_HELP_STEPS:function(){return r.Xd},IncreasingArrows:function(){return i.Mz},InitialOrgUnits:function(){return s.R6},IsNewScorecardState:function(){return s.xV},IsSpecificTargetsSet:function(){return s.Yx},LAYOUTS:function(){return r.Cs},Line:function(){return u.x1},LinkedCellSvg:function(){return i.VB},LowestOrgUnitLevel:function(){return s.PB},ModalLoader:function(){return i.C7},NO_GROUPS_HELP_STEPS:function(){return r.Fb},NO_INDICATORS_HELP_STEPS:function(){return r.sZ},OPTIONS_HELP_STEPS:function(){return r.CP},OrgUnit:function(){return s.x9},OrgUnitChildren:function(){return s.Gw},OrgUnitGroups:function(){return s.tR},OrgUnitLevels:function(){return s.Ee},OrgUnitPathState:function(){return s.P1},OrgUnitSelection:function(){return a.v6},Orientation:function(){return r.i5},PREVIEW_TABLE_HELP_STEPS:function(){return r.sR},PeriodCategories:function(){return r.tS},PeriodResolverState:function(){return s.gi},PeriodSelection:function(){return a.er},Pie:function(){return u.by},REQUIRED_FIELDS:function(){return r.ds},Radar:function(){return u.Fk},RefreshScorecardState:function(){return s.Do},RouterState:function(){return s.uu},SCORECARD_DOCUMENTATION_URL:function(){return r.a4},SCORECARD_LIST_HELP_STEPS:function(){return r.wR},SCORECARD_VIEW_HELP_STEPS:function(){return r.tm},STEP_OPTIONS:function(){return r.E4},SavableDataModel:function(){return a.FJ},Scorecard:function(){return a.eq},ScorecardAccess:function(){return a.mx},ScorecardAccessType:function(){return r.rm},ScorecardCardImage:function(){return u._l},ScorecardConfState:function(){return s.WK},ScorecardConfigDirtySelector:function(){return s.tb},ScorecardConfigDirtyState:function(){return s.c3},ScorecardConfigEditState:function(){return s.Wm},ScorecardConfigErrorSelector:function(){return s.gS},ScorecardConfigErrorState:function(){return s.ss},ScorecardDataEngine:function(){return a.Oq},ScorecardDataLoadingState:function(){return s.Mm},ScorecardDataSourceState:function(){return s.ip},ScorecardForceUpdateState:function(){return s.UB},ScorecardIdState:function(){return s.Jm},ScorecardIndicator:function(){return a.ec},ScorecardIndicatorGroup:function(){return a.cg},ScorecardIndicatorHolder:function(){return a.KJ},ScorecardLegend:function(){return a.bh},ScorecardLegendDefinitionSelector:function(){return s.L4},ScorecardNameSort:function(){return s.Gs},ScorecardOptions:function(){return a.TI},ScorecardOptionsForm:function(){return i.Rs},ScorecardOptionsModal:function(){return i.u2},ScorecardOrgUnitState:function(){return s.z},ScorecardRequestId:function(){return s.z2},ScorecardSummaryState:function(){return s.Cw},ScorecardTableConfigState:function(){return s.Bo},ScorecardTableConstants:function(){return r.jl},ScorecardTableOrientationState:function(){return s.kq},ScorecardTableSortState:function(){return s.oT},ScorecardView:function(){return i.yy},ScorecardViewState:function(){return s.jw},ScreenDimensionState:function(){return s.EE},SelectedOrgUnits:function(){return s.YI},ShouldValidate:function(){return s.cv},SingleCellSvg:function(){return i.$T},SingleHighlightedIndicatorState:function(){return s.zT},StackedBar:function(){return u.jL},StackedColumn:function(){return u.A2},SystemSettingsState:function(){return s.tU},TableSort:function(){return r.BQ},UNSUPPORTED_PERIOD_TYPES:function(){return r.zP},UserAuthorityOnScorecard:function(){return s.Vu},UserState:function(){return s.aF},accessPageFields:function(){return r.O1},constructAppUrl:function(){return l.Jc},dataConfigurationPageFields:function(){return r.ey},generalPageFields:function(){return r.lN},generateCreateMutation:function(){return l.H3},generateLegendDefaults:function(){return l.Yo},generateRandomValues:function(){return l.c1},generateScorecardSummary:function(){return l.zp},getColSpanDataGroups:function(){return l.uK},getColSpanWithOrgUnit:function(){return l.lC},getCustomFunctionAnalytics:function(){return l.By},getCustomFunctions:function(){return c.X$},getDataSourceDetails:function(){return l.Gy},getDataSourceShortName:function(){return l.gf},getDataSourcesDisplayName:function(){return l.mD},getDataSourcesFromGroups:function(){return l.on},getHighlightedIndicatorsData:function(){return c.Um},getHoldersFromGroups:function(){return l.DY},getIncreasingStatus:function(){return l.V3},getLegend:function(){return l.EM},getNameCellWidth:function(){return l.G},getOrgUnitSelection:function(){return c.EA},getOrgUnitsFromAnalytics:function(){return c.uy},getScorecard:function(){return c.yB},getScorecardCellData:function(){return c.Vj},getScorecardData:function(){return c.h9},getScorecardSummary:function(){return c.A5},getSelectedOrgUnitSelectionDisplay:function(){return l.O_},getSystemSettings:function(){return c.pT},getTableWidthWithDataGroups:function(){return l.rW},getTableWidthWithOrgUnit:function(){return l.Mc},getUserAuthority:function(){return l.YW},getValidationPageFields:function(){return l.rs},getWindowDimensions:function(){return l.iv},highlightedIndicatorPageFields:function(){return r.KR},isOrgUnitId:function(){return c.be},migrateScorecard:function(){return l.Bn},optionsPageFields:function(){return r.Xv},restoreScorecardSummary:function(){return c.Fy},reverseLegends:function(){return l.Rz},scorecardManagementTooltips:function(){return r.Hg},searchOrganisationUnit:function(){return o.B9},sortDataSourcesBasedOnData:function(){return l.i5},sortDataSourcesBasedOnNames:function(){return l.A$},sortOrgUnitsBasedOnData:function(){return l.t7},sortOrgUnitsBasedOnNames:function(){return l.eL},specificTargetsSet:function(){return l.zZ},truncateDescription:function(){return l.Nt},uid:function(){return l.hQ},updateListFromDragAndDrop:function(){return l.$$},updateListsFromDragAndDrop:function(){return l.hs},updatePager:function(){return l.Dq},useAddScorecard:function(){return o.G$},useAllScorecards:function(){return o.R4},useDataEngine:function(){return o.bQ},useDeleteScorecard:function(){return o.kD},useForceUpdate:function(){return o.NW},useInitApp:function(){return o.cZ},useMediaQuery:function(){return o.ac},useOrganisationUnitChildren:function(){return o.a},useScorecard:function(){return o.VL},useSearchOrganisationUnit:function(){return o.$f},useUpdateScorecard:function(){return o.jk},validateGroups:function(){return l.o_},validateScorecard:function(){return l.xb}});var r=n(42622),i=n(74073),o=n(35667),a=n(23985),l=n(62685),s=n(19511),c=n(25018),u=n(50963)},23985:function(e,t,n){n.d(t,{vQ:function(){return o},jf:function(){return l},v6:function(){return s},er:function(){return u},FJ:function(){return a},eq:function(){return f},mx:function(){return m},Oq:function(){return k},ec:function(){return P},cg:function(){return I},KJ:function(){return T},bh:function(){return N},TI:function(){return g}});var r=n(68820),i=n(69987);class o{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.defaultsDeep)(this,e,this.defaults)}get defaults(){return{}}static set(e,t,n){if(t){const r=(0,i.cloneDeep)(e);return r[t]=n,r}return this}static setObject(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=(0,i.cloneDeep)(e);for(const r of Object.keys(t))n[r]=t[r];return n}}class a extends o{static async save(e,t,n){const i=(0,r.ZP)(JSON.parse(JSON.stringify(e)),(e=>{e.user={id:null===n||void 0===n?void 0:n.id}}));return await t(i)}static async update(e,t){return await t(JSON.parse(JSON.stringify(e)))}}class l extends o{get defaults(){return{dataGroups:[]}}}class s extends o{get defaults(){return{levels:[],groups:[],orgUnits:[],userSubX2Unit:!1,userSubUnit:!1,userOrgUnit:!1}}}class c{constructor(e){this.selectionItem=e}get id(){return this.selectionItem?this.selectionItem.id:void 0}get name(){return this.selectionItem?this.selectionItem.name:void 0}get type(){return this.selectionItem?this.selectionItem.type:void 0}}class u{constructor(e){this.periodSelection=e}get items(){return(this.periodSelection?this.periodSelection.items:[]).map((e=>new c(e)))}}var d=n(42622);class m extends o{get defaults(){return{id:void 0,type:"userGroup",access:d.rm.NO_ACCESS,displayName:""}}}class g extends o{get defaults(){return{averageDisplayType:d.PG.ALL,legend:!0,title:!0,itemNumber:!0,emptyRows:!0,showHierarchy:!1,averageColumn:!1,averageRow:!1,highlightedIndicators:!1}}}var v=n(62685);class f extends a{get defaults(){return{id:(0,v.hQ)(),name:"",title:"",subtitle:"",description:"",customHeader:"",periodType:"",legendDefinitions:[],dataSelection:new l,orgUnitSelection:new s,periodSelection:new u,options:new g,highlightedIndicators:[],publicAccess:new m,userGroupAccesses:[],userAccesses:[],user:{},targetOnLevels:!1,additionalLabels:[]}}}var p=n(48666),h=n(21386),y=n(34742),A=n.n(y),E=n(76774),S=n(66167),w=n(61310),b=n(65435),C=n(85414),U=n.n(C);function D(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class k{constructor(){D(this,"engine",void 0),D(this,"_cancelled",!1),D(this,"_totalRequests",0),D(this,"_progress",0),D(this,"_progress$",new E.X),D(this,"_dataEntities",{}),D(this,"_dataEntities$",new E.X(this._dataEntities)),D(this,"dataEntities$",this._dataEntities$.asObservable()),D(this,"_previousPeriods",[]),D(this,"_calendar",void 0),D(this,"_loading$",new E.X),this._cancelled=!1}get loading$(){return this._loading$.asObservable()}get _canLoadData(){var e,t,n,r;return(null===(e=this._selectedOrgUnits)||void 0===e?void 0:e.length)>0&&(null===(t=this._selectedPeriods)||void 0===t?void 0:t.length)>0&&((null===(n=this._selectedData.normalDataItems)||void 0===n?void 0:n.length)>0||(null===(r=this._selectedData.customDataItems)||void 0===r?void 0:r.length)>0)}setDataQueryEngine(e){return this.engine=e,this}setPeriodType(e){return this._periodType=e,this._selectedPeriods=this._getSelectedPeriods(this._selectedPeriods,e),this}refresh(){return this.reset(!1),this.load(),this}setPeriods(e){var t,n;let r=[];return this._selectedPeriods=(0,i.uniqBy)((e||[]).map((e=>{const t=(new h.Period).setPreferences({allowFuturePeriods:!0}).setCalendar(this._calendar).getById(null===e||void 0===e?void 0:e.id);return r=[...r,null===t||void 0===t?void 0:t.lastPeriod],t||e})),"id"),r.forEach((e=>{(0,i.find)(this._selectedPeriods,["id",null===e||void 0===e?void 0:e.id])||(this._selectedPeriods=(0,i.compact)([...this._selectedPeriods,e]))})),this._previousPeriods=null!==(t=(0,i.compact)(null===(n=(0,i.differenceBy)(r,e,"id"))||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id))))&&void 0!==t?t:[],this}setCalendar(e){return this._calendar=e,this}setDataGroups(e){return this._selectedData=this._getSelectedData(e),this}setOrgUnits(e){return this._selectedOrgUnits=e,this}_updateDataEntities(e){(e||[]).forEach((t=>{var n,r,o,a,l;const s=`${null===t||void 0===t||null===(n=t.dx)||void 0===n?void 0:n.id}_${null===t||void 0===t||null===(r=t.ou)||void 0===r?void 0:r.id}_${null===t||void 0===t||null===(o=t.pe)||void 0===o?void 0:o.id}`,c=null===(a=(0,i.find)(this._selectedPeriods,["id",null===t||void 0===t||null===(l=t.pe)||void 0===l?void 0:l.id]))||void 0===a?void 0:a.lastPeriod,u=e.find((e=>{var n,r,i,o,a;return(null===e||void 0===e||null===(n=e.dx)||void 0===n?void 0:n.id)===(null===t||void 0===t||null===(r=t.dx)||void 0===r?void 0:r.id)&&(null===e||void 0===e||null===(i=e.ou)||void 0===i?void 0:i.id)===(null===t||void 0===t||null===(o=t.ou)||void 0===o?void 0:o.id)&&(null===e||void 0===e||null===(a=e.pe)||void 0===a?void 0:a.id)===(null===c||void 0===c?void 0:c.id)}));this._dataEntities={...this._dataEntities||{},[s]:{current:t.value,previous:null===u||void 0===u?void 0:u.value}},this._dataEntities$.next(this._dataEntities)}))}load(){this._canLoadData&&(this._loading$.next(!0),this._cancelled=!1,this._progress=0,this._progress$.next(this._progress),this._getScorecardData({selectedOrgUnits:this._selectedOrgUnits.map((e=>null===e||void 0===e?void 0:e.id)),selectedPeriods:this._selectedPeriods.map((e=>null===e||void 0===e?void 0:e.id)),selectedData:this._selectedData}))}getProgress(){return this._progress$.pipe((0,w.U)((e=>Math.floor(e/this._totalRequests*100))))}isRowEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.dataEntities$.pipe((0,w.U)((t=>{const n=(0,i.pickBy)(t,((t,n)=>n.match(RegExp(e))));return(0,i.isEmpty)(n)})))}isDataSourcesRowEmpty(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.dataEntities$.pipe((0,w.U)((t=>{const n=(0,i.pickBy)(t,((t,n)=>n.match(RegExp((0,i.head)(e)))||n.match(RegExp((0,i.last)(e)))));return(0,i.isEmpty)(n)})))}sortOrgUnitsByDataAndPeriod(e){let{dataSource:t,period:n,sortType:r}=e;return this.dataEntities$.pipe((0,b.q)(1),(0,w.U)((e=>{if(r===d.BQ.DEFAULT)return[];const o=(0,i.pickBy)(e,((e,r)=>{const[i,,o]=r.split("_");return i===t&&o===n})),a=(0,i.sortBy)((0,i.toPairs)(o),[e=>{var t;return+(null===(t=(0,i.last)(e))||void 0===t?void 0:t.current)}]);return r===d.BQ.DESC?a.reverse().map((e=>{let[t]=e;return null===t||void 0===t?void 0:t.split("_")[1]})):a.map((e=>{let[t]=e;return null===t||void 0===t?void 0:t.split("_")[1]}))})))}sortOrgUnitsByData(e){let{dataSource:t,periods:n=[],sortType:r}=e;return this.dataEntities$.pipe((0,b.q)(1),(0,w.U)((e=>{if(r===d.BQ.DEFAULT)return[];const o=(0,i.pickBy)(e,((e,r)=>{const[i,,o]=r.split("_");return i===t&&n.includes(o)})),a=(0,i.groupBy)((0,i.toPairs)(o),(e=>{var t;return(null===(t=(0,i.head)(e))||void 0===t?void 0:t.split("_"))[1]})),l={};(0,i.forIn)(a,((e,t)=>{l[t]=(0,i.reduce)(e,((e,t)=>{var r;return e+(null===(r=(0,i.last)(t))||void 0===r?void 0:r.current)/(null===n||void 0===n?void 0:n.length)}),0)}));const s=(0,i.sortBy)((0,i.toPairs)(l),[e=>(0,i.last)(e)]);var c;return r===d.BQ.DESC?null===s||void 0===s||null===(c=s.map((e=>{let[t]=e;return t})))||void 0===c?void 0:c.reverse():null===s||void 0===s?void 0:s.map((e=>{let[t]=e;return t}))})))}sortDataSourceByOrgUnitAndPeriod(e){let{orgUnit:t,period:n,sortType:r}=e;return this.dataEntities$.pipe((0,b.q)(1),(0,w.U)((e=>{if(r===d.BQ.DEFAULT)return[];const o=(0,i.pickBy)(e,((e,r)=>{const[,i,o]=r.split("_");return i===t&&o===n})),a=(0,i.sortBy)((0,i.toPairs)(o),[e=>{var t;return parseInt(null===(t=(0,i.last)(e))||void 0===t?void 0:t.current)}]);return r===d.BQ.DESC?a.reverse().map((e=>{let[t]=e;return null===t||void 0===t?void 0:t.split("_")[0]})):a.map((e=>{let[t]=e;return null===t||void 0===t?void 0:t.split("_")[0]}))})))}sortDataSourceByOrgUnit(e){let{periods:t,orgUnit:n,sortType:r}=e;return this.dataEntities$.pipe((0,b.q)(1),(0,w.U)((e=>{if(r===d.BQ.DEFAULT)return[];const o=(0,i.pickBy)(e,((e,r)=>{const[,i,o]=r.split("_");return i===n&&t.includes(o)})),a=(0,i.groupBy)((0,i.toPairs)(o),(e=>{var t;return(null===(t=(0,i.head)(e))||void 0===t?void 0:t.split("_"))[0]})),l={};(0,i.forIn)(a,((e,n)=>{l[n]=(0,i.reduce)(e,((e,n)=>{var r;return e+(null===(r=(0,i.last)(n))||void 0===r?void 0:r.current)/(null===t||void 0===t?void 0:t.length)}),0)}));const s=(0,i.sortBy)((0,i.toPairs)(l),[e=>(0,i.last)(e)]);var c;return r===d.BQ.DESC?null===s||void 0===s||null===(c=s.map((e=>{let[t]=e;return t})))||void 0===c?void 0:c.reverse():null===s||void 0===s?void 0:s.map((e=>{let[t]=e;return t}))})))}getOrgUnitAverage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return this.dataEntities$.pipe((0,w.U)((t=>{var n;const r=(0,i.pickBy)(t,((t,n)=>{const[,r,o]=n.split("_");return r===e&&!this._previousPeriods.includes(o)&&!!(0,i.find)(this._selectedPeriods,(e=>(null===e||void 0===e?void 0:e.id)===o))})),o=Object.keys(r).length;if(0!==(null===(n=(0,i.compact)(Object.values(r).map((e=>{let{current:t}=e;return t}))))||void 0===n?void 0:n.length))return(0,i.reduce)(r,((e,t)=>(null!==e&&void 0!==e?e:0)+t.current/o),0)})))}getDataSourceAverage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.dataEntities$.pipe((0,w.U)((t=>{const n={};for(const o of e){var r;const e=(0,i.pickBy)(t,((e,t)=>{var n;const[r,a,l]=t.split("_");return o===r&&!this._previousPeriods.includes(l)&&!!(0,i.find)(this._selectedPeriods,(e=>(null===e||void 0===e?void 0:e.id)===l))&&(null===(n=this._selectedOrgUnits)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id)).includes(a))})),a=Object.keys(e).length;0===(null===(r=(0,i.compact)(Object.values(e).map((e=>{let{current:t}=e;return t}))))||void 0===r?void 0:r.length)?n[o]=void 0:n[o]=(0,i.reduce)(e,((e,t)=>(null!==e&&void 0!==e?e:0)+t.current/a),0)}return n})))}getOrgUnitColumnAverage(e){let{period:t,orgUnit:n}=e;return this.dataEntities$.pipe((0,w.U)((e=>{var r;const o=(0,i.pickBy)(e,((e,r)=>{const[,i,o]=r.split("_");return i===n&&o===t})),a=Object.keys(o).length;if(0!==(null===(r=(0,i.compact)(Object.values(o).map((e=>{let{current:t}=e;return t}))))||void 0===r?void 0:r.length))return(0,i.reduce)(o,((e,t)=>(null!==e&&void 0!==e?e:0)+t.current/a),0)})))}getDataSourceColumnAverage(e){let{period:t,dataSources:n,orgUnits:r}=e;return this.dataEntities$.pipe((0,w.U)((e=>{const o={};for(const l of n){var a;const n=(0,i.pickBy)(e,((e,n)=>{const[i,o,a]=n.split("_");return l===i&&a===t&&(null===r||void 0===r?void 0:r.includes(o))})),s=Object.keys(n).length;0===(null===(a=(0,i.compact)(Object.values(n).map((e=>{let{current:t}=e;return t}))))||void 0===a?void 0:a.length)?o[l]=void 0:o[l]=(0,i.reduce)(n,((e,t)=>(null!==e&&void 0!==e?e:0)+t.current/s),0)}return o})))}getOverallAverage(e){return this.dataEntities$.pipe((0,w.U)((t=>{if(!(0,i.isEmpty)(t)){var n;const r=(0,i.pickBy)(t,((t,n)=>{const[,r,o]=n.split("_");return(null===e||void 0===e?void 0:e.includes(r))&&!this._previousPeriods.includes(o)&&!!(0,i.find)(this._selectedPeriods,(e=>(null===e||void 0===e?void 0:e.id)===o))})),o=Object.keys(r).length;if(0===(null===(n=(0,i.compact)(Object.values(r).map((e=>{let{current:t}=e;return t}))))||void 0===n?void 0:n.length))return;return(0,i.reduce)(r,((e,t)=>(null!==e&&void 0!==e?e:0)+t.current/o),0)}})))}getAllOrgUnitData(e){return this.dataEntities$.pipe((0,w.U)((t=>(0,i.pickBy)(t,((t,n)=>{const[,r]=n.split("_");return null===e||void 0===e?void 0:e.includes(r)})))))}get(e){return this.dataEntities$.pipe((0,w.U)((t=>t?t[e]:null)))}reset(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];this._totalRequests=0,this._progress=0,this._progress$=new E.X,this._loading$=new E.X,this._dataEntities={},this._dataEntities$=new E.X(this._dataEntities),this.dataEntities$=this._dataEntities$.asObservable(),this._previousPeriods=[],this._dataEntities={},this._cancelled=e}_getScorecardData(e){const{selectedOrgUnits:t,selectedPeriods:n,selectedData:r}=e,{normalDataItems:i,customDataItems:o}=r;this._getNormalScorecardData({selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:i}),this._getCustomScorecardData({selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:o})}_getAnalyticsData(e){if(!this._cancelled){var t,n,r,o,a;let l=[],s=[],c=[];return(e||[]).forEach((e=>{this._dataEntities[`${e.dx}_${e.ou}_${e.pe}`]||(l=[...l,e.dx],s=[...s,e.ou],c=[...c,e.pe])})),l=(0,i.uniq)(l),s=(0,i.uniq)(s),c=(0,i.uniq)(c),0===(null===(t=l)||void 0===t?void 0:t.length)&&0===(null===(n=s)||void 0===n?void 0:n.length)&&0===(null===(r=c)||void 0===r?void 0:r.length)?(0,S.of)(null).toPromise():(new p.Fn.Analytics).setOrgUnit(null===(o=s)||void 0===o?void 0:o.join(";")).setPeriod(null===(a=c)||void 0===a?void 0:a.join(";")).setData(l.join(";")).postProcess((e=>{this._updateDataEntities(null===e||void 0===e?void 0:e.rows)})).get()}return(0,S.of)(null).toPromise()}_getCustomAnalyticsData(e){if(!this._cancelled){var t,n,r;let o=[],a=[],l=[];return(e||[]).forEach((e=>{this._dataEntities[`${e.dx}_${e.ou}_${e.pe}`]||(o=[...o,e.dx],a=[...a,e.ou],l=[...l,e.pe])})),o=(0,i.uniq)(o),a=(0,i.uniq)(a),l=(0,i.uniq)(l),0===(null===(t=o)||void 0===t?void 0:t.length)&&0===(null===(n=a)||void 0===n?void 0:n.length)&&0===(null===(r=l)||void 0===r?void 0:r.length)?(0,S.of)(null).toPromise():getCustomFunctionAnalytics(this.engine,{functions:o,orgUnits:a,periods:l})}return(0,S.of)(null).toPromise()}_getNormalScorecardData(e){var t;const{selectedOrgUnits:n,selectedPeriods:r,selectedDataItems:o}=null!==e&&void 0!==e?e:{};let a=[];n.forEach((e=>{(0,i.chunk)(o.map((t=>r.map((n=>({dx:t.id,ou:e,pe:n}))))),2).forEach((e=>{a=[...a,(0,i.flatten)(e)]}))})),this._totalRequests=null===(t=a)||void 0===t?void 0:t.length,A()(a,10,((e,t)=>{this._getAnalyticsData(e).then((e=>{this._progress=this._progress+1,this._progress$.next(this._progress),t(null,e)})).catch((e=>{t(e,null)}))}),((e,t)=>{this._loading$.next(!1)}))}_getCustomScorecardData(e){window.$=U();const{selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:r}=null!==e&&void 0!==e?e:{};if(0===(null===r||void 0===r?void 0:r.length))return new Promise((e=>e(null)));let o=[];t.forEach((e=>{(0,i.chunk)(r.map((t=>n.map((n=>({dx:t.id,ou:e,pe:n}))))),2).forEach((e=>{o=[...o,(0,i.flatten)(e)]}))})),A()(o,10,((e,t)=>{this._getCustomAnalyticsData(e).then((e=>{var n,r;this._updateDataEntities(null!==(n=null===e||void 0===e||null===(r=e.rows)||void 0===r?void 0:r.map((e=>{let[t,n,r,o]=e;return(0,i.fromPairs)([["dx",{id:t}],["pe",{id:n}],["ou",{id:r}],["value",`${o}`]])})))&&void 0!==n?n:[]),this._progress=this._progress+1,this._progress$.next(this._progress),t(null,e)})).catch((e=>{t(e,null)}))}))}_getSelectedPeriods(e,t){if((null===e||void 0===e?void 0:e.length)>0)return e;try{var n,r,i;const e=null===(n=new h.Period)||void 0===n||null===(r=n.setPreferences({allowFuturePeriods:!0}).setType(t))||void 0===r||null===(i=r.get())||void 0===i?void 0:i.list(),o=e?e[0]:null;return[o,...null!==o&&void 0!==o&&o.lastPeriod?[null===o||void 0===o?void 0:o.lastPeriod]:[]]}catch(o){return console.warn(o),null}}_getSelectedData(e){const t=(0,i.flatten)((e||[]).map((e=>(0,i.flatten)(((null===e||void 0===e?void 0:e.dataHolders)||[]).map((e=>e.dataSources))))));return{normalDataItems:t.filter((e=>"customFunction"!==e.type)),customDataItems:t.filter((e=>"customFunction"===e.type))}}}class P extends o{get defaults(){return{id:(0,v.hQ)(),type:"",label:"",name:"",weight:100,effectiveGap:5,displayArrows:!0,highIsGood:!0,showColors:!0,legends:[],specificTargets:[],specificTargetsSet:!1}}}class T extends o{constructor(e){super(e)}get defaults(){return{id:(0,v.hQ)(),dataSources:[]}}static linkDataSource(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new T,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new P;return T.set(e,"dataSources",[...e.dataSources,t])}}class N extends o{get defaults(){return{id:(0,v.hQ)(),legendDefinitionId:"",startValue:null,endValue:null}}}class I extends o{constructor(e){super(e)}get defaults(){return{id:(0,v.hQ)(),title:"",dataHolders:[],style:{backgroundColor:"#FFFFFF",color:"#000000"}}}}},50963:function(e,t,n){n.d(t,{uN:function(){return i},$Q:function(){return o},sg:function(){return a},qF:function(){return c},aC:function(){return u},x1:function(){return l},by:function(){return s},Fk:function(){return d},_l:function(){return r},jL:function(){return m},A2:function(){return g}});n(81195);var r=n.p+"static/media/img.b7f44bd30d62ad7a852a.png",i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgBCigg8qRFlwAABGRJREFUaN7tmF1MW2UYx//v+ejpJ+uKVArrB1K+JnM1GwIGHYnxwk4mF154Rbj2wsGFCashkBnjLkxG4kxMjJnGmMy4RAQ7EmdCh94MXPy4IYtL1opCKCsc6MeBlnNeL5Als3z0tHXpSfq/anrePu/zO//3ed/nLVBWWUWTPxD07X7mtAjw6tBkN8uwX1DQTwH8qjmQ3tFpq7yVHCGEDDAsA1mWHz5jtALRc+FGL81IC4IgvDlzxgOTyfTIc67gN5ROXSaUhhjK3hq/9Eq46C4MTXkoiyuUKmedTieueBkANGtcQSBKRpoUdLoOAG+k02l97/DUXXlbngKY8cn3/bcKhTgXCJ6nhL6n1+v5rzrtB47lCphkjCFMx/UuB7cbZyDMNK1EH7jjifjAa+/cSAIkRBX5a7Vu+QNBH0fIhyyYdnedix/zKIf+Ji+QnkCwH8D58e5jj3w/5lEAj00P2NAd500NkfWza+L6S2rcOhcIjgAYtZjN21+22ThAySkn1SD+QNBHgKuNjQ0A0vuOC1kyCLUaARj1ubi1u6UShqkWT9VhwpJRlRuntrhpOjVjt1fhg2NpVS/gMLcUWWmy25/AJ61GABnVq0QVCM1IMwajwbgzWf7ay63PnBQiS/OOyamoi6sMIcevddjZYm+xuRRzUUB6AsF+AvR/0+0s2QOTUVfcpSvu0FOV0B8djmrVxV0yjvSOTlspi6DZbNZ/3Kwr+V5sXxAqb33E85x351CCNkF6Lnw3QCh9/XqXQweNiNnr0kIIuez11msGIqvY/YGgjyVkUgvFDSYDzvSgOsuR3tFpq45lrlmPWgU1xT0kLj12hreiv4Cr/AE643JzliNKOjXA87zzc18Fn0uw4XgKf61NYFFJo08EBK4CZqEJZr0b71qMRU9+OJ5CLHkbic0FcEdsMCgcNvdbWoJOlwZwaBaDK/OIJOdwoq4eJ+u9SG5KWIhGsRiLIBKbQ18MqDA0wCx4cMnqKAhgSFxCLHEbke0NPOWowYuu52GzWPD9z7NYy7dpHEnIWBQnkWIz8LfvBAQAk96AZpcbzS43AGBhJYrl1Rgi0Z/QJ0p5uTW4Mo916TdECUWLy4UW92noOL7wpnFwZR73k3NodrrwTL33wKDOKjucVXacbmpR5dZIQkYsOYsN6Q9smyrQ1tKIekdtcZrGiykei+K3SJEkXj7VhieP2lQtjVzdim/dxf3tDdRV16L9uPp5DgR5ezWMexszqKm0o+tE54Eu5Kq93FpaDaPGXgVvrQ8mvaF4TePFFI+/1yYQU0ScOfksnFX2/2Ub/a9bRe1+h8Ql3BNv/uvCC0Vx4bGe7KwQt3KVv5ujGwl0Pt2ac5GVHIhQ8adPMEqs/7nOvNdpyTSNBt6gSYgsEArt6iEI4aUwgbylpeQJL4WzQHghGSYM3dQSCC8kwzn/i6LZG2IZpAxSBimDlEHKIPneRxJSynzzzqwmEhcT8b1BFCihTAZYXl3TjAsKlBDKKlH9A2uhxAYqDYPmAAAAAElFTkSuQmCC",o="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgBCi0ogQg54AAAAF1JREFUaN7t1sENABEARUHUowxlK0M/uxU4kAhi3nUddiKRH4Ik7Sx2v9T2bfmjkuPI8XT7DQAAAAAAvA2QrhlzgyPNKwQAAAAAYMxJJ425RWPQKwQAAAAAIEma7gd8qAk6zZ+mSwAAAABJRU5ErkJggg==",a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgBCi4J5kx6fQAAAF5JREFUaN7t1sEJwCAMQNEojtMxOrZjdJ+6QA9CKaHk/bMHHxE1QpIya+k7mNe9te48Hvfa/z4BAIDqgPHV7WACAAAAAAAAr17ihL+9IwQAAAAAAAAAAAAAAAAgSWVa3dEJTJ4U+r4AAAAASUVORK5CYII=",l="data:image/png;base64,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",s="data:image/png;base64,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",c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAYAAACM/rhtAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAN1wAADdcBQiibeAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAGpSURBVFiF7Zg9S8NQFIbfJjdJFRzt0NXFj9oPQfwCcat2VFz9G9Z/UP0jpQgODkrBQRR1cNBqRScHUYe6ilKbpC7toHipJ/dckqHPGMLl4eQ95x4CRJwYAORL5/VqcT4VpsjKztmII+xd1/NHhWncvzexfrQ1/Wh0PCfClAMAx7IrhVwyvb2RG1jOJjND8XYZAIywxbq0XD+1mEqYg47A0mTCbLbaGSBCgo6I3ZzUG57r+Ti+bXi2ZVwDgAhbrMvnl796cPW6v3f5lI4LUXM/WmuAZkFZ8P9693Bz9hnA1O/nWj+xLPgUtArKgk9BbwUlwaegNYOy4JPJly7azG5skCpI6Uqu80gZ5OhK6nkkQY6upJ5HqyBDV1LPI2WQrSup50W5iyOzzcjQvs2ojibtFVQdTdoFVUeT/goqjibtGVQdTVJBrntXtin/F+kn5r53gyIV5L53gyKvIPO9GxRpBqnh5t4VewpSw+1YdqWQTaYXxofN07u3TLX2UgYwoyrINgd1ZZZNUFdm2QY19674g/4+qEBfUJXIC3Z+okeySR6qxbmxsCV68g24XGzi2T5o8AAAAABJRU5ErkJggg==",u="data:image/png;base64,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",d="data:image/png;base64,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",m="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgBCisuPjE7UwAAAGhJREFUaN7t1sEJgCAAhlFtCZdwjGjooE08tElN4EE9pPTetZA+AvlDAPhSrD047+vpOfAoaeyL9hxbXt9W/wMCBAgQIODfAbDMmGscaW4hAQIECBBgzMFMY25UZQy6hQQIECBAAADdXkveDzotuZk2AAAAAElFTkSuQmCC",g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAABmJLR0QA/wD/AP+gvaeTAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH4QgBCiwieMbhvwAAAG5JREFUaN7t1sENQDAAhtESozgaQwwtxrCEKTi6ODQR+YP3nWn60qZtKZKUrInPYFn3qu/G4XKu7dtXAADg74DuqdPBCgAAAAAAANy6iQNve1sIAMApdDb3W9UAU+AfWwgAAAAAAAAA4CMAScp2AMTtD3X9QcAUAAAAAElFTkSuQmCC"},25018:function(e,t,n){n.d(t,{X$:function(){return i},Um:function(){return c},EA:function(){return C},uy:function(){return v},yB:function(){return w},Vj:function(){return s},h9:function(){return u},A5:function(){return P},pT:function(){return y},be:function(){return f},Fy:function(){return R}});const r=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={};for(const n of e)t[n]={resource:`dataStore/functions/${n}`};return t};async function i(){let e=arguments.length>1?arguments[1]:void 0;const t=r(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]);return await e.query(t)}var o=n(48666),a=n(21386),l=n(69987);async function s(e){let{orgUnit:t,periods:n,dataSources:r}=e;try{const e=null===n||void 0===n?void 0:n.map((e=>{var t;const n=(new a.Period).setPreferences({allowFuturePeriods:!0}).getById(e);return null===n||void 0===n||null===(t=n.lastPeriod)||void 0===t?void 0:t.id})),i=(0,l.uniq)([...n,...e]);return await(new o.Fn.Analytics).setOrgUnit(t).setPeriod(null===i||void 0===i?void 0:i.join(";")).setData(r.join(";")).get()}catch(i){console.error(i)}}async function c(e){let{orgUnits:t,periods:n,highlightedIndicators:r}=e;try{return await(new o.Fn.Analytics).setOrgUnit(null===t||void 0===t?void 0:t.join(";")).setPeriod(null===n||void 0===n?void 0:n.join(";")).setData(null===r||void 0===r?void 0:r.join(";")).get()}catch(i){console.error(i)}}async function u(e){const t=function(e){var t;let n=[];e.userOrgUnit&&(n=["USER_ORGUNIT"]);e.userSubUnit&&(n=[...n,"USER_ORGUNIT_CHILDREN"]);e.userSubX2Unit&&(n=[...n,"USER_ORGUNIT_GRANDCHILDREN"]);(null===e||void 0===e||null===(t=e.orgUnitIds)||void 0===t?void 0:t.length)>0&&(n=null===e||void 0===e?void 0:e.orgUnitIds);return n}(e.orgUnitSelection),{currentPeriods:n,previousPeriods:r}=function(e,t){try{var n,r,i,o;const e=null===(n=(new a.Period).setPreferences({allowFuturePeriods:!0}))||void 0===n||null===(r=n.setType(t))||void 0===r||null===(i=r.get())||void 0===i?void 0:i.list(),l=e?e[0]:null;return{currentPeriods:l?[l.id]:[],previousPeriods:null!==l&&void 0!==l&&l.lastPeriod?[null===(o=l.lastPeriod)||void 0===o?void 0:o.id]:[]}}catch(l){return console.warn(l),null}}(e.periodSelection,e.periodType),i=function(e){const t=(0,l.flatten)(null===e||void 0===e?void 0:e.dataGroups.map((e=>(0,l.flatten)(((null===e||void 0===e?void 0:e.dataHolders)||[]).map((e=>e.dataSources))))));return{normalDataItems:t.filter((e=>"functionRule"!==e.type)),customDataItems:t.filter((e=>"functionRule"===e.type))}}(e.dataSelection);return Promise.all([d({selectedOrgUnits:t,selectedPeriods:n,selectedData:i}),d({selectedOrgUnits:t,selectedPeriods:r,selectedData:i})])}function d(e){const{selectedOrgUnits:t,selectedPeriods:n,selectedData:r}=e,{normalDataItems:i,customDataItems:o}=r;return new Promise(((e,r)=>{Promise.all([m({selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:i}),g({selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:o})]).then((t=>{e(t)})).catch((e=>{r(e)}))}))}function m(e){const{selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:r}=e;return(new o.Fn.Analytics).setOrgUnit(null===t||void 0===t?void 0:t.join(";")).setPeriod(null===n||void 0===n?void 0:n.join(";")).setData(r.map((e=>e.id)).join(";")).get()}function g(e){const{selectedOrgUnits:t,selectedPeriods:n,selectedDataItems:r}=e;if(0===(null===r||void 0===r?void 0:r.length))return new Promise((e=>e(null)));new Promise((e=>e(null)))}function v(e){var t;const{metaData:n}=null!==e&&void 0!==e?e:{},{ouHierarchy:r,items:i,ouNameHierarchy:o,dimensions:a}=null!==n&&void 0!==n?n:{},s=(0,l.omitBy)(r,(e=>!e));return null===a||void 0===a||null===(t=a.ou)||void 0===t?void 0:t.map((e=>{var t,n,r,a,l,c;const u=`${null!==(t=null===s||void 0===s?void 0:s[e])&&void 0!==t?t:""}/${e}`;return{id:e,displayName:null===i||void 0===i||null===(n=i[e])||void 0===n?void 0:n.name,path:u.startsWith("/")?u:`/${u}`,level:(null!==(r=null===s||void 0===s||null===(a=s[e])||void 0===a||null===(l=a.split("/"))||void 0===l?void 0:l.length)&&void 0!==r?r:0)+1,hierarchy:null===o||void 0===o||null===(c=o[e])||void 0===c?void 0:c.replace("/","")}}))}function f(e){return!e.match(/(LEVEL-)|(USER_)|(OU_GROUP-)\w+/)}const p=["keyCalendar"],h={system:{resource:"systemSettings",params:e=>{let{keys:t}=e;return{keys:null===t||void 0===t?void 0:t.map((e=>`key=${e}`))}}}};async function y(e){const{system:t}=await e.query(h,{variables:{keys:p}}),{keyCalendar:n}=null!==t&&void 0!==t?t:{};return{calendar:n}}var A=n(42622),E=n(23985);const S={scorecard:{resource:A.TP,id:e=>{let{id:t}=e;return t}}};async function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0;if(e)try{const n=await t.query(S,{variables:{id:e}});return{scorecard:function(e){var t;const{dataGroups:n}=null!==(t=e.dataSelection)&&void 0!==t?t:{},r=n.map((e=>({...e,dataHolders:(0,l.compact)(null===e||void 0===e?void 0:e.dataHolders)})));return{...e,dataSelection:{dataGroups:r}}}(null===n||void 0===n?void 0:n.scorecard)}}catch(n){return{error:n}}return{error:"not found"}}const b={orgUnits:{resource:"organisationUnits",params:e=>{let{orgUnits:t}=e;return{filter:[`id:in:[${null===t||void 0===t?void 0:t.join(",")}]`],fields:["path","displayName","level","id"]}}}};async function C(e,t){var n;let{orgUnitSelection:r}=e;const{orgUnits:i}=null!==r&&void 0!==r?r:{},{orgUnits:o}=await t.query(b,{variables:{orgUnits:null!==(n=null===i||void 0===i?void 0:i.map((e=>{let{id:t}=e;return t})))&&void 0!==n?n:[]}});return new E.v6({...r,orgUnits:null===o||void 0===o?void 0:o.organisationUnits})}var U=n(62685);const D={summary:{resource:A.TP,id:A.m5}},k={type:"create",resource:`${A.TP}/${A.m5}`,data:e=>{let{data:t}=e;return t}};async function P(e){try{const t=await e.query(D);return{summary:null===t||void 0===t?void 0:t.summary}}catch(n){var t;return 404===(null===n||void 0===n||null===(t=n.details)||void 0===t?void 0:t.httpStatusCode)?(await async function(e){return await e.mutate(k,{variables:{data:[]}})}(e),P(e)):{error:n}}}const T={scorecards:{resource:A.TP}},N={type:"update",resource:A.TP,id:A.m5,data:e=>{let{data:t}=e;return t}},I={scorecard:{resource:A.TP,id:e=>{let{id:t}=e;return t}}},R=async e=>{const{summary:t,error:n}=await P(e);if(!n){const{scorecards:n}=await e.query(T),r=(0,l.filter)(n,(e=>"settings"!==e&&"savedObjects"!==e));if(!(0,l.isEmpty)(r)){const n=(0,l.filter)(r,(e=>{var n;return!(null!==t&&void 0!==t&&null!==(n=t.map((e=>{let{id:t}=e;return t})))&&void 0!==n&&n.includes(e))}));if(!(0,l.isEmpty)(n)){const r=[...t];for(const t of n){const{scorecard:n}=await e.query(I,{variables:{id:t}}),i=(0,U.zp)(n);r.push(i)}await e.mutate(N,{variables:{data:r.filter((e=>!(0,l.isEmpty)((0,l.compact)(Object.values(e)))))}})}}}}},19511:function(e,t,n){n.d(t,{JU:function(){return S},r9:function(){return pe},FK:function(){return he},rL:function(){return ce},Gj:function(){return o},Te:function(){return le},Y$:function(){return ae},oC:function(){return ge},V:function(){return ve},QY:function(){return me},Hu:function(){return ye},R6:function(){return re},xV:function(){return C},Yx:function(){return V},PB:function(){return ne},x9:function(){return $},Gw:function(){return te},tR:function(){return X},Ee:function(){return K},P1:function(){return ee},gi:function(){return Q},Do:function(){return I},uu:function(){return ue},WK:function(){return j},tb:function(){return k},c3:function(){return D},Wm:function(){return N},gS:function(){return T},ss:function(){return P},Mm:function(){return _},ip:function(){return x},UB:function(){return M},Jm:function(){return E},L4:function(){return Z},Gs:function(){return R},z:function(){return G},z2:function(){return b},Cw:function(){return w},Bo:function(){return B},kq:function(){return F},oT:function(){return L},jw:function(){return O},EE:function(){return p},YI:function(){return ie},cv:function(){return oe},zT:function(){return Ae},tU:function(){return u},Vu:function(){return f},aF:function(){return v}});var r=n(69987),i=n(25435);const o=(0,i.atom)({key:"engineState",default:{}});var a=n(21386),l=n(26874);const s=["keyCalendar"],c={system:{resource:"systemSettings",params:e=>{let{keys:t}=e;return{keys:null===t||void 0===t?void 0:t.map((e=>`key=${e}`))}}}},u=(0,i.atom)({key:"system-settings-state",default:(0,i.selector)({key:"system-settings-selector",get:async e=>{let{get:t}=e;const n=t(o),{system:r}=await n.query(c,{variables:{keys:s}}),{keyCalendar:i}=null!==r&&void 0!==r?r:{};return{calendar:i}}})});var d=n(42622),m=n(62685);const g={user:{resource:"me",params:{fields:["id","displayName","userGroups","authorities","organisationUnits[id,level,displayName]"]}}},v=(0,i.atom)({key:"userState",default:(0,i.selector)({key:"userStateSelector",get:async e=>{let{get:t}=e;try{const e=t(o);if(e){const{user:t}=await e.query(g);return t||null}}catch(n){console.error(n)}}})}),f=(0,i.selectorFamily)({key:"user-scorecard-authority",get:e=>t=>{var n;let{get:i}=t;const o=(0,r.find)(i(w),["id",e]),a=i(v);return null!==(n=(0,m.YW)(a,o))&&void 0!==n?n:d.M4}}),p=(0,i.atom)({key:"screen-dimensions",default:{},effects_UNSTABLE:[e=>{let{setSelf:t}=e;function n(){t((0,m.iv)())}return window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)}]});var h=n(23985),y=n(25018);const A={legendDefinitions:[{color:"#D3D3D3",name:l.Z.t("N/A"),isDefault:!0,id:"N/A"},{color:"#FFFFFF",name:l.Z.t("No Data"),isDefault:!0,id:"No Data"},{id:(0,m.hQ)(),color:"#008000",name:l.Z.t("Target Reached/ On Track")},{id:(0,m.hQ)(),color:"#FFFF00",name:l.Z.t("Progress, but more effort required")},{id:(0,m.hQ)(),color:"#FF0000",name:l.Z.t("Not on track")}],options:new h.TI,publicAccess:new h.mx({id:"public",type:"public",access:d.rm.NO_ACCESS,displayName:"Public"}),orgUnitSelection:new h.v6,userGroupAccesses:[],userAccesses:[],highlightedIndicators:[]},E=(0,i.atom)({key:"scorecard-id",default:null}),S=(0,i.selector)({key:"all-scorecard-summary-state",get:async e=>{let{get:t}=e;const n=t(o);await(0,y.Fy)(n);const{summary:r,error:i}=await(0,y.A5)(n);if(i)throw i;return r}}),w=(0,i.atom)({key:"scorecard-summary",default:(0,i.selector)({key:"scorecard-summary-selector",get:async e=>{let{get:t}=e;const n=t(S),i=t(v);return(0,r.filter)(n,(e=>{var t;const{read:n}=null!==(t=(0,m.YW)(i,e))&&void 0!==t?t:{};return n}))}})}),b=(0,i.atomFamily)({key:"scorecardForceUpdateState",default:0}),C=(0,i.atom)({key:"isNewScorecard",default:void 0}),U=(0,i.atomFamily)({key:"scorecard-config",default:(0,i.selectorFamily)({key:"active-scorecard-config",get:e=>async t=>{let{get:n}=t;const r=n(o);if(n(b(e)),e){const{scorecard:t,error:n}=await(0,y.yB)(e,r);if(n){var i;if(404===(null===n||void 0===n||null===(i=n.details)||void 0===i?void 0:i.httpStatusCode))throw{...n,title:l.Z.t("Scorecard Not Found"),message:l.Z.t(`Scorecard with id ${e} could not be found.`)};throw n}const o=await(0,y.EA)(t,r);return{...t,orgUnitSelection:o}}return new h.eq(A)}})}),D=(0,i.atomFamily)({key:"scorecard-config-edit-state",default:(0,i.selectorFamily)({key:"scorecard-state-default",get:e=>async t=>{let{get:n}=t;const i=n(E);return(0,r.isEmpty)(i)?(0,r.get)(new h.eq(A),e):(0,r.get)(n(U(i)),e)}})}),k=(0,i.selectorFamily)({key:"scorecard-dirty-state-selector",get:e=>{let{key:t,path:n}=e;return e=>{let{get:i}=e;return(0,r.get)(i(D(t)),n)}},set:e=>{let{key:t,path:n}=e;return(e,i)=>{let{get:o,set:a}=e;const l=o(D(t)),s=(0,r.set)((0,r.cloneDeep)(l),n,i);a(D(t),s)}}}),P=(0,i.atom)({key:"scorecard-config-error-state",default:{}}),T=(0,i.selectorFamily)({key:"scorecard-config-error-selector",get:e=>t=>{let{get:n}=t;return(0,r.get)(n(P),e)},set:e=>(t,n)=>{let{set:i}=t;i(P,(t=>(0,r.set)(t,e,n)))}}),N=(0,i.atom)({key:"scorecard-edit-state",default:{}}),I=(0,i.atom)({key:"refresh-scorecard",default:0}),R=(0,i.atomFamily)({key:"scorecard-name-sort",default:{orgUnit:d.BQ.DEFAULT,data:d.BQ.DEFAULT}}),O=(0,i.atomFamily)({key:"scorecard-view-config",default:(0,i.selectorFamily)({key:"scorecardViewStateSelector",get:e=>t=>{var n,i;let{get:o}=t;const l=o(E),{calendar:s}=o(u),c=o(U(l));var d;if("periodSelection"===e&&(0,r.isEmpty)(null===c||void 0===c||null===(d=c.periodSelection)||void 0===d?void 0:d.periods)){const{periodType:e}=c,t=(new a.Period).setCalendar(s).setPreferences({allowFuturePeriods:!0});if(e)return t.setType(e),"Yearly"===e?{periods:[null===t||void 0===t||null===(n=t.get())||void 0===n?void 0:n.list()[0]],periodType:e}:{periods:null===t||void 0===t||null===(i=t.get())||void 0===i?void 0:i.list(),periodType:e}}return c[e]}})}),Z=(0,i.selectorFamily)({get:e=>t=>{let{get:n}=t;const i=n(O("legendDefinitions"));return e?(0,r.filter)(i,(e=>{let{isDefault:t}=e;return t})):(0,r.filter)(i,(e=>{let{isDefault:t}=e;return!t}))}}),L=(0,i.atomFamily)({key:"scorecard-table-state",default:{orgUnit:d.BQ.DEFAULT,data:d.BQ.DEFAULT}}),F=(0,i.selector)({key:"scorecard-table-orientation-default",get:e=>{var t;let{get:n}=e;const{showDataInRows:r}=null!==(t=n(O("options")))&&void 0!==t?t:{};return r?d.i5.DATA_VS_ORG_UNIT:d.i5.ORG_UNIT_VS_DATA},set:(e,t)=>{let{set:n}=e;n(O("options"),(e=>(0,r.set)((0,r.cloneDeep)(e),"showDataInRows",t===d.i5.DATA_VS_ORG_UNIT)))}}),B=(0,i.selectorFamily)({key:"scorecard-table-details",get:e=>t=>{let{get:n}=t;const r=n(F),i=n(Q),{dataGroups:o}=n(O("dataSelection")),{averageColumn:a}=n(O("options")),{filteredOrgUnits:l,childrenOrgUnits:s}=n(G(e)),{width:c}=n(p),u=(0,m.uK)(i,o,a),d=(0,m.G)(c,u),g=(0,m.lC)(i,[...l,...s],a),v=(0,m.G)(c,g);return"orgUnitsVsData"===r?{rows:"orgUnits",columns:["groups","data","periods"],tableWidth:(0,m.rW)(i,o,a),colSpan:u+2,nameColumnWidth:d}:{rows:"data",columns:["orgUnits","periods"],tableWidth:(0,m.Mc)(i,[...l,...s],a),colSpan:g+2,nameColumnWidth:v}}}),G=(0,i.atomFamily)({key:"selected-org-unit-state",default:(0,i.selectorFamily)({key:"selected-org-units-default",get:e=>async t=>{var n;let{get:i}=t,o=[];const a=i(ie(e));return 1===e.length&&(0,y.be)((0,r.head)(e))&&(o=i(te((0,r.head)(e)))),{childrenOrgUnits:o,filteredOrgUnits:a,orgUnitsCount:(null===(n=o)||void 0===n?void 0:n.length)+(null===a||void 0===a?void 0:a.length)}}})}),x=(0,i.atom)({key:"data-source-state",default:(0,i.selector)({key:"scorecard-data-sources-default",get:e=>{var t;let{get:n}=e;const{dataGroups:r}=null!==(t=n(O("dataSelection")))&&void 0!==t?t:{};return(0,m.DY)(r)}})}),_=(0,i.atomFamily)({key:"data-loading-state"}),V=(0,i.selector)({key:"is-specific-targets-set",get:e=>{let{get:t}=e;const{dataGroups:n}=t(O("dataSelection")),i=(0,m.on)(n);return(0,r.some)(i,"specificTargetsSet")}}),M=(0,i.atomFamily)({key:"scorecard-force-update-state",default:0});(0,i.atomFamily)({key:"scorecard-in-search-state",default:!1});var j=U;const Q=(0,i.selector)({key:"period-resolver",get:e=>{var t,n;let{get:i}=e;const{periods:o}=null!==(t=i(O("periodSelection")))&&void 0!==t?t:{},{calendar:l}=null!==(n=i(u))&&void 0!==n?n:{calendar:"gregorian"};if(!(0,r.isEmpty)(o)){const e=(0,r.filter)(o,(e=>{var t;let{id:n}=e;const r=(new a.Period).setPreferences({allowFuturePeriods:!0}).setCalendar(l).getById(n);return null===r||void 0===r||null===(t=r.type)||void 0===t?void 0:t.match(RegExp("Relative"))}));let t=[...(0,r.differenceBy)(o,e,"id")];for(const n of e){const e=(new a.Period).setPreferences({allowFuturePeriods:!0}).setCalendar(l).getById(null===n||void 0===n?void 0:n.id),i=(0,r.isArray)(null===e||void 0===e?void 0:e.iso)?null===e||void 0===e?void 0:e.iso:[null===e||void 0===e?void 0:e.iso];t=t.concat(i)}return(0,r.uniqBy)((0,r.compact)(t),"id")}return[]}}),{atomFamily:z}=n(25435),Y={orgUnit:{resource:"organisationUnits",id:e=>{let{id:t}=e;return t},params:{fields:["id","displayName","path","level"]}}},J={analytics:{resource:"analytics",params:e=>{let{id:t,level:n}=e;return{dimension:[`ou:${t};LEVEL-${n}`,`pe:${(new Date).getFullYear()}`],skipData:!0,hierarchyMeta:!0,showHierarchy:!0}}}},H={analytics:{resource:"analytics",params:e=>{let{ou:t,pe:n}=e;return{dimension:[`ou:${t.join(";")}`,`pe:${n}`],skipData:!0,hierarchyMeta:!0,showHierarchy:!0}}}},W={levels:{resource:"organisationUnitLevels",params:{fields:["id","displayName","level"]}}},q={groups:{resource:"organisationUnitGroups",params:{fields:["id","displayName"]}}},K=(0,i.atom)({key:"org-unit-levels",default:(0,i.selector)({key:"org-unit-levels-default",get:async e=>{let{get:t}=e;const n=t(o),{levels:r}=await n.query(W);return null===r||void 0===r?void 0:r.organisationUnitLevels}})}),X=(0,i.atom)({key:"org-unit-group",default:(0,i.selector)({key:"org-unit-group-default",get:async e=>{let{get:t}=e;const n=t(o),{groups:r}=await n.query(q);return null===r||void 0===r?void 0:r.organisationUnitGroups}})}),$=(0,i.selectorFamily)({key:"orgUnitSelector",get:e=>async t=>{let{get:n}=t;try{const t=n(o),{orgUnit:r}=await t.query(Y,{variables:{id:e}});return r}catch(r){return{}}}}),ee=z({key:"orgUnitPath",default:(0,i.selectorFamily)({key:"orgUnitPathSelector",get:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return async t=>{var n;let{get:i}=t;const o=(0,r.compact)(e.split("/"));return(null===(n=(0,r.sortBy)(i(ie(o)),"level"))||void 0===n?void 0:n.map((e=>{let{displayName:t}=e;return t}))).join("/")}}})}),te=(0,i.selectorFamily)({key:"org-unit-children",get:e=>async t=>{let{get:n}=t;const r=n(o),i=n($(e));if(i){var a;const{analytics:t}=await r.query(J,{variables:{id:e,level:i.level+1}});return null!==(a=(0,y.uy)(t))&&void 0!==a?a:[]}}}),ne=(0,i.selector)({key:"last-org-unit-level",get:e=>{let{get:t}=e;const n=t(K);return(0,r.reduce)(n,((e,t)=>t.level>e.level?t:e))}}),re=(0,i.selector)({key:"initial-org-units-resolver",get:async e=>{var t,n,i,o;let{get:a}=e;const{orgUnits:l,levels:s,groups:c,userOrgUnit:u,userSubUnit:d,userSubX2Unit:g}=null!==(t=a(O("orgUnitSelection")))&&void 0!==t?t:{},f=null!==(n=a(Q))&&void 0!==n?n:[],p=a(K),{dataGroups:h}=null!==(i=a(O("dataSelection")))&&void 0!==i?i:{},y=null!==(o=(0,m.DY)(h))&&void 0!==o?o:[],{organisationUnits:A}=a(v);let E=l;if(!(0,r.isEmpty)(y)&&!(0,r.isEmpty)(f)){var S,w;if(g&&(E=[...E,{id:"USER_ORGUNIT_GRANDCHILDREN"}]),d&&(E=[...E,{id:"USER_ORGUNIT_CHILDREN"}]),u&&(E=[...E,...A]),!(0,r.isEmpty)(s))E=[...E,...null!==(S=null===s||void 0===s?void 0:s.map((e=>{var t;return{id:`LEVEL-${null===(t=(0,r.find)(p,{id:e}))||void 0===t?void 0:t.level}`}})))&&void 0!==S?S:[]];if(!(0,r.isEmpty)(c))E=[...E,...null!==(w=null===c||void 0===c?void 0:c.map((e=>({id:`OU_GROUP-${e}`}))))&&void 0!==w?w:[]]}return{orgUnits:(0,r.uniqBy)(E,"id")}}}),ie=(0,i.selectorFamily)({key:"selected-org-units-resolver",get:e=>async t=>{let{get:n}=t;try{const t=n(o),i=(0,r.chunk)(e,5),a=await Promise.all(i.map((e=>(async(e,t)=>{const n=(new Date).getFullYear(),{analytics:r}=await e.query(H,{variables:{ou:null!==t&&void 0!==t?t:[],pe:n}});return(0,y.uy)(r)})(t,e))));return(0,r.flatten)(a)}catch(i){return console.error(i),[]}}}),oe=(0,i.atom)({key:"should-validate-state",default:!1}),ae=(0,i.selectorFamily)({key:"text-fields-error-state",get:e=>{let{id:t,validations:n}=e;return e=>{let{get:i}=e;if(i(oe)){const e=i(D(t));if(null!==n&&void 0!==n&&n.mandatory&&(0,r.isEmpty)(e))return l.Z.t("This field is required")}}}}),le=(0,i.selector)({key:"scorecard-error-state",get:e=>{let{getCallback:t}=e;return t((e=>{let{snapshot:t}=e;return()=>t.getLoadable((0,i.waitForAll)([...null===d.ds||void 0===d.ds?void 0:d.ds.map((e=>ae({id:e,validations:{mandatory:!0}}))),se])).contents}))}}),se=(0,i.selector)({key:"data-groups-error-state",get:e=>{let{get:t}=e;if(t(oe)){var n;const e=null===(n=t(D("dataSelection")))||void 0===n?void 0:n.dataGroups;return(0,m.o_)(e)||null}}}),ce=(0,i.selectorFamily)({key:"data-groups-validator",get:e=>t=>{let{get:n}=t;const r=n(se);return null===r||void 0===r?void 0:r[e]}});var ue=(0,i.atom)({key:"router-state",default:{previous:"/"}});const de=(0,i.atom)({key:"help-state",default:!1}),me=(0,i.atom)({key:"intro-js-state",default:[]}),ge=(0,i.atom)({key:"current-step-index",default:0});var ve=de;const fe={keys:{resource:"dataStore/functions"}},pe=(0,i.atom)({key:"customFunctionsKeys",default:(0,i.selector)({key:"customFunctionKeysSelector",get:async e=>{let{get:t}=e;try{const e=t(o),{keys:n}=await e.query(fe);return n||[]}catch(n){return[]}}})}),he=(0,i.atom)({key:"customFunctions",default:(0,i.selector)({key:"customFunctionsSelector",get:async e=>{let{get:t}=e;const n=t(o),r=t(pe);return await(0,y.X$)(r,n)}})}),ye=(0,i.atom)({key:"highlighted-indicators-state",default:(0,i.selector)({key:"highlighted-indicators-selector",get:async e=>{let{get:t}=e;const{orgUnits:n}=t(re),i=t(Q),o=t(O("highlightedIndicators"));if(!(0,r.isEmpty)(n)&&!(0,r.isEmpty)(i)&&!(0,r.isEmpty)(o)){var a,l;const e=await(0,y.Um)({orgUnits:[null===(a=n[0])||void 0===a?void 0:a.id],periods:[null===(l=i[0])||void 0===l?void 0:l.id],highlightedIndicators:null===o||void 0===o?void 0:o.map((e=>{let{id:t}=e;return t}))});if(!(0,r.isEmpty)(e)){const{rows:t,headers:n}=e._data,i=(0,r.findIndex)(n,["name","dx"]),o=(0,r.findIndex)(n,["name","value"]),a={};for(const e of t)a[e[i]]=e[o];return a}return[]}}})}),Ae=(0,i.selectorFamily)({key:"highlighted-indicator-single-selector",get:e=>t=>{let{get:n}=t;return(0,r.get)(n(ye),e)}})},62685:function(e,t,n){n.d(t,{Jc:function(){return R},H3:function(){return j},Yo:function(){return p},c1:function(){return f},zp:function(){return M},uK:function(){return W},lC:function(){return K},By:function(){return J},Gy:function(){return o},gf:function(){return g},mD:function(){return S},on:function(){return E},DY:function(){return A},V3:function(){return $},EM:function(){return U},G:function(){return X},O_:function(){return V},rW:function(){return H},Mc:function(){return q},YW:function(){return I},rs:function(){return re},iv:function(){return m},Bn:function(){return O},Rz:function(){return h},i5:function(){return P},A$:function(){return T},t7:function(){return D},eL:function(){return k},zZ:function(){return y},Nt:function(){return b},hQ:function(){return v},$$:function(){return a},hs:function(){return l},Dq:function(){return w},o_:function(){return te},xb:function(){return ne}});const r={object:{resource:"identifiableObjects",id:e=>{let{id:t}=e;return t}}};function i(e){switch(e){case"indicators":return"indicator";case"dataElements":case"eventDataItems":return"dataElement";case"dataSets":return"dataSet";case"programIndicators":return"programIndicator";default:return e}}async function o(e,t){try{var n;const{object:a}=null!==(n=await e.query(r,{variables:{id:t}}))&&void 0!==n?n:{};if(a.href){var o;return{type:i(function(e){const t=e.split("/");return t[t.length-2]}(a.href)),name:null!==(o=a.displayName)&&void 0!==o?o:a.name}}return null}catch(a){return null}}function a(e,t,n){if(!isNaN(n)&&!isNaN(t)){const r=e[t],i=[...e];return i.splice(t,1),i.splice(n,0,r),i}return e}function l(e,t){let{sourceList:n,destinationList:r}=e,{sourceIndex:i,destinationIndex:o}=t;if(!isNaN(o)&&!isNaN(i)){const e=n[i],t=[...n],a=[...r];return t.splice(i,1),a.splice(o,0,e),{destinationList:a,sourceList:t}}}var s=n(71387),c=n(69987),u=n(23985),d=n(42622);function m(){const{innerWidth:e,innerHeight:t}=window;return{width:e>1366?e:1366,height:(t>763?t:763)-48}}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(0,c.snakeCase)(e).split("_").map((e=>(0,c.capitalize)(e)[0])).join("")}function v(){const e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",t="0123456789"+e,n=t.length;let r;r=e.charAt(Math.random()*e.length);for(let i=1;i<11;++i)r+=t.charAt(Math.random()*n);return r}function f(e){const t=e||100;return Math.floor(Math.random()*t)}function p(){let e=arguments.length>1?arguments[1]:void 0,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!(arguments.length>2&&void 0!==arguments[2])||arguments[2]||(t=t.reverse()),!(0,c.isEmpty)(t)){var n;const r=null!==e&&void 0!==e?e:100,i=r/(null===(n=t)||void 0===n?void 0:n.length),o=[];let a=t.length-1;for(let e=0;e<r;e+=i){const{id:n}=t[a];o.push(new u.bh({startValue:Math.floor(e),endValue:Math.floor(e+i),legendDefinitionId:n})),a--}return o}return[]}function h(e){}function y(e){return(0,c.reduce)(e,((e,t)=>e||t.specificTargetsSet),!1)}function A(){var e;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return(0,c.flattenDeep)(null!==(e=null===t||void 0===t?void 0:t.map((e=>{let{dataHolders:t}=e;return t})))&&void 0!==e?e:[])}function E(e){const t=(0,c.compact)(A(e));return(0,c.flattenDeep)(null===t||void 0===t?void 0:t.map((e=>{let{dataSources:t}=e;return t})))}function S(e){var t,n,r;return(null===e||void 0===e?void 0:e.length)>1?`${null===(t=(0,c.head)(e))||void 0===t?void 0:t.label} / ${null===(n=(0,c.last)(e))||void 0===n?void 0:n.label}`:`${null===(r=(0,c.head)(e))||void 0===r?void 0:r.label}`}function w(e,t){const{page:n,pageSize:r}=e;return{page:n,pageSize:r,pageCount:Math.ceil(t/r),total:t}}function b(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return(0,c.truncate)(e,{length:t})}function C(e,t,n){var r;let{max:i,legendDefinitions:o}=n;if((t=+t)>i)return(0,c.find)(o,{id:"N/A"});if(isNaN(t))return(0,c.find)(o,{id:"No Data"});const{legendDefinitionId:a}=null!==(r=(0,c.find)(e,(e=>{if(e){const{startValue:n,endValue:r}=e;return+r===i?+n<=t&&+r>=t:+n<=t&&+r>t}return!1})))&&void 0!==r?r:{};return(0,c.find)(o,["id",a])}function U(e,t,n){let{max:r=100,orgUnitLevels:i=[],dataOrgUnitLevel:o,legendDefinitions:a,specificTargets:l,period:s,orgUnit:u}=n;if(!(0,c.isEmpty)(l)){const n=(0,c.head)(l);if(n){if("period"===n.type){var d;const i=null!==(d=function(e,t){if(e.items.includes(t))return e.legends}(n,s))&&void 0!==d?d:t;return C(i,e,{max:r,legendDefinitions:a})}if("orgUnit"===n.type){var m;const i=null!==(m=function(e,t){if(e.items.includes(t))return e.legends}(n,u))&&void 0!==m?m:t;return C(i,e,{max:r,legendDefinitions:a})}}}if(Array.isArray(t)){return C([...t],e,{max:r,legendDefinitions:a})}if("object"===typeof t){const n=function(e,t){var n;return null===(n=(0,c.find)(e,["level",t]))||void 0===n?void 0:n.id}(i,o);if(n){return C(t[n],e,{max:r,legendDefinitions:a})}}}function D(e){let{orgUnitSort:t,filteredOrgUnits:n,childrenOrgUnits:r}=e;const i=[],o=[];for(const a of t)i.push((0,c.find)(n,["id",a])),o.push((0,c.find)(r,["id",a]));return{parentOrgUnits:(0,c.uniqBy)((0,c.compact)([...i,...n]),"id"),childOrgUnits:(0,c.uniqBy)((0,c.compact)([...o,...r]),"id")}}function k(e){let{sort:t,filteredOrgUnits:n,childrenOrgUnits:r}=e,i=r,o=n;return t===d.BQ.ASC&&(i=(0,c.sortBy)(r,"displayName")),t===d.BQ.DESC&&(i=(0,c.sortBy)(r,"displayName").reverse()),t===d.BQ.ASC&&(o=(0,c.sortBy)(n,"displayName")),t===d.BQ.DESC&&(o=(0,c.sortBy)(n,"displayName").reverse()),{childOrgUnits:i,parentOrgUnits:o}}function P(e){let{dataSort:t,dataSources:n}=e;const r=[];for(const i of t)r.push((0,c.find)(n,(e=>{let{dataSources:t}=e;return!!(0,c.find)(t,["id",i])})));return(0,c.uniqBy)(r,"id")}function T(e){let{sort:t,dataSources:n}=e,r=n;return t===d.BQ.ASC&&(r=(0,c.sortBy)(n,"displayName")),t===d.BQ.DESC&&(r=(0,c.sortBy)(n,"displayName").reverse()),r}function N(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";const t={read:!1,write:!1};return e.includes("r")&&(t.read=!0),e.includes("w")&&(t.write=!0),t}function I(e,t){const{user:n,userAccesses:r,userGroupAccesses:i,publicAccess:o}=null!==t&&void 0!==t?t:{};if((null===e||void 0===e?void 0:e.id)===n)return{...N("rw-----"),delete:!0};if(!(0,c.isEmpty)(r)){const t=(0,c.find)(r,["id",null===e||void 0===e?void 0:e.id]);if(t)return N(null===t||void 0===t?void 0:t.access)}if(!(0,c.isEmpty)(i)){const t=(0,c.intersectionBy)([...i],[...e.userGroups],"id");if(!(0,c.isEmpty)(t)){const e=t.map((e=>{let{access:t}=e;return t})).map(N);return{read:(0,c.reduce)(e,((e,t)=>e||t.read),!1),write:(0,c.reduce)(e,((e,t)=>e||t.write),!1)}}}return o?N(null===o||void 0===o?void 0:o.access):d.M4}function R(e,t,n){let r=e;const i=n.major>=2&&n.minor>=35,o=(i?t.name:t.title).replace(/[^A-Za-z0-9\s-]/g,"").replace(/\s+/g,"-");t.coreApp&&i?r+=`/dhis-web-${o}/`:r+=`/api/apps/${o}/`,i||(r+="index.html");const a=r.substr(0,r.indexOf("://")+3);return r=a+r.substr(a.length).replace(/\/+/g,"/"),r}async function O(e,t){try{var n,r,i,o,a,l,u,d,m,g,v;if(e)return{id:null===e||void 0===e?void 0:e.id,name:null===e||void 0===e||null===(n=e.header)||void 0===n?void 0:n.title,title:null===e||void 0===e||null===(r=e.header)||void 0===r?void 0:r.title,subtitle:null===e||void 0===e||null===(i=e.header)||void 0===i?void 0:i.sub_title,description:null===e||void 0===e||null===(o=e.header)||void 0===o?void 0:o.description,user:{id:null===e||void 0===e||null===(a=e.user)||void 0===a?void 0:a.id},periodType:null===e||void 0===e?void 0:e.periodType,customHeader:null===e||void 0===e||null===(l=e.header)||void 0===l||null===(u=l.template)||void 0===u?void 0:u.content,publicAccess:B(null===e||void 0===e?void 0:e.user_groups),userAccesses:[],userGroupAccesses:G(null===e||void 0===e?void 0:e.user_groups),targetOnLevels:!1,periodSelection:(p=e.selected_periods,h=e.periodType,{periods:p.map((e=>({id:e.id,name:e.name}))),type:h}),orgUnitSelection:F(e.orgunit_settings),dataSelection:await Z(e.data_settings,t),additionalLabels:e.additional_labels,legendDefinitions:(f=null===e||void 0===e?void 0:e.legendset_definitions,(f||[]).map((e=>{const t=(0,c.has)(e,"default");return t?{id:e.definition,color:e.color,name:e.definition,isDefault:e.default}:{id:e.color,color:e.color,name:e.definition}}))),options:{title:!0,legend:null===e||void 0===e||null===(d=e.header)||void 0===d?void 0:d.show_legend_definition,emptyRows:null===e||void 0===e?void 0:e.empty_rows,averageRow:null===e||void 0===e?void 0:e.show_average_in_row,itemNumber:!0,averageColumn:null===e||void 0===e?void 0:e.show_average_in_column,showHierarchy:null===e||void 0===e?void 0:e.show_hierarchy,averageDisplayType:null===e||void 0===e||null===(m=e.average_selection)||void 0===m?void 0:m.toUpperCase(),highlightedIndicators:null===e||void 0===e||null===(g=e.highlighted_indicators)||void 0===g?void 0:g.display},highlightedIndicators:await(0,s.UI)((null===e||void 0===e||null===(v=e.highlighted_indicators)||void 0===v?void 0:v.definitions)||[],(async e=>await L(e,t)))}}catch(y){console.error(y)}var f,p,h}async function Z(e,t){return{dataGroups:await(0,s.UI)((null===e||void 0===e?void 0:e.indicator_holder_groups)||[],(async n=>({id:null===n||void 0===n?void 0:n.id,style:{color:"#000000",backgroundColor:n.background_color},title:null===n||void 0===n?void 0:n.name,dataHolders:(0,c.compact)(await(0,s.UI)(null===n||void 0===n?void 0:n.indicator_holder_ids,(async n=>await async function(e,t,n){var r;const i=(0,c.find)(e,["holder_id",t]);return i?{id:i.holder_id,dataSources:await(0,s.UI)(null!==(r=i.indicators)&&void 0!==r?r:[],(async e=>await L(e,n)))}:void 0}(e.indicator_holders,n,t))))})))}}async function L(e,t){var n,r,i,a;const{name:l,type:s}=null!==(n=await o(t,e.id))&&void 0!==n?n:{};return{id:e.id,name:null!==(r=e.title)&&void 0!==r?r:l,type:null!==s&&void 0!==s?s:"customFunction",label:e.title,weight:e.weight,legends:e.legendset.map((e=>({id:v(),legendDefinitionId:null===e||void 0===e?void 0:e.color,endValue:"string"===typeof(null===e||void 0===e?void 0:e.max)?parseFloat(null===e||void 0===e?void 0:e.max):null===e||void 0===e?void 0:e.max,startValue:"string"===typeof(null===e||void 0===e?void 0:e.min)?parseFloat(null===e||void 0===e?void 0:e.min):e.min}))),highIsGood:null===e||void 0===e?void 0:e.high_is_good,showColors:null===e||void 0===e?void 0:e.legend_display,effectiveGap:(null===e||void 0===e||null===(i=e.arrow_settings)||void 0===i?void 0:i.effective_gap)||5,displayArrows:null===e||void 0===e||null===(a=e.arrow_settings)||void 0===a?void 0:a.display}}function F(e){var t,n,r;return{groups:(null===e||void 0===e||null===(t=e.selected_groups)||void 0===t?void 0:t.map((e=>null===e||void 0===e?void 0:e.id)))||[],levels:(null===e||void 0===e||null===(n=e.selected_levels)||void 0===n?void 0:n.map((e=>null===e||void 0===e?void 0:e.id)))||[],orgUnits:null===e||void 0===e||null===(r=e.selected_orgunits)||void 0===r?void 0:r.map((e=>({id:e.id}))),userOrgUnit:Boolean((0,c.find)(null===e||void 0===e?void 0:e.selected_user_orgunit,["id","USER_ORGUNIT"])),userSubUnit:Boolean((0,c.find)(null===e||void 0===e?void 0:e.selected_user_orgunit,["id","USER_ORGUNIT_CHILDREN"])),userSubX2Unit:Boolean((0,c.find)(null===e||void 0===e?void 0:e.selected_user_orgunit,["id","USER_ORGUNIT_GRANDCHILDREN"]))}}function B(e){return{id:"public",type:"public",access:x((0,c.find)(e,["id","all"])),displayName:"Public"}}function G(e){const t=null===e||void 0===e?void 0:e.filter((e=>"all"!==e.id));return null===t||void 0===t?void 0:t.map((e=>({id:null===e||void 0===e?void 0:e.id,type:"userGroup",access:x(e),displayName:null===e||void 0===e?void 0:e.name})))}function x(e){return null!==e&&void 0!==e&&e.see?"r-----":"------"}var _=n(26874);function V(e,t){let{orgUnitLevels:n,orgUnitGroups:r}=t;const{orgUnits:i,levels:o,groups:a,userOrgUnit:l,userSubUnit:s,userSubX2Unit:u}=e,d=[...i];return l&&d.push({name:_.Z.t("User Organisation Unit")}),s&&d.push({name:_.Z.t("User Sub-units")}),u&&d.push({name:_.Z.t("User Sub-x2-units")}),(0,c.isEmpty)(o)||d.push({name:`Levels: ${null===o||void 0===o?void 0:o.map((e=>{var t;return(null!==(t=(0,c.find)(n,["id",e]))&&void 0!==t?t:{}).displayName}))}`}),(0,c.isEmpty)(a)||d.push({name:`Groups: ${null===a||void 0===a?void 0:a.map((e=>(0,c.find)(r,["id",e]).displayName))}`}),d}function M(e){const t={};for(const n of d.hL)t[n.key]=(0,c.get)(e,n.path);return t}const j=e=>({type:"create",resource:`${d.TP}/${e}`,data:e=>{let{data:t}=e;return t}}),Q={function:{resource:"dataStore/functions",id:e=>{let{id:t}=e;return t}}};async function z(e){let{customFunction:t,ruleId:n,orgUnits:r,periods:i}=e;try{if(t){const e=(0,c.find)(null===t||void 0===t?void 0:t.rules,{id:n});if(e){var o;const n=await async function(e){let{orgUnits:t,periods:n,rule:r,code:i,progress:o}=e;const a={ou:t.join(";"),pe:n.join(";"),rule:r,layout:{rows:["dx"],column:["ou"],filter:["pe"]},progress:o};return await new Promise(((e,t)=>{try{Function("parameters",`${i}`)({...a,success:e,error:e=>{t(e||"Unknown error")}})}catch(n){t(n)}setTimeout((()=>{t("Function timed out")}),6e4)}))}({orgUnits:r,periods:i,rule:{...e,json:"string"===typeof e.json?JSON.parse(e.json):e.json},code:null!==(o=null===t||void 0===t?void 0:t.function)&&void 0!==o?o:"",progress:()=>{}});if(n)return function(e,t){var n,r,i;let{customFunction:o,rule:a}=t;const l={...e},s=`${o.id}.${a.id}`,u=(0,c.findIndex)(null===l||void 0===l?void 0:l.headers,{name:"dx"});return(0,c.set)(l,"metaData.dimensions.dx",[s]),l.metaData.items[s]={name:`${o.name} - ${a.name}`},l.metaData.names={},(0,c.forIn)(null===l||void 0===l||null===(n=l.metaData)||void 0===n?void 0:n.items,((e,t)=>{l.metaData.names[t]=null===e||void 0===e?void 0:e.name})),(0,c.forIn)(null===(r=l.metaData)||void 0===r?void 0:r.dimensions,((e,t)=>{l.metaData[t]=e})),(0,c.set)(l,"rows",null===l||void 0===l||null===(i=l.rows)||void 0===i?void 0:i.map((e=>{const t=[...e];return(0,c.set)(t,u,s),t}))),l}(n,{customFunction:t,rule:e})}}}catch(a){return console.error(a),null}return null}async function Y(e,t,n){let{periods:r,orgUnits:i}=n;try{if(e){var o,a;const[n,l]=null!==(o=null===e||void 0===e?void 0:e.split("."))&&void 0!==o?o:[],{function:s}=null!==(a=await async function(e,t){return await e.query(Q,{variables:{id:t}})}(t,n))&&void 0!==a?a:{};return await z({customFunction:s,ruleId:l,periods:r,orgUnits:i})}}catch(l){console.error(l)}}async function J(e,t){let{functions:n,periods:r,orgUnits:i}=t;try{if(n&&!(0,c.isEmpty)(n)){const t=(0,c.compact)(await Promise.all(n.map((t=>Y(t,e,{periods:r,orgUnits:i})))));return(0,c.reduce)(t,((e,t)=>(0,c.mergeWith)(e,t,((e,t)=>{if(Array.isArray(e))return e.concat(t)}))),{})}}catch(o){console.error(o)}}function H(){return 105*W(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],arguments.length>2?arguments[2]:void 0)+200}function W(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const r=(null===e||void 0===e?void 0:e.length)||1;return t.reduce(((e,t)=>{var n;return e+(null===(n=t.dataHolders)||void 0===n?void 0:n.length)}),0)*r+(n?1:0)}function q(e,t,n){return 105*K(e,t,n)+200}function K(e,t,n){const r=(null===e||void 0===e?void 0:e.length)||1;return(t.length||1)*r+(n?1:0)}function X(e,t){const n=function(e,t){return d.jl.CELL_WIDTH*t}(0,t),r=100-n/e*100;return r>30?"30%":r>10?`${Math.abs(r)}%`:"200px"}function $(e,t,n){const r=parseFloat(e),i=parseFloat(t);if(Math.abs(r-i)>=parseInt(n)){if(r>i)return"increasing";if(r<i)return"decreasing"}return null}function ee(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const n={};return(0,c.forIn)(e,((r,i)=>{t.includes(i)&&(0,c.isEmpty)((0,c.get)(e,i))&&(n[`${i}`]=_.Z.t("This field is required"))})),n}function te(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t={};for(const n of e)(0,c.isEmpty)(n.dataHolders)&&(t[n.id]=_.Z.t("This group does not have any configured data sources"));return t}function ne(e){var t,n;return null!==(t={...ee(e,d.ds),...te(null===e||void 0===e||null===(n=e.dataSelection)||void 0===n?void 0:n.dataGroups)})&&void 0!==t?t:{}}function re(e,t){switch(t.id){case"general":return d.lN;case"dataConfiguration":return d.ey;case"highlightedIndicator":return d.KR;case"access":return d.O1;case"options":return d.Xv;default:return[]}}}}]);
//# sourceMappingURL=app.4e434d8c.chunk.js.map