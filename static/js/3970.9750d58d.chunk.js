"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[3970],{63970:function(e,t,a){a.r(t),a.d(t,{default:function(){return oe}});var r=a(21758),l=a(4147),n=a(16272),i=a(66190),o=a(17092),c=a(34174),s=a(96098),m=a(80629),d=a(77337),u=a(25363),p=a(52637),v=a(22063),g=a(6023),h=a(48978),E=a(17459),_=a(64352),C=a(26095),S=a(83387),y=a(26906),f=a(41887),b=a(30732),N=a(48389),A=a(67857),w=a(55360),D=a(79817),k=a(9261),T=a(94883),x=a(88295),I=a(96915),P=a(22173),$=a(65374),R=a(62349),L=a(32831),M=a(28576),H=a(86659),z={container:"StaticCards_container__SBOWl",header:"StaticCards_header__oO4oN",headerContent:"StaticCards_headerContent__lQIp-",headerText:"StaticCards_headerText__R7ozs",pageTitle:"StaticCards_pageTitle__ye8tC",pageSubtitle:"StaticCards_pageSubtitle__JjDng",userInfo:"StaticCards_userInfo__Mmv2U",userAvatar:"StaticCards_userAvatar__WxC3p",mainGrid:"StaticCards_mainGrid__3ccCt",leftColumn:"StaticCards_leftColumn__EDej2",rightColumn:"StaticCards_rightColumn__baJDe",welcomeCard:"StaticCards_welcomeCard__-dJXF",quickActionsCard:"StaticCards_quickActionsCard__Qycer",performanceOverview:"StaticCards_performanceOverview__kqyFx",programDistribution:"StaticCards_programDistribution__g9M3F",thematicAreasGrid:"StaticCards_thematicAreasGrid__2Y9QR",thematicAreaCard:"StaticCards_thematicAreaCard__LrFE4",thematicAreaHeader:"StaticCards_thematicAreaHeader__73JnT",thematicAreaIcon:"StaticCards_thematicAreaIcon__2jorg",thematicAreaInfo:"StaticCards_thematicAreaInfo__yo9Na",thematicAreaName:"StaticCards_thematicAreaName__xW69t",thematicAreaStats:"StaticCards_thematicAreaStats__zsLVZ",thematicAreaContent:"StaticCards_thematicAreaContent__OGVh6",bestPerformingProject:"StaticCards_bestPerformingProject__YP7H1",bestProjectLabel:"StaticCards_bestProjectLabel__VS3Iz",bestProjectInfo:"StaticCards_bestProjectInfo__RAQHh",bestProjectName:"StaticCards_bestProjectName__AQcjn",bestProjectReach:"StaticCards_bestProjectReach__vp80J",reachBreakdown:"StaticCards_reachBreakdown__jynzg",reachItem:"StaticCards_reachItem__KjicG",reachLabel:"StaticCards_reachLabel__GHTFP",reachValue:"StaticCards_reachValue__OzXuI",sectionHeader:"StaticCards_sectionHeader__qKSgl",metricsGrid:"StaticCards_metricsGrid__aVy9o",metricCard:"StaticCards_metricCard__kgRCj",metricIcon:"StaticCards_metricIcon__5SYNd",metricContent:"StaticCards_metricContent__yBk7Z",metricValue:"StaticCards_metricValue__1HeFD",metricLabel:"StaticCards_metricLabel__ZfXEe",sectionTitle:"StaticCards_sectionTitle__shLQB",quickActionsContainer:"StaticCards_quickActionsContainer__Lm77K",cardGrid:"StaticCards_cardGrid__bDAxA",cardWrapper:"StaticCards_cardWrapper__1lgvc",navCard:"StaticCards_navCard__ipBCw",cardContent:"StaticCards_cardContent__3S9XH",cardIconWrapper:"StaticCards_cardIconWrapper__zu9XP",cardTextContent:"StaticCards_cardTextContent__XtVwL",cardTitle:"StaticCards_cardTitle__m7dOf",cardDescription:"StaticCards_cardDescription__btTRK",expandIcon:"StaticCards_expandIcon__Mg2+D",expandableContent:"StaticCards_expandableContent__LcIHH",linkGrid:"StaticCards_linkGrid__pFi0Y",linkItem:"StaticCards_linkItem__SJX6T",activityContainer:"StaticCards_activityContainer__8iYyk",distributionContainer:"StaticCards_distributionContainer__uiCxl",activityHeader:"StaticCards_activityHeader__AvWu+",activityTitleWrapper:"StaticCards_activityTitleWrapper__seICx",activityIconWrapper:"StaticCards_activityIconWrapper__e1E40",activityTitle:"StaticCards_activityTitle__zGFsl",activityContent:"StaticCards_activityContent__NhxaR",activityLoader:"StaticCards_activityLoader__pcN+C",activityList:"StaticCards_activityList__P2tFa",activityItem:"StaticCards_activityItem__eT6ZM",activityItemIcon:"StaticCards_activityItemIcon__DSnDh",activityItemContent:"StaticCards_activityItemContent__6phuh",activityItemHeader:"StaticCards_activityItemHeader__iyg0O",activityType:"StaticCards_activityType__T4BBQ",activityTime:"StaticCards_activityTime__ONTp0",activityDescription:"StaticCards_activityDescription__UfPzY",activityStatus:"StaticCards_activityStatus__zredR",success:"StaticCards_success__-MGvw",active:"StaticCards_active__b68Qa",error:"StaticCards_error__LQe39",emptyState:"StaticCards_emptyState__HIbWD",chartsContainer:"StaticCards_chartsContainer__L-4Kp",chartCard:"StaticCards_chartCard__nbO4r",tableCard:"StaticCards_tableCard__0Mdxx",chartHeader:"StaticCards_chartHeader__zM+sT",chartTitle:"StaticCards_chartTitle__djvKy",chartContent:"StaticCards_chartContent__aOBRf","recharts-tooltip-wrapper":"StaticCards_recharts-tooltip-wrapper__3UAhQ","recharts-default-tooltip":"StaticCards_recharts-default-tooltip__ndsnq","recharts-tooltip-content":"StaticCards_recharts-tooltip-content__eYwbZ",tableContent:"StaticCards_tableContent__Qs+yS",programTable:"StaticCards_programTable__gNC3t",tableHeader:"StaticCards_tableHeader__Y2CQh",tableHeaderCell:"StaticCards_tableHeaderCell__HaNL3",tableRow:"StaticCards_tableRow__Pojku",tableCell:"StaticCards_tableCell__vwkWj",programType:"StaticCards_programType__HLBuf",withRegistration:"StaticCards_withRegistration__j6gtM",withoutRegistration:"StaticCards_withoutRegistration__L9X8Z",viewMoreButton:"StaticCards_viewMoreButton__ekgIb",loader:"StaticCards_loader__dn92i",chartModal:"StaticCards_chartModal__oJV12",chartModalContent:"StaticCards_chartModalContent__9ZhVZ",chartModalHeader:"StaticCards_chartModalHeader__DSpte",chartModalTitle:"StaticCards_chartModalTitle__iPy1W",chartModalBody:"StaticCards_chartModalBody__D6kAF"};const j={currentUser:{resource:"me",params:{fields:"id,name,username,organisationUnits[id]"}},thematicAreas:{resource:"organisationUnits",params:{paging:!1,fields:"id,name,level,parent[name,id],children[id,name,level]",filter:"level:eq:2"}},programs:{resource:"organisationUnits",params:{paging:!1,fields:"id,name,level,parent[name,id],children[id,name,level]",filter:"level:eq:3"}},projects:{resource:"organisationUnits",params:{paging:!1,fields:"id,name,level,parent[name,id]",filter:"level:eq:4"}},dhis2Programs:{resource:"programs",params:{paging:!1,fields:"id,name,organisationUnits[id,name,level,parent[id,name,level,parent[id,name,level]]]"}}};function O(){var e,t,a,n,i;const[o,c]=(0,r.useState)(!1),[s,m]=(0,r.useState)(!1),[u,p]=(0,r.useState)(null),[v,g]=(0,r.useState)(!1),[O,U]=(0,r.useState)(null),[F,W]=(0,r.useState)(!1),[B,V]=(0,r.useState)(null),[G,K]=(0,r.useState)(null),[q,Q]=(0,r.useState)({current:0,total:0,programName:""}),[Z,Y]=(0,r.useState)({}),{loading:J,data:X}=(0,l.iO)(j),ee=(0,r.useMemo)(()=>{var e,t;return(null!==(e=null===X||void 0===X||null===(t=X.organisationUnits)||void 0===t?void 0:t.organisationUnits)&&void 0!==e?e:[]).find(e=>1===e.level)},[X]),te=(0,r.useCallback)(e=>{let t=0,a=0,r=!1;var l;(console.log(`Processing ${e.length} events for analytics`),e.length>0)&&(console.log("Sample event structure:",e[0]),console.log("Sample event dataValues:",null===(l=e[0])||void 0===l?void 0:l.dataValues));const n=new Set;e.slice(0,10).forEach(e=>{(e.dataValues||[]).forEach(e=>{n.add(e.dataElement)})}),console.log("Unique data elements found:",Array.from(n)),e.forEach((e,l)=>{const n=e.dataValues||[];l<3&&console.log(`Event ${l} data elements:`,n.map(e=>({element:e.dataElement,value:e.value})));const i=n.find(e=>"RkOWeqeNZ8X"===e.dataElement),o=n.find(e=>"VWNPMmgk5ub"===e.dataElement);if(i&&void 0!==i.value&&null!==i.value){const t=parseInt(i.value)||0;a+=t,r=!0,console.log(`Found female data: ${t} in event ${e.event}`)}if(o&&void 0!==o.value&&null!==o.value){const a=parseInt(o.value)||0;t+=a,r=!0,console.log(`Found male data: ${a} in event ${e.event}`)}(i||o)&&console.log(`Event ${e.event}:`,{female:(null===i||void 0===i?void 0:i.value)||0,male:(null===o||void 0===o?void 0:o.value)||0,femaleElement:null===i||void 0===i?void 0:i.dataElement,maleElement:null===o||void 0===o?void 0:o.dataElement})});const i=t+a;return console.log(`Analytics totals: Male=${t}, Female=${a}, Total=${i}, HasData=${r}`),r?{male:t,female:a,total:i,hasData:!0}:{male:null,female:null,total:null,hasData:!1}},[]),ae=(0,r.useCallback)(e=>{var t,a,r,l,n,i;const o=null!==(t=null===X||void 0===X||null===(a=X.dhis2Programs)||void 0===a?void 0:a.programs)&&void 0!==t?t:[],c=null!==(r=null===X||void 0===X||null===(l=X.thematicAreas)||void 0===l?void 0:l.organisationUnits)&&void 0!==r?r:[],s=null!==(n=null===X||void 0===X||null===(i=X.programs)||void 0===i?void 0:i.organisationUnits)&&void 0!==n?n:[],m={},d={};console.log("Creating DHIS2 Program to Thematic Area mapping..."),console.log(`Available DHIS2 Programs: ${o.length}`),o.forEach(e=>{var t;console.log(`Processing DHIS2 Program: ${e.name} (${e.id})`),console.log("Organization Units for this program:",(null===(t=e.organisationUnits)||void 0===t?void 0:t.length)||0);(e.organisationUnits||[]).forEach(t=>{let a=null,r=null;if(2===t.level)a=t.id;else if(3===t.level){var l;a=null===(l=t.parent)||void 0===l?void 0:l.id,r=t.id}else if(4===t.level){var n,i,o;a=null===(n=t.parent)||void 0===n||null===(i=n.parent)||void 0===i?void 0:i.id,r=null===(o=t.parent)||void 0===o?void 0:o.id}a&&(m[e.id]||(m[e.id]=new Set),m[e.id].add(a),r&&(d[e.id]||(d[e.id]=new Set),d[e.id].add(r)),console.log(`Mapped DHIS2 Program ${e.id} to Thematic Area ${a} via orgUnit ${t.id} (level ${t.level})`))})}),Object.keys(m).forEach(e=>{m[e]=Array.from(m[e])}),Object.keys(d).forEach(e=>{d[e]=Array.from(d[e])}),console.log("Program to Thematic Area mapping:",m),console.log("Program to Level 3 mapping:",d);const u={},p={},v={};c.forEach(e=>{u[e.id]={male:0,female:0,total:0,hasData:!1}}),s.forEach(e=>{p[e.id]={male:0,female:0,total:0,hasData:!1}});return[...new Set(e.map(e=>e.program))].forEach(t=>{const a=e.filter(e=>e.program===t),r=te(a);v[t]=r,console.log(`DHIS2 Program ${t}: ${a.length} events, Analytics:`,r);(m[t]||[]).forEach(e=>{r.hasData&&(u[e].male+=r.male||0,u[e].female+=r.female||0,u[e].total+=r.total||0,u[e].hasData=!0)});(d[t]||[]).forEach(e=>{r.hasData&&(p[e].male+=r.male||0,p[e].female+=r.female||0,p[e].total+=r.total||0,p[e].hasData=!0)})}),{thematicAreas:u,programs:p,dhis2Programs:v,mapping:{programToThematicArea:m,programToLevel3:d}}},[X,te]),re=(0,r.useMemo)(()=>({events:{resource:"tracker/events",params:{fields:"dataValues[dataElement,value],orgUnit,program,programStage",paging:!1,totalPages:!1}}}),[]),{loading:le,data:ne}=(0,l.iO)(re,{skip:!re});(0,r.useEffect)(()=>{var e;if(null!==ne&&void 0!==ne&&null!==(e=ne.events)&&void 0!==e&&e.events&&X){console.log("Processing events data for analytics");try{const e=ne.events.events||[];console.log(`Processing ${e.length} total events`);const t=te(e),a=ae(e);Y({overall:t,thematicAreas:a.thematicAreas,programs:a.programs,dhis2Programs:a.dhis2Programs,mapping:a.mapping}),console.log("Analytics data processed:",{overall:t,thematicAreasCount:Object.keys(a.thematicAreas).length,programsCount:Object.keys(a.programs).length,dhis2ProgramsCount:Object.keys(a.dhis2Programs).length,mapping:a.mapping,thematicAreasDetails:a.thematicAreas,programsDetails:a.programs})}catch(t){console.error("Error processing events data:",t)}}},[ne,te,ae,X]);const ie=(0,r.useCallback)(async(e,t)=>{const a=(new Date).getFullYear(),r=`${a}-01-01`,l=`${a}-12-31`;let n=0,i=1;try{for(;;){var o;const a=await fetch(`${window.location.origin}/api/events.json?orgUnit=${t}&ouMode=DESCENDANTS&program=${e}&startDate=${r}&endDate=${l}&pageSize=1000&page=${i}&fields=event`,{credentials:"include",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const c=(null===(o=(await a.json()).events)||void 0===o?void 0:o.length)||0;if(n+=c,c<1e3)break;if(i++,i>100)break}return n}catch(c){return 0}},[]),oe=(0,r.useCallback)(async()=>{var e;if(null!==X&&void 0!==X&&null!==(e=X.programs)&&void 0!==e&&e.programs&&null!==ee&&void 0!==ee&&ee.id){W(!0),V(null),Q({current:0,total:0,programName:""});try{const e=X.programs.programs,a=e.length,r=(new Date).getFullYear();Q({current:0,total:a,programName:"Starting..."});const l=[];let n=0;for(let t=0;t<e.length;t++){const r=e[t];Q({current:t+1,total:a,programName:r.name});const i=await ie(r.id,ee.id);n+=i,l.push({id:r.id,name:r.name,programType:r.programType,eventCount:i}),await new Promise(e=>setTimeout(e,100))}const i={metadata:{generatedAt:(new Date).toISOString(),year:r,baseUrl:window.location.origin,deploymentType:"integrated",orgUnit:{id:ee.id,name:ee.name},dateRange:{startDate:`${r}-01-01`,endDate:`${r}-12-31`}},programs:l,summary:{totalPrograms:e.length,totalEvents:n,averageEventsPerProgram:n/e.length}};U(i),K(new Date);try{localStorage.setItem("dhis2-program-data",JSON.stringify(i)),localStorage.setItem("dhis2-program-data-timestamp",(new Date).toISOString())}catch(t){}}catch(t){V(t.message)}finally{W(!1),Q({current:0,total:0,programName:""})}}},[X,ee,ie]);(0,r.useEffect)(()=>{var e;!(()=>{try{const e=localStorage.getItem("dhis2-program-data"),t=localStorage.getItem("dhis2-program-data-timestamp");if(e&&t){const a=JSON.parse(e),r=new Date(t),l=new Date;if((l-r)/36e5<1)return U(a),K(r),!0}}catch(e){}return!1})()&&null!==X&&void 0!==X&&null!==(e=X.programs)&&void 0!==e&&e.programs&&null!==ee&&void 0!==ee&&ee.id&&oe()},[X,ee,oe]),(0,r.useEffect)(()=>{var e,t,a;console.log("Debug - Analytics data status:",{hasPrograms:!(null===X||void 0===X||null===(e=X.programs)||void 0===e||!e.programs),programCount:(null===X||void 0===X||null===(t=X.programs)||void 0===t||null===(a=t.programs)||void 0===a?void 0:a.length)||0,hasLevel1OrgUnit:!(null===ee||void 0===ee||!ee.id),level1OrgUnitId:null===ee||void 0===ee?void 0:ee.id,eventsLoading:le,analyticsDataKeys:Object.keys(Z).length})},[X,ee,le,Z]),(0,r.useEffect)(()=>{const e=setInterval(()=>{var e;null!==X&&void 0!==X&&null!==(e=X.programs)&&void 0!==e&&e.programs&&null!==ee&&void 0!==ee&&ee.id&&oe()},36e5);return()=>clearInterval(e)},[X,ee,oe]);const ce=(0,r.useMemo)(()=>{if(null===ee||void 0===ee||!ee.id)return null;const e=(new Date).getFullYear(),t=`${e}-01-01`,a=`${e}-12-31`;return{recentEvents:{resource:"events",params:{pageSize:10,page:1,fields:"event,program,eventDate,status,orgUnit,programStage",orgUnit:ee.id,ouMode:"DESCENDANTS",order:"eventDate:desc",startDate:t,endDate:a}}}},[ee]),{loading:se,data:me}=(0,l.iO)(ce,{skip:!ce}),de=(0,r.useMemo)(()=>{var e,t,a,r;const l=null!==(e=null===X||void 0===X||null===(t=X.thematicAreas)||void 0===t?void 0:t.organisationUnits)&&void 0!==e?e:[],n=null!==(a=null===X||void 0===X||null===(r=X.programs)||void 0===r?void 0:r.organisationUnits)&&void 0!==a?a:[];console.log("Debug - Level 2 (Thematic Areas):",l.length,l),console.log("Debug - Level 3 (Programs):",n.length,n),console.log("Debug - Analytics Data:",Z);const i=["#10b981","#3b82f6","#8b5cf6","#f59e0b","#ef4444","#06b6d4","#84cc16","#f97316"];return l.map((e,t)=>{const a=n.filter(t=>{var a;return(null===(a=t.parent)||void 0===a?void 0:a.id)===e.id}).map(e=>{var t;const a=(null===(t=Z.programs)||void 0===t?void 0:t[e.id])||{male:0,female:0,total:0};return console.log(`Debug - Program "${e.name}" (${e.id}) analytics:`,a),{id:e.id,name:e.name,totalReach:a}});return console.log(`Debug - Thematic Area "${e.name}" programs:`,a.length),{id:e.id,name:e.name,color:i[t%i.length],programs:a}})},[X,Z]),ue=(0,r.useMemo)(()=>{const e=[];return de.forEach(t=>{var a;null===(a=t.programs)||void 0===a||a.forEach(a=>{var r;const l=(null===(r=Z.programs)||void 0===r?void 0:r[a.id])||{male:null,female:null,total:null,hasData:!1},n=l.hasData?l.male+l.female:0;e.push({id:a.id,name:a.name,totalReach:n,maleReach:l.male,femaleReach:l.female,thematicArea:t.name,color:t.color,hasData:l.hasData})})}),e},[de,Z]),pe=(0,r.useMemo)(()=>de.map(e=>{var t,a;const r=(null!==(t=null===X||void 0===X||null===(a=X.programs)||void 0===a?void 0:a.organisationUnits)&&void 0!==t?t:[]).filter(t=>{var a;return(null===(a=t.parent)||void 0===a?void 0:a.id)===e.id});let l=null,n={male:0,female:0,total:0},i=0;var o;(r.forEach(e=>{var t;const a=(null===(t=Z.programs)||void 0===t?void 0:t[e.id])||{male:null,female:null,total:null,hasData:!1},r=a.hasData?a.male+a.female:0;r>i&&(l=e,n=a,i=r)}),!l&&r.length>0)&&(l=r[0],n=(null===(o=Z.programs)||void 0===o?void 0:o[l.id])||{male:null,female:null,total:null,hasData:!1},i=n.hasData?n.male+n.female:0);return{...e,totalReach:i,bestProgram:l?{id:l.id,name:l.name,totalReach:n}:null,bestProgramReach:i,maleReach:n.male,femaleReach:n.female,hasData:n.hasData}}).filter(e=>e.hasData),[de,Z,X]),ve=(0,r.useMemo)(()=>v?pe:pe.slice(0,3),[pe,v]),ge=(0,r.useMemo)(()=>null!==O&&void 0!==O&&O.summary?{totalEnrollments:O.summary.totalEvents}:{totalEnrollments:0},[O]),he=(new Date).getFullYear(),Ee=J||le,_e=()=>{var e;null!==X&&void 0!==X&&null!==(e=X.programs)&&void 0!==e&&e.programs&&null!==ee&&void 0!==ee&&ee.id&&oe()},Ce=window.location.origin,Se=[{title:"Import Data",description:"Transfer data into the system.",link:`${Ce}/sims-web-import-export/#/import`,isExpandable:!0,type:"import",icon:r.createElement(h.A,null),color:"#4f46e5"},{title:"Export Data",description:"Transfer data out of the system.",link:`${Ce}/sims-web-import-export/#/export`,isExpandable:!0,type:"export",icon:r.createElement(E.A,null),color:"#059669"},{title:"Forms Programs",description:"Access structured forms for data collection.",link:`${Ce}/sims-web-capture/`,icon:r.createElement(_.A,null),color:"#4f46e5"},{title:"Spreadsheets Programs",description:"Input and manage data using Excel-like grids.",link:`${Ce}/sims-web-aggregate-data-entry/`,icon:r.createElement(C.A,null),color:"#ea580c"},{title:"Thematic Areas",description:"View thematic areas",link:`${Ce}/sims-web-maintenance/#/list/organisationUnitSection/organisationUnit`,icon:r.createElement(S.A,null),color:"#ea580c"},{title:"Visualize",description:"Interact with visualizations and reports",link:"https://metabase-prod-890193357774.us-central1.run.app/",icon:r.createElement(y.A,null),color:"#ea580c",isExternal:!0}],ye=[{title:"Import Spreadsheets Data",link:`${Ce}/sims-web-import-export/#/import/data`},{title:"Import Forms Data",link:`${Ce}/sims-web-import-export/#/import/event`},{title:"Import Metadata",link:`${Ce}/sims-web-import-export/#/import/metadata`}],fe=[{title:"Export Spreadsheets",link:`${Ce}/sims-web-import-export/#/export/data`},{title:"Export Forms Data",link:`${Ce}/sims-web-import-export/#/export/event`},{title:"Export Metadata",link:`${Ce}/sims-web-import-export/#/export/metadata`}],be=e=>{e.isExpandable?"import"===e.type?(c(e=>!e),s&&m(!1)):"export"===e.type&&(m(e=>!e),o&&c(!1)):e.isExternal?window.open(e.link,"_blank","noopener,noreferrer"):window.location.href=e.link};return r.createElement("div",{className:z.container},Ee&&r.createElement("div",{className:z.loader},r.createElement(f.F,{small:!0})),r.createElement("div",{className:z.header},r.createElement("div",{className:z.headerContent},r.createElement("div",{className:z.headerText},r.createElement("p",{className:z.pageSubtitle},r.createElement("h1",null,"Welcome back, ",(null===X||void 0===X||null===(e=X.currentUser)||void 0===e||null===(t=e.name)||void 0===t?void 0:t.split(" ")[0])||"User"),ee&&r.createElement("span",{style:{fontSize:"12px",color:"#666",display:"block"}},"Project: ",ee.name," (ID: ",ee.id,")"),G&&r.createElement("span",{style:{fontSize:"10px",color:"#999",display:"block"}},"Data updated: ",G.toLocaleString()," (Auto-refresh: hourly)"))),r.createElement("div",{className:z.userInfo},r.createElement(d.$,{small:!0,secondary:!0,onClick:_e,disabled:F,style:{marginRight:"8px"}},r.createElement(b.A,null),F?"Collecting...":"Refresh Data")))),F&&r.createElement(N.Z,{style:{margin:"1rem 0",padding:"1rem"}},r.createElement("div",{style:{display:"flex",alignItems:"center",gap:"1rem"}},r.createElement(f.F,{small:!0}),r.createElement("div",null,r.createElement("div",{style:{fontWeight:"bold"}},"Collecting Program Data... (",q.current,"/",q.total,")"),r.createElement("div",{style:{fontSize:"12px",color:"#666"}},q.programName),q.total>0&&r.createElement("div",{style:{width:q.current/q.total*100+"%",height:"100%",backgroundColor:"#4f46e5",borderRadius:"2px",transition:"width 0.3s ease"}})))),B&&r.createElement(N.Z,{style:{margin:"1rem 0",padding:"1rem",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7"}},r.createElement("div",{style:{color:"#856404"}},r.createElement("strong",null,"Data Collection Error:")," ",B,r.createElement(d.$,{small:!0,secondary:!0,onClick:_e,style:{marginLeft:"1rem"}},"Retry"))),r.createElement("div",{className:z.mainGrid},r.createElement("div",{className:z.leftColumn},r.createElement("div",{className:z.quickActionsContainer},r.createElement("div",{className:z.sectionHeader},r.createElement("h3",{className:z.sectionTitle},"Quick Actions")),r.createElement("div",{className:z.cardGrid},Se.map(e=>r.createElement("div",{key:e.title,className:z.cardWrapper},r.createElement(N.Z,{className:z.navCard},r.createElement("div",{className:z.cardContent,role:"button",tabIndex:0,onClick:()=>be(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||be(e)},style:{cursor:"pointer"}},r.createElement("div",{className:z.cardIconWrapper,style:{backgroundColor:`${e.color}15`,color:e.color}},e.icon),r.createElement("div",{className:z.cardTextContent},r.createElement("h3",{className:z.cardTitle},e.title),r.createElement("p",{className:z.cardDescription},e.description)),e.isExpandable&&r.createElement("div",{className:z.expandIcon},"import"===e.type&&o||"export"===e.type&&s?r.createElement(A.A,null):r.createElement(w.A,null))),"import"===e.type&&o&&r.createElement("div",{className:z.expandableContent},r.createElement(D.c,null),r.createElement("div",{className:z.linkGrid},ye.map(e=>r.createElement("a",{key:e.title,href:e.link,className:z.linkItem},e.title)))),"export"===e.type&&s&&r.createElement("div",{className:z.expandableContent},r.createElement(D.c,null),r.createElement("div",{className:z.linkGrid},fe.map(e=>r.createElement("a",{key:e.title,href:e.link,className:z.linkItem},e.title))))))))),r.createElement("div",{className:z.performanceOverview},r.createElement("div",{className:z.sectionHeader},r.createElement("h3",{className:z.sectionTitle},"Performance Overview"),r.createElement(d.$,{small:!0,secondary:!0,onClick:()=>g(!v),disabled:pe.length<=3},v?"Show Less":`View More (${Math.max(0,pe.length-3)})`)),r.createElement("div",{className:z.thematicAreasGrid},ve.map(e=>r.createElement("div",{key:e.id,className:z.thematicAreaCard},r.createElement("div",{className:z.thematicAreaHeader},r.createElement("div",{className:z.thematicAreaIcon,style:{backgroundColor:`${e.color}15`,color:e.color}},r.createElement(S.A,null)),r.createElement("div",{className:z.thematicAreaInfo},r.createElement("h4",{className:z.thematicAreaName},e.name),r.createElement("p",{className:z.thematicAreaStats},e.hasData?`${e.totalReach.toLocaleString()} total reach`:"No data available"))),r.createElement("div",{className:z.thematicAreaContent},r.createElement("div",{className:z.bestPerformingProject},r.createElement("h5",{className:z.bestProjectLabel},"Top Performing Program"),e.bestProgram?r.createElement(r.Fragment,null,r.createElement("div",{className:z.bestProjectInfo},r.createElement("span",{className:z.bestProjectName},e.bestProgram.name),r.createElement("span",{className:z.bestProjectReach},e.hasData?`${e.bestProgramReach.toLocaleString()} reached`:"No data")),r.createElement("div",{className:z.reachBreakdown},r.createElement("div",{className:z.reachItem},r.createElement("span",{className:z.reachLabel},"Male:"),r.createElement("span",{className:z.reachValue},e.hasData?e.maleReach.toLocaleString():"No data")),r.createElement("div",{className:z.reachItem},r.createElement("span",{className:z.reachLabel},"Female:"),r.createElement("span",{className:z.reachValue},e.hasData?e.femaleReach.toLocaleString():"No data")))):r.createElement("div",{className:z.bestProjectInfo},r.createElement("span",{className:z.bestProjectName},"No programs available")))))))),r.createElement("div",{className:z.activityContainer},r.createElement("div",{className:z.activityHeader},r.createElement("div",{className:z.activityTitleWrapper},r.createElement("div",{className:z.activityIconWrapper},r.createElement(k.A,null)),r.createElement("h3",{className:z.activityTitle},"Recent Activity")),r.createElement(d.$,{small:!0,secondary:!0},"View All")),r.createElement(D.c,null),r.createElement("div",{className:z.activityContent},se?r.createElement("div",{className:z.activityLoader},r.createElement(f.F,{small:!0})):r.createElement("div",{className:z.activityList},null===me||void 0===me||null===(a=me.recentEvents)||void 0===a||null===(n=a.events)||void 0===n?void 0:n.slice(0,5).map(e=>{var t,a;const l=null===X||void 0===X||null===(t=X.programs)||void 0===t||null===(a=t.programs)||void 0===a?void 0:a.find(t=>t.id===e.program),n=(null===l||void 0===l?void 0:l.name)||"Unknown Program";return r.createElement("div",{key:e.event,className:z.activityItem},r.createElement("div",{className:z.activityItemIcon},r.createElement(_.A,null)),r.createElement("div",{className:z.activityItemContent},r.createElement("div",{className:z.activityItemHeader},r.createElement("span",{className:z.activityType},"COMPLETED"===e.status?"Event Completed":"Event Created"),r.createElement("span",{className:z.activityTime},(e=>{const t=new Date,a=new Date(e),r=Math.floor((t-a)/6e4);return r<1?"Just now":r<60?`${r}m ago`:r<1440?`${Math.floor(r/60)}h ago`:`${Math.floor(r/1440)}d ago`})(new Date(e.eventDate)))),r.createElement("p",{className:z.activityDescription},n," - Event ",e.event.substring(0,8),"...")),r.createElement("div",{className:`${z.activityStatus} ${"COMPLETED"===e.status?z.success:z.active}`}))}),r.createElement("div",{className:z.activityItem},r.createElement("div",{className:z.activityItemIcon},r.createElement(T.A,null)),r.createElement("div",{className:z.activityItemContent},r.createElement("div",{className:z.activityItemHeader},r.createElement("span",{className:z.activityType},"System Status"),r.createElement("span",{className:z.activityTime},"Just now")),r.createElement("p",{className:z.activityDescription},ge.totalEnrollments," total events across ",(null===O||void 0===O||null===(i=O.summary)||void 0===i?void 0:i.totalPrograms)||0," programs")),r.createElement("div",{className:`${z.activityStatus} ${z.success}`}))))),r.createElement("div",{className:z.distributionContainer},r.createElement("div",{className:z.sectionHeader},r.createElement("h3",{className:z.sectionTitle},"Program Distribution")),r.createElement("div",{className:z.chartsContainer},r.createElement(N.Z,{className:z.chartCard},r.createElement("div",{className:z.chartHeader},r.createElement("h4",{className:z.chartTitle},"Program Reach by Gender Distribution ",he),r.createElement(d.$,{small:!0,secondary:!0,onClick:()=>p("programs")},"Expand")),r.createElement(D.c,null),r.createElement("div",{className:z.chartContent},r.createElement(x.u,{width:"100%",height:400},r.createElement(I.E,{data:ue,margin:{top:48,right:24,left:16,bottom:60}},r.createElement(P.d,{strokeDasharray:"3 3"}),r.createElement($.W,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),r.createElement(R.h,{label:{value:"Number of People",angle:-90,position:"insideLeft"},fontSize:12}),r.createElement(L.m,{formatter:(e,t,a)=>{const l=a.payload;return[r.createElement("div",{key:"tooltip"},r.createElement("div",{style:{fontWeight:"bold",marginBottom:"8px"}},`Program: ${l.name}`),r.createElement("div",{style:{marginBottom:"4px"}},`Total Reach: ${l.hasData?e.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Male: ${l.hasData?l.maleReach.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Female: ${l.hasData?l.femaleReach.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Thematic Area: ${l.thematicArea}`))]},labelFormatter:()=>"",contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)"}}),r.createElement(M.s,{layout:"horizontal",verticalAlign:"top",align:"center",wrapperStyle:{paddingBottom:8,fontSize:14}}),r.createElement(H.y,{dataKey:"maleReach",name:"Male",fill:"#3b82f6",isAnimationActive:!1,barSize:30}),r.createElement(H.y,{dataKey:"femaleReach",name:"Female",fill:"#ec4899",isAnimationActive:!1,barSize:30}))))))))),u?r.createElement("div",{className:z.chartModal,onClick:()=>p(null)},r.createElement("div",{className:z.chartModalContent,onClick:e=>e.stopPropagation()},r.createElement("div",{className:z.chartModalHeader},r.createElement("h3",{className:z.chartModalTitle},"Program Distribution by Gender (Male vs Female)"),r.createElement(d.$,{small:!0,secondary:!0,onClick:()=>p(null)},"Close")),r.createElement("div",{className:z.chartModalBody},r.createElement(x.u,{width:"100%",height:600},r.createElement(I.E,{data:ue,margin:{top:48,right:24,left:16,bottom:80}},r.createElement(P.d,{strokeDasharray:"3 3"}),r.createElement($.W,{dataKey:"name",angle:-45,textAnchor:"end",height:100,fontSize:12}),r.createElement(R.h,{label:{value:"Number of People",angle:-90,position:"insideLeft"},fontSize:12}),r.createElement(L.m,{formatter:(e,t,a)=>{const l=a.payload;return[r.createElement("div",{key:"tooltip"},r.createElement("div",{style:{fontWeight:"bold",marginBottom:"8px"}},`Program: ${l.name}`),r.createElement("div",{style:{marginBottom:"4px"}},`Total Reach: ${l.hasData?e.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Male: ${l.hasData?l.maleReach.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Female: ${l.hasData?l.femaleReach.toLocaleString():"No data"}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginBottom:"4px"}},`Thematic Area: ${l.thematicArea}`))]},labelFormatter:()=>"",contentStyle:{backgroundColor:"white",border:"1px solid #e2e8f0",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.1)"}}),r.createElement(M.s,{layout:"horizontal",verticalAlign:"top",align:"center",wrapperStyle:{paddingBottom:8,fontSize:16}}),r.createElement(H.y,{dataKey:"maleReach",name:"Male",fill:"#3b82f6",isAnimationActive:!1,barSize:40}),r.createElement(H.y,{dataKey:"femaleReach",name:"Female",fill:"#ec4899",isAnimationActive:!1,barSize:40})))))):null)}var U=a(26802),F=a(75038),W=a(59541),B=a(50433),V=a(65298);function G(){return r.createElement("div",{className:"column h-100"},r.createElement("div",{className:"row p-16"}),r.createElement("div",{style:{padding:"0 16px"}},r.createElement(O,null)))}var K=a(96421),q=a(83590),Q=a(95752);function Z({keyword:e}){return r.createElement("div",{className:"h-100 w-100"},r.createElement(K.o,null,r.createElement("div",{className:"column center align-items-center"},r.createElement(Q.A,{style:{color:q.T.grey700,fontSize:64}}),r.createElement("h2",{"data-test":"no-scorecards-found-title",style:{color:q.T.grey700,margin:8}},i.A.t("No scorecards found")),r.createElement("p",{style:{color:q.T.grey700,margin:4}},i.A.t("Could not find scorecards matching the keyword "),r.createElement("b",null,`'${e}'`)))))}var Y=a(10103);function J({scorecard:e,grid:t}){const a=(0,V.useSetRecoilState)(U.RouterState),{write:n,delete:o}=(0,V.useRecoilValue)((0,U.UserAuthorityOnScorecard)(null===e||void 0===e?void 0:e.id)),{title:s,description:m,id:u}=e,[p,v]=(0,r.useState)(!1),g=(0,B.W6)(),{remove:h}=(0,U.useDeleteScorecard)(u),{show:E}=(0,l.MW)(({message:e})=>e,({type:e})=>({...e,duration:3e3})),{confirm:_}=(0,Y.G_)(),C=()=>{a(e=>({...e,previous:"/"})),g.push(`/view/${u}`)},S=()=>{n&&(a(e=>({...e,previous:"/"})),g.push(`/edit/${u}`))},y=(e,t)=>{t.stopPropagation(),_({title:i.A.t("Confirm scorecard delete"),message:r.createElement("p",null,i.A.t("Are you sure you want to delete scorecard "),":",r.createElement("b",null,s)),onCancel:()=>{},onConfirm:()=>{(async()=>{if(o){try{await h()}catch(e){E({message:e.message,type:{info:!0}})}E({message:i.A.t("Scorecard deleted successfully"),type:{success:!0}})}})()}})};return t?r.createElement("div",{className:"container-bordered p-16 ","data-test":"scorecard-thumbnail-view",style:{margin:16,background:"white"},onClick:C},r.createElement("div",{className:"column space-between h-100"},r.createElement("div",{className:"text-center p-8"},r.createElement("img",{alt:"img",src:U.ScorecardCardImage,style:{height:100,width:200}})),r.createElement("div",{className:"flex-1 column align-items-center"},r.createElement("h4",{className:"scorecard-list-card-title"},s),r.createElement("p",{className:"scorecard-list-card-description",style:{color:q.T.grey700}},(null===m||void 0===m?void 0:m.length)>100?r.createElement("div",{onClick:e=>{e.stopPropagation(),v(e=>!e)},className:"row space-between align-content-end"},p?m:(0,U.truncateDescription)(m)):m)),r.createElement("div",{style:{margin:"0 8px"}},r.createElement(c.v,{middle:!0},r.createElement(d.$,{onClick:C},i.A.t("View")),n&&r.createElement(d.$,{dataTest:"edit-scorecard-button",onClick:function(e,t){t.stopPropagation(),S()}},i.A.t("Edit")),o&&r.createElement(d.$,{dataTest:"scorecard-delete-button",onClick:y},i.A.t("Delete")))))):r.createElement("div",{"data-test":"scorecard-thumbnail-view",className:"container-bordered p-32",style:{margin:16,background:"white"},onClick:C},r.createElement("div",{className:"row space-between align-items-center"},r.createElement("div",{className:"row align-items-center"},r.createElement("div",null,r.createElement("img",{alt:"img",src:U.ScorecardCardImage,style:{height:100,width:200}})),r.createElement("div",{className:"column start"},r.createElement("h4",{className:"scorecard-list-card-title"},s),r.createElement("p",{className:"scorecard-list-card-description",style:{color:q.T.grey700}},(null===m||void 0===m?void 0:m.length)>100?r.createElement("div",{onClick:e=>{e.stopPropagation(),v(e=>!e)},className:"row space-between align-content-end"},p?m:(0,U.truncateDescription)(m)):m))),r.createElement("div",{className:"row end"},r.createElement(c.v,{middle:!0},r.createElement(d.$,{onClick:C},i.A.t("View")),n&&r.createElement(d.$,{dataTest:"edit-scorecard-button",onClick:function(e,t){t.stopPropagation(),S()}},i.A.t("Edit")),o&&r.createElement(d.$,{dataTest:"scorecard-delete-button",onClick:y},i.A.t("Delete"))))))}function X({scorecards:e}){return r.createElement("div",{className:"scorecard-list-container grid p-32"},null===e||void 0===e?void 0:e.map(e=>r.createElement(J,{grid:!0,key:e.id,scorecard:e})))}var ee=a(33791),te=a(28384);function ae(){const e=(0,V.useSetRecoilState)(U.HelpState);return r.createElement(ee.n,null,r.createElement(te.D,{onClick:()=>{e(!0)},label:i.A.t("Start a guided tour")}),r.createElement(te.D,{onClick:()=>{const e=window.open();e.opener=null,e.target="_blank",e.location=U.SCORECARD_DOCUMENTATION_URL},label:i.A.t("Documentation")}))}function re({scorecards:e}){return r.createElement("div",{className:"column"},null===e||void 0===e?void 0:e.map(e=>r.createElement(J,{scorecard:e,key:null===e||void 0===e?void 0:e.id,grid:!1})))}var le=a(94450);function ne({pageSize:e=8,scorecards:t=[],listComponent:a}){const[l,n]=(0,r.useState)(0),i=(0,r.useMemo)(()=>(0,W.chunk)(t,e),[t,e]),o=a;return r.createElement("div",{className:"p-16 scorecard-list"},r.createElement(o,{scorecards:i[l]}),i.length>1&&r.createElement("div",{className:"p-16"},r.createElement(le.d,{hidePageSizeSelect:!0,total:t.length,pageCount:i.length,pageSize:e,page:l+1,onPageChange:e=>{n(e-1)},onPageSizeChange:()=>{}})))}function ie(){const e=(0,V.useResetRecoilState)(U.ScorecardIdState),t=(0,V.useSetRecoilState)(U.RouterState),[a,h]=(0,V.useRecoilState)(U.HelpState),E=(0,B.W6)(),[_,{set:C}]=(0,n.iK)("scorecardViewType"),S=(0,V.useRecoilValue)(U.ScorecardSummaryState),[y,f]=(0,r.useState)(),[b,N]=(0,r.useState)(S),{show:A}=(0,l.MW)(({message:e})=>e,({type:e})=>({...e,duration:3e3})),w=(0,r.useRef)((0,W.debounce)(e=>{N(()=>S.filter(({id:t,title:a,description:r,additionalLabels:l})=>{const n=`${t} ${a} ${r}`.toLowerCase();return Array.isArray(l)&&l.length>0&&n.concat(l.join(" ").toLowerCase()),"string"===typeof l&&n.concat(l.toLowerCase()),n.includes(e.toLowerCase())}))}));(0,r.useEffect)(()=>{y?w.current(y):N(S)},[y,S]);return r.createElement(r.Suspense,{fallback:r.createElement(U.FullPageLoader,null)},r.createElement(F.gj,{options:U.STEP_OPTIONS,enabled:a,steps:U.SCORECARD_LIST_HELP_STEPS,onExit:()=>{h(!1)},initialStep:0}),(0,W.isEmpty)(S)?r.createElement(G,null):r.createElement("div",{className:"column h-100"},r.createElement("div",{className:"row p-16"},r.createElement("div",{className:"row p-45 center",style:{paddingLeft:"35%"}},r.createElement("div",{className:"column w-30"},r.createElement(o.p,{className:"search-input",value:y,onChange:({value:e})=>{f(e)},placeholder:i.A.t("Search")}))),r.createElement("div",{className:"w-100"},r.createElement(c.v,{end:!0},r.createElement(s.g,{type:"button",component:r.createElement(ae,null),icon:r.createElement(p.A,null)},i.A.t("Help")),r.createElement(m.m,{content:i.A.t("Switch to {{viewType}} view",{viewType:"grid"===_?i.A.t("list"):i.A.t("grid")})},r.createElement(d.$,{onClick:()=>{try{if("grid"===_)return void C("list");C("grid")}catch(t){var e;A({message:null!==(e=t.message)&&void 0!==e?e:t.toString(),type:{critical:!0}})}},className:"change-view-button",dataTest:"scorecard-view-orientation",icon:"grid"===_?r.createElement(v.A,null):r.createElement(g.A,null)})),r.createElement(d.$,{dataTest:"new-scorecard-button",className:"add-scorecard-button",onClick:()=>{e(),t(e=>({...e,previous:"/"})),E.push("/add")},primary:!0,icon:r.createElement(u.A,null)},i.A.t("Add New Scorecard"))))),r.createElement("div",{style:{padding:"0 16px"}},r.createElement(O,null)),(0,W.isEmpty)(b)?r.createElement("div",{className:"flex-1"},r.createElement(Z,{keyword:y})):r.createElement(ne,{scorecards:b,pageSize:"grid"===_?8:5,listComponent:"grid"===_?X:re})))}function oe(){return function(){const[e]=(0,n.iK)(U.DATA_MIGRATION_CHECK,{global:!0}),t=(0,B.W6)();(0,r.useEffect)(()=>{e||t.replace("/migrate")},[t,e])}(),r.createElement(ie,null)}}}]);
//# sourceMappingURL=3970.9750d58d.chunk.js.map