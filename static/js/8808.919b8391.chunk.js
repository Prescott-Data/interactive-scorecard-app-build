"use strict";(self.webpackChunk_dhis2_app_shell=self.webpackChunk_dhis2_app_shell||[]).push([[8808],{88808:function(e,t,a){a.r(t),a.d(t,{default:function(){return ce}});var r=a(81195),n=a(7105),i=a(40652),l=a(26874),c=a(56861),o=a(99136),s=a(19465),d=a(6997),m=a(86837),p=a(75877),u=a(93651),v=a(50544),g=a(52308),E=a(76318),_=a(23802),C=a(78920),y=a(95300),S=a(1678),h=a(28957),N=a(84415),f=a(68555),w=a(94225),b=a(94866),T=a(26777),k=a(83498),I=a(56193),x=a(96417),D=a(32106),$=a(23557),Z=a(31996),A=a(65169),R=a(6090),z=a(39572),M=a(18831),P=a(69961),O={container:"StaticCards_container__SBOWl",header:"StaticCards_header__oO4oN",headerContent:"StaticCards_headerContent__lQIp-",headerText:"StaticCards_headerText__R7ozs",pageTitle:"StaticCards_pageTitle__ye8tC",pageSubtitle:"StaticCards_pageSubtitle__JjDng",userInfo:"StaticCards_userInfo__Mmv2U",userAvatar:"StaticCards_userAvatar__WxC3p",mainGrid:"StaticCards_mainGrid__3ccCt",leftColumn:"StaticCards_leftColumn__EDej2",rightColumn:"StaticCards_rightColumn__baJDe",welcomeCard:"StaticCards_welcomeCard__-dJXF",quickActionsCard:"StaticCards_quickActionsCard__Qycer",performanceOverview:"StaticCards_performanceOverview__kqyFx",programDistribution:"StaticCards_programDistribution__g9M3F",sectionHeader:"StaticCards_sectionHeader__qKSgl",metricsGrid:"StaticCards_metricsGrid__aVy9o",metricCard:"StaticCards_metricCard__kgRCj",metricIcon:"StaticCards_metricIcon__5SYNd",metricContent:"StaticCards_metricContent__yBk7Z",metricValue:"StaticCards_metricValue__1HeFD",metricLabel:"StaticCards_metricLabel__ZfXEe",sectionTitle:"StaticCards_sectionTitle__shLQB",quickActionsContainer:"StaticCards_quickActionsContainer__Lm77K",cardGrid:"StaticCards_cardGrid__bDAxA",cardWrapper:"StaticCards_cardWrapper__1lgvc",navCard:"StaticCards_navCard__ipBCw",cardContent:"StaticCards_cardContent__3S9XH",cardIconWrapper:"StaticCards_cardIconWrapper__zu9XP",cardTextContent:"StaticCards_cardTextContent__XtVwL",cardTitle:"StaticCards_cardTitle__m7dOf",cardDescription:"StaticCards_cardDescription__btTRK",expandIcon:"StaticCards_expandIcon__Mg2+D",expandableContent:"StaticCards_expandableContent__LcIHH",linkGrid:"StaticCards_linkGrid__pFi0Y",linkItem:"StaticCards_linkItem__SJX6T",activityContainer:"StaticCards_activityContainer__8iYyk",distributionContainer:"StaticCards_distributionContainer__uiCxl",activityHeader:"StaticCards_activityHeader__AvWu+",activityTitleWrapper:"StaticCards_activityTitleWrapper__seICx",activityIconWrapper:"StaticCards_activityIconWrapper__e1E40",activityTitle:"StaticCards_activityTitle__zGFsl",activityContent:"StaticCards_activityContent__NhxaR",activityLoader:"StaticCards_activityLoader__pcN+C",activityList:"StaticCards_activityList__P2tFa",activityItem:"StaticCards_activityItem__eT6ZM",activityItemIcon:"StaticCards_activityItemIcon__DSnDh",activityItemContent:"StaticCards_activityItemContent__6phuh",activityItemHeader:"StaticCards_activityItemHeader__iyg0O",activityType:"StaticCards_activityType__T4BBQ",activityTime:"StaticCards_activityTime__ONTp0",activityDescription:"StaticCards_activityDescription__UfPzY",activityStatus:"StaticCards_activityStatus__zredR",success:"StaticCards_success__-MGvw",active:"StaticCards_active__b68Qa",error:"StaticCards_error__LQe39",emptyState:"StaticCards_emptyState__HIbWD",chartsContainer:"StaticCards_chartsContainer__L-4Kp",chartCard:"StaticCards_chartCard__nbO4r",tableCard:"StaticCards_tableCard__0Mdxx",chartHeader:"StaticCards_chartHeader__zM+sT",chartTitle:"StaticCards_chartTitle__djvKy",chartContent:"StaticCards_chartContent__aOBRf","recharts-tooltip-wrapper":"StaticCards_recharts-tooltip-wrapper__3UAhQ","recharts-default-tooltip":"StaticCards_recharts-default-tooltip__ndsnq","recharts-tooltip-content":"StaticCards_recharts-tooltip-content__eYwbZ",tableContent:"StaticCards_tableContent__Qs+yS",programTable:"StaticCards_programTable__gNC3t",tableHeader:"StaticCards_tableHeader__Y2CQh",tableHeaderCell:"StaticCards_tableHeaderCell__HaNL3",tableRow:"StaticCards_tableRow__Pojku",tableCell:"StaticCards_tableCell__vwkWj",programType:"StaticCards_programType__HLBuf",withRegistration:"StaticCards_withRegistration__j6gtM",withoutRegistration:"StaticCards_withoutRegistration__L9X8Z",viewMoreButton:"StaticCards_viewMoreButton__ekgIb",loader:"StaticCards_loader__dn92i",chartModal:"StaticCards_chartModal__oJV12",chartModalContent:"StaticCards_chartModalContent__9ZhVZ",chartModalHeader:"StaticCards_chartModalHeader__DSpte",chartModalTitle:"StaticCards_chartModalTitle__iPy1W",chartModalBody:"StaticCards_chartModalBody__D6kAF"};const H={programs:{resource:"programs",params:{paging:!1,fields:"id,name,programType,enrollments,programStages,organisationUnits[id,name,level]"}},currentUser:{resource:"me",params:{fields:"id,name,username,organisationUnits[id]"}},organisationUnits:{resource:"organisationUnits",params:{paging:!1,fields:"id,name,level,parent[name]"}}};function L(){var e,t,a,i,l;const[c,o]=(0,r.useState)(!1),[s,d]=(0,r.useState)(!1),[p,u]=(0,r.useState)(null),[v,g]=(0,r.useState)(new Set),[L,U]=(0,r.useState)(null),[W,G]=(0,r.useState)(!1),[V,F]=(0,r.useState)(null),[j,B]=(0,r.useState)(null),[K,J]=(0,r.useState)({current:0,total:0,programName:""}),{loading:Y,data:q}=(0,n.u_)(H),Q=(0,r.useMemo)((()=>{var e,t;return(null!==(e=null===q||void 0===q||null===(t=q.organisationUnits)||void 0===t?void 0:t.organisationUnits)&&void 0!==e?e:[]).find((e=>1===e.level))}),[q]),X=(0,r.useCallback)((async(e,t)=>{const a=(new Date).getFullYear(),r=`${a}-01-01`,n=`${a}-12-31`;let i=0,l=1;try{for(;;){var c;const a=await fetch(`${window.location.origin}/api/events.json?orgUnit=${t}&ouMode=DESCENDANTS&program=${e}&startDate=${r}&endDate=${n}&pageSize=1000&page=${l}&fields=event`,{credentials:"include",headers:{Accept:"application/json"}});if(!a.ok)throw new Error(`HTTP ${a.status}: ${a.statusText}`);const o=(null===(c=(await a.json()).events)||void 0===c?void 0:c.length)||0;if(i+=o,o<1e3)break;if(l++,l>100)break}return i}catch(o){return 0}}),[]),ee=(0,r.useCallback)((async()=>{var e;if(null!==q&&void 0!==q&&null!==(e=q.programs)&&void 0!==e&&e.programs&&null!==Q&&void 0!==Q&&Q.id){G(!0),F(null),J({current:0,total:0,programName:""});try{const e=q.programs.programs,a=e.length,r=(new Date).getFullYear();J({current:0,total:a,programName:"Starting..."});const n=[];let i=0;for(let t=0;t<e.length;t++){const r=e[t];J({current:t+1,total:a,programName:r.name});const l=await X(r.id,Q.id);i+=l,n.push({id:r.id,name:r.name,programType:r.programType,eventCount:l}),await new Promise((e=>setTimeout(e,100)))}const l={metadata:{generatedAt:(new Date).toISOString(),year:r,baseUrl:window.location.origin,deploymentType:"integrated",orgUnit:{id:Q.id,name:Q.name},dateRange:{startDate:`${r}-01-01`,endDate:`${r}-12-31`}},programs:n,summary:{totalPrograms:e.length,totalEvents:i,averageEventsPerProgram:i/e.length}};U(l),B(new Date);try{localStorage.setItem("dhis2-program-data",JSON.stringify(l)),localStorage.setItem("dhis2-program-data-timestamp",(new Date).toISOString())}catch(t){}}catch(t){F(t.message)}finally{G(!1),J({current:0,total:0,programName:""})}}}),[q,Q,X]);(0,r.useEffect)((()=>{var e;!(()=>{try{const e=localStorage.getItem("dhis2-program-data"),t=localStorage.getItem("dhis2-program-data-timestamp");if(e&&t){const a=JSON.parse(e),r=new Date(t),n=new Date;if((n-r)/36e5<1)return U(a),B(r),!0}}catch(e){}return!1})()&&null!==q&&void 0!==q&&null!==(e=q.programs)&&void 0!==e&&e.programs&&null!==Q&&void 0!==Q&&Q.id&&ee()}),[q,Q,ee]),(0,r.useEffect)((()=>{const e=setInterval((()=>{var e;null!==q&&void 0!==q&&null!==(e=q.programs)&&void 0!==e&&e.programs&&null!==Q&&void 0!==Q&&Q.id&&ee()}),36e5);return()=>clearInterval(e)}),[q,Q,ee]);const te=(0,r.useMemo)((()=>{if(null===Q||void 0===Q||!Q.id)return null;const e=(new Date).getFullYear(),t=`${e}-01-01`,a=`${e}-12-31`;return{recentEvents:{resource:"events",params:{pageSize:10,page:1,fields:"event,program,eventDate,status,orgUnit,programStage",orgUnit:Q.id,ouMode:"DESCENDANTS",order:"eventDate:desc",startDate:t,endDate:a}}}}),[Q]),{loading:ae,data:re}=(0,n.u_)(te,{skip:!te}),ne={WITH_REGISTRATION:"#ea580c",WITHOUT_REGISTRATION:"#4f46e5"},ie={WITH_REGISTRATION:"Spreadsheets",WITHOUT_REGISTRATION:"Forms"},le=(0,r.useMemo)((()=>{var e;return null!==L&&void 0!==L&&L.programs&&null!==q&&void 0!==q&&null!==(e=q.programs)&&void 0!==e&&e.programs?q.programs.programs.map((e=>{var t,a,r,n;const i=L.programs.find((t=>t.id===e.id)),l=(null===i||void 0===i?void 0:i.eventCount)||0;return{id:e.id,name:e.name,enrollments:l,programType:e.programType,organisationUnits:null!==(t=null===(a=e.organisationUnits)||void 0===a?void 0:a.map((e=>e.name)))&&void 0!==t?t:[],orgUnitCount:null!==(r=null===(n=e.organisationUnits)||void 0===n?void 0:n.length)&&void 0!==r?r:0}})):[]}),[L,q]),ce=(0,r.useMemo)((()=>null!==L&&void 0!==L&&L.summary?{totalEnrollments:L.summary.totalEvents}:{totalEnrollments:0}),[L]),oe=(new Date).getFullYear(),se=Y,de=()=>{var e;null!==q&&void 0!==q&&null!==(e=q.programs)&&void 0!==e&&e.programs&&null!==Q&&void 0!==Q&&Q.id&&ee()},me=window.location.origin,pe=[{title:"Import Data",description:"Transfer data into the system.",link:`${me}/sims-web-import-export/#/import`,isExpandable:!0,type:"import",icon:r.createElement(E.Z,null),color:"#4f46e5"},{title:"Export Data",description:"Transfer data out of the system.",link:`${me}/sims-web-import-export/#/export`,isExpandable:!0,type:"export",icon:r.createElement(_.Z,null),color:"#059669"},{title:"Forms Programs",description:"Access structured forms for data collection.",link:`${me}/sims-web-capture/`,icon:r.createElement(C.Z,null),color:"#4f46e5"},{title:"Spreadsheets Programs",description:"Input and manage data using Excel-like grids.",link:`${me}/sims-web-aggregate-data-entry/`,icon:r.createElement(y.Z,null),color:"#ea580c"},{title:"Thematic Areas",description:"View thematic areas",link:`${me}/sims-web-maintenance/#/list/organisationUnitSection/organisationUnit`,icon:r.createElement(S.Z,null),color:"#ea580c"},{title:"Visualize",description:"Interact with visualizations and reports",link:"https://metabase-prod-890193357774.us-central1.run.app/",icon:r.createElement(h.Z,null),color:"#ea580c",isExternal:!0}],ue=[{title:"Import Spreadsheets Data",link:`${me}/sims-web-import-export/#/import/data`},{title:"Import Forms Data",link:`${me}/sims-web-import-export/#/import/event`},{title:"Import Metadata",link:`${me}/sims-web-import-export/#/import/metadata`}],ve=[{title:"Export Spreadsheets",link:`${me}/sims-web-import-export/#/export/data`},{title:"Export Forms Data",link:`${me}/sims-web-import-export/#/export/event`},{title:"Export Metadata",link:`${me}/sims-web-import-export/#/export/metadata`}],ge=e=>{e.isExpandable?"import"===e.type?(o((e=>!e)),s&&d(!1)):"export"===e.type&&(d((e=>!e)),c&&o(!1)):e.isExternal?window.open(e.link,"_blank","noopener,noreferrer"):window.location.href=e.link};return r.createElement("div",{className:O.container},se&&r.createElement("div",{className:O.loader},r.createElement(N.V,{small:!0})),r.createElement("div",{className:O.header},r.createElement("div",{className:O.headerContent},r.createElement("div",{className:O.headerText},r.createElement("p",{className:O.pageSubtitle},r.createElement("h1",null,"Welcome back, ",(null===q||void 0===q||null===(e=q.currentUser)||void 0===e||null===(t=e.name)||void 0===t?void 0:t.split(" ")[0])||"User"),Q&&r.createElement("span",{style:{fontSize:"12px",color:"#666",display:"block"}},"Project: ",Q.name," (ID: ",Q.id,")"),j&&r.createElement("span",{style:{fontSize:"10px",color:"#999",display:"block"}},"Data updated: ",j.toLocaleString()," (Auto-refresh: hourly)"))),r.createElement("div",{className:O.userInfo},r.createElement(m.z,{small:!0,secondary:!0,onClick:de,disabled:W,style:{marginRight:"8px"}},r.createElement(f.Z,null),W?"Collecting...":"Refresh Data")))),W&&r.createElement(w.Z,{style:{margin:"1rem 0",padding:"1rem"}},r.createElement("div",{style:{display:"flex",alignItems:"center",gap:"1rem"}},r.createElement(N.V,{small:!0}),r.createElement("div",null,r.createElement("div",{style:{fontWeight:"bold"}},"Collecting Program Data... (",K.current,"/",K.total,")"),r.createElement("div",{style:{fontSize:"12px",color:"#666"}},K.programName),K.total>0&&r.createElement("div",{style:{width:K.current/K.total*100+"%",height:"100%",backgroundColor:"#4f46e5",borderRadius:"2px",transition:"width 0.3s ease"}})))),V&&r.createElement(w.Z,{style:{margin:"1rem 0",padding:"1rem",backgroundColor:"#fff3cd",border:"1px solid #ffeaa7"}},r.createElement("div",{style:{color:"#856404"}},r.createElement("strong",null,"Data Collection Error:")," ",V,r.createElement(m.z,{small:!0,secondary:!0,onClick:de,style:{marginLeft:"1rem"}},"Retry"))),r.createElement("div",{className:O.mainGrid},r.createElement("div",{className:O.leftColumn},r.createElement("div",{className:O.quickActionsContainer},r.createElement("div",{className:O.sectionHeader},r.createElement("h3",{className:O.sectionTitle},"Quick Actions")),r.createElement("div",{className:O.cardGrid},pe.map((e=>r.createElement("div",{key:e.title,className:O.cardWrapper},r.createElement(w.Z,{className:O.navCard},r.createElement("div",{className:O.cardContent,role:"button",tabIndex:0,onClick:()=>ge(e),onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||ge(e)},style:{cursor:"pointer"}},r.createElement("div",{className:O.cardIconWrapper,style:{backgroundColor:`${e.color}15`,color:e.color}},e.icon),r.createElement("div",{className:O.cardTextContent},r.createElement("h3",{className:O.cardTitle},e.title),r.createElement("p",{className:O.cardDescription},e.description)),e.isExpandable&&r.createElement("div",{className:O.expandIcon},"import"===e.type&&c||"export"===e.type&&s?r.createElement(b.Z,null):r.createElement(T.Z,null))),"import"===e.type&&c&&r.createElement("div",{className:O.expandableContent},r.createElement(k.i,null),r.createElement("div",{className:O.linkGrid},ue.map((e=>r.createElement("a",{key:e.title,href:e.link,className:O.linkItem},e.title))))),"export"===e.type&&s&&r.createElement("div",{className:O.expandableContent},r.createElement(k.i,null),r.createElement("div",{className:O.linkGrid},ve.map((e=>r.createElement("a",{key:e.title,href:e.link,className:O.linkItem},e.title))))))))))),ce&&r.createElement("div",{className:O.performanceOverview},r.createElement("div",{className:O.sectionHeader},r.createElement("h3",{className:O.sectionTitle},"Performance Overview")),r.createElement("div",{className:O.metricsGrid},r.createElement("div",{className:O.metricCard},r.createElement("div",{className:O.metricIcon,style:{backgroundColor:"#eff6ff",color:"#2563eb"}},r.createElement(I.Z,null)),r.createElement("div",{className:O.metricContent},r.createElement("span",{className:O.metricValue},ce.totalEnrollments.toLocaleString()),r.createElement("span",{className:O.metricLabel},"Total Events (",oe,")"))))),r.createElement("div",{className:O.activityContainer},r.createElement("div",{className:O.activityHeader},r.createElement("div",{className:O.activityTitleWrapper},r.createElement("div",{className:O.activityIconWrapper},r.createElement(x.Z,null)),r.createElement("h3",{className:O.activityTitle},"Recent Activity")),r.createElement(m.z,{small:!0,secondary:!0},"View All")),r.createElement(k.i,null),r.createElement("div",{className:O.activityContent},ae?r.createElement("div",{className:O.activityLoader},r.createElement(N.V,{small:!0})):r.createElement("div",{className:O.activityList},null===re||void 0===re||null===(a=re.recentEvents)||void 0===a||null===(i=a.events)||void 0===i?void 0:i.slice(0,5).map((e=>{var t,a;const n=null===q||void 0===q||null===(t=q.programs)||void 0===t||null===(a=t.programs)||void 0===a?void 0:a.find((t=>t.id===e.program)),i=(null===n||void 0===n?void 0:n.name)||"Unknown Program";return r.createElement("div",{key:e.event,className:O.activityItem},r.createElement("div",{className:O.activityItemIcon},r.createElement(C.Z,null)),r.createElement("div",{className:O.activityItemContent},r.createElement("div",{className:O.activityItemHeader},r.createElement("span",{className:O.activityType},"COMPLETED"===e.status?"Event Completed":"Event Created"),r.createElement("span",{className:O.activityTime},(e=>{const t=new Date,a=new Date(e),r=Math.floor((t-a)/6e4);return r<1?"Just now":r<60?`${r}m ago`:r<1440?`${Math.floor(r/60)}h ago`:`${Math.floor(r/1440)}d ago`})(new Date(e.eventDate)))),r.createElement("p",{className:O.activityDescription},i," - Event ",e.event.substring(0,8),"...")),r.createElement("div",{className:`${O.activityStatus} ${"COMPLETED"===e.status?O.success:O.active}`}))})),r.createElement("div",{className:O.activityItem},r.createElement("div",{className:O.activityItemIcon},r.createElement(I.Z,null)),r.createElement("div",{className:O.activityItemContent},r.createElement("div",{className:O.activityItemHeader},r.createElement("span",{className:O.activityType},"System Status"),r.createElement("span",{className:O.activityTime},"Just now")),r.createElement("p",{className:O.activityDescription},ce.totalEnrollments," total events across ",(null===L||void 0===L||null===(l=L.summary)||void 0===l?void 0:l.totalPrograms)||0," programs")),r.createElement("div",{className:`${O.activityStatus} ${O.success}`}))))),r.createElement("div",{className:O.distributionContainer},r.createElement("div",{className:O.sectionHeader},r.createElement("h3",{className:O.sectionTitle},"Program Distribution")),r.createElement("div",{className:O.chartsContainer},r.createElement(w.Z,{className:O.chartCard},r.createElement("div",{className:O.chartHeader},r.createElement("h4",{className:O.chartTitle},"Program Events ",oe),r.createElement(m.z,{small:!0,secondary:!0,onClick:()=>u("enrollments")},"Expand")),r.createElement(k.i,null),r.createElement("div",{className:O.chartContent},r.createElement(D.h,{width:"100%",height:350},r.createElement($.v,{data:le,margin:{top:48,right:24,left:16,bottom:60}},r.createElement(Z.q,{strokeDasharray:"3 3"}),r.createElement(A.K,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),r.createElement(R.B,null),r.createElement(z.u,{formatter:(e,t,a)=>{var n,i;const l=null===(n=a.payload)||void 0===n?void 0:n.organisationUnits;return[r.createElement("div",{key:"tooltip"},r.createElement("div",null,`Events: ${e}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"}},`Projects: ${null===l||void 0===l?void 0:l.slice(0,3).join(", ")}${(null===l||void 0===l?void 0:l.length)>3?` and ${l.length-3} more...`:""}`),r.createElement("div",{style:{fontSize:"12px",marginTop:"4px"}},`Type: ${ie[null===(i=a.payload)||void 0===i?void 0:i.programType]||"Other"}`))]},labelFormatter:e=>`Program: ${e}`}),r.createElement(M.D,{layout:"horizontal",verticalAlign:"top",align:"center",wrapperStyle:{paddingBottom:8,fontSize:16}}),Object.entries(ne).map((e=>{let[t,a]=e;return r.createElement(P.$,{key:t,dataKey:"enrollments",name:ie[t],fill:a,isAnimationActive:!1,data:le.filter((e=>e.programType===t)),barSize:25})})))))))))),p?r.createElement("div",{className:O.chartModal,onClick:()=>u(null)},r.createElement("div",{className:O.chartModalContent,onClick:e=>e.stopPropagation()},r.createElement("div",{className:O.chartModalHeader},r.createElement("h3",{className:O.chartModalTitle},"Program Events"),r.createElement(m.z,{small:!0,secondary:!0,onClick:()=>u(null)},"Close")),r.createElement("div",{className:O.chartModalBody},r.createElement(D.h,{width:"100%",height:600},r.createElement($.v,{data:le,margin:{top:48,right:24,left:16,bottom:60}},r.createElement(Z.q,{strokeDasharray:"3 3"}),r.createElement(A.K,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),r.createElement(R.B,null),r.createElement(z.u,{formatter:(e,t,a)=>{var n,i;const l=null===(n=a.payload)||void 0===n?void 0:n.organisationUnits;return[r.createElement("div",{key:"tooltip"},r.createElement("div",null,`Events: ${e}`),r.createElement("div",{style:{fontSize:"12px",color:"#666",marginTop:"4px"}},`Projects: ${null===l||void 0===l?void 0:l.slice(0,3).join(", ")}${(null===l||void 0===l?void 0:l.length)>3?` and ${l.length-3} more...`:""}`),r.createElement("div",{style:{fontSize:"12px",marginTop:"4px"}},`Type: ${ie[null===(i=a.payload)||void 0===i?void 0:i.programType]||"Other"}`))]},labelFormatter:e=>`Program: ${e}`}),r.createElement(M.D,{layout:"horizontal",verticalAlign:"top",align:"center",wrapperStyle:{paddingBottom:8,fontSize:16}}),Object.entries(ne).map((e=>{let[t,a]=e;return r.createElement(P.$,{key:t,dataKey:"enrollments",name:ie[t],fill:a,isAnimationActive:!1,data:le.filter((e=>e.programType===t)),barSize:25})}))))))):null)}var U=a(6585),W=a(31813),G=a(69987),V=a(29989),F=a(25435);function j(){return r.createElement("div",{className:"column h-100"},r.createElement("div",{className:"row p-16"}),r.createElement("div",{style:{padding:"0 16px"}},r.createElement(L,null)))}var B=a(44464),K=a(13488),J=a(34504);function Y(e){let{keyword:t}=e;return r.createElement("div",{className:"h-100 w-100"},r.createElement(B.M,null,r.createElement("div",{className:"column center align-items-center"},r.createElement(J.Z,{style:{color:K.O.grey700,fontSize:64}}),r.createElement("h2",{"data-test":"no-scorecards-found-title",style:{color:K.O.grey700,margin:8}},l.Z.t("No scorecards found")),r.createElement("p",{style:{color:K.O.grey700,margin:4}},l.Z.t("Could not find scorecards matching the keyword "),r.createElement("b",null,`'${t}'`)))))}var q=a(98132);function Q(e){let{scorecard:t,grid:a}=e;const i=(0,F.useSetRecoilState)(U.RouterState),{write:c,delete:s}=(0,F.useRecoilValue)((0,U.UserAuthorityOnScorecard)(null===t||void 0===t?void 0:t.id)),{title:d,description:p,id:u}=t,[v,g]=(0,r.useState)(!1),E=(0,V.k6)(),{remove:_}=(0,U.useDeleteScorecard)(u),{show:C}=(0,n.VY)((e=>{let{message:t}=e;return t}),(e=>{let{type:t}=e;return{...t,duration:3e3}})),{confirm:y}=(0,q.WK)(),S=()=>{i((e=>({...e,previous:"/"}))),E.push(`/view/${u}`)},h=()=>{c&&(i((e=>({...e,previous:"/"}))),E.push(`/edit/${u}`))},N=(e,t)=>{t.stopPropagation(),y({title:l.Z.t("Confirm scorecard delete"),message:r.createElement("p",null,l.Z.t("Are you sure you want to delete scorecard "),":",r.createElement("b",null,d)),onCancel:()=>{},onConfirm:()=>{(async()=>{if(s){try{await _()}catch(e){C({message:e.message,type:{info:!0}})}C({message:l.Z.t("Scorecard deleted successfully"),type:{success:!0}})}})()}})};return a?r.createElement("div",{className:"container-bordered p-16 ","data-test":"scorecard-thumbnail-view",style:{margin:16,background:"white"},onClick:S},r.createElement("div",{className:"column space-between h-100"},r.createElement("div",{className:"text-center p-8"},r.createElement("img",{alt:"img",src:U.ScorecardCardImage,style:{height:100,width:200}})),r.createElement("div",{className:"flex-1 column align-items-center"},r.createElement("h4",{className:"scorecard-list-card-title"},d),r.createElement("p",{className:"scorecard-list-card-description",style:{color:K.O.grey700}},(null===p||void 0===p?void 0:p.length)>100?r.createElement("div",{onClick:e=>{e.stopPropagation(),g((e=>!e))},className:"row space-between align-content-end"},v?p:(0,U.truncateDescription)(p)):p)),r.createElement("div",{style:{margin:"0 8px"}},r.createElement(o.J,{middle:!0},r.createElement(m.z,{onClick:S},l.Z.t("View")),c&&r.createElement(m.z,{dataTest:"edit-scorecard-button",onClick:function(e,t){t.stopPropagation(),h()}},l.Z.t("Edit")),s&&r.createElement(m.z,{dataTest:"scorecard-delete-button",onClick:N},l.Z.t("Delete")))))):r.createElement("div",{"data-test":"scorecard-thumbnail-view",className:"container-bordered p-32",style:{margin:16,background:"white"},onClick:S},r.createElement("div",{className:"row space-between align-items-center"},r.createElement("div",{className:"row align-items-center"},r.createElement("div",null,r.createElement("img",{alt:"img",src:U.ScorecardCardImage,style:{height:100,width:200}})),r.createElement("div",{className:"column start"},r.createElement("h4",{className:"scorecard-list-card-title"},d),r.createElement("p",{className:"scorecard-list-card-description",style:{color:K.O.grey700}},(null===p||void 0===p?void 0:p.length)>100?r.createElement("div",{onClick:e=>{e.stopPropagation(),g((e=>!e))},className:"row space-between align-content-end"},v?p:(0,U.truncateDescription)(p)):p))),r.createElement("div",{className:"row end"},r.createElement(o.J,{middle:!0},r.createElement(m.z,{onClick:S},l.Z.t("View")),c&&r.createElement(m.z,{dataTest:"edit-scorecard-button",onClick:function(e,t){t.stopPropagation(),h()}},l.Z.t("Edit")),s&&r.createElement(m.z,{dataTest:"scorecard-delete-button",onClick:N},l.Z.t("Delete"))))))}function X(e){let{scorecards:t}=e;return r.createElement("div",{className:"scorecard-list-container grid p-32"},null===t||void 0===t?void 0:t.map((e=>r.createElement(Q,{grid:!0,key:e.id,scorecard:e}))))}var ee=a(89020),te=a(13414);function ae(){const e=(0,F.useSetRecoilState)(U.HelpState);return r.createElement(ee.q,null,r.createElement(te.s,{onClick:()=>{e(!0)},label:l.Z.t("Start a guided tour")}),r.createElement(te.s,{onClick:()=>{const e=window.open();e.opener=null,e.target="_blank",e.location=U.SCORECARD_DOCUMENTATION_URL},label:l.Z.t("Documentation")}))}function re(e){let{scorecards:t}=e;return r.createElement("div",{className:"column"},null===t||void 0===t?void 0:t.map((e=>r.createElement(Q,{scorecard:e,key:null===e||void 0===e?void 0:e.id,grid:!1}))))}var ne=a(44520);function ie(e){let{pageSize:t=8,scorecards:a=[],listComponent:n}=e;const[i,l]=(0,r.useState)(0),c=(0,r.useMemo)((()=>(0,G.chunk)(a,t)),[a,t]),o=n;return r.createElement("div",{className:"p-16 scorecard-list"},r.createElement(o,{scorecards:c[i]}),c.length>1&&r.createElement("div",{className:"p-16"},r.createElement(ne.t,{hidePageSizeSelect:!0,total:a.length,pageCount:c.length,pageSize:t,page:i+1,onPageChange:e=>{l(e-1)},onPageSizeChange:()=>{}})))}function le(){const e=(0,F.useResetRecoilState)(U.ScorecardIdState),t=(0,F.useSetRecoilState)(U.RouterState),[a,E]=(0,F.useRecoilState)(U.HelpState),_=(0,V.k6)(),[C,{set:y}]=(0,i.yu)("scorecardViewType"),S=(0,F.useRecoilValue)(U.ScorecardSummaryState),[h,N]=(0,r.useState)(),[f,w]=(0,r.useState)(S),{show:b}=(0,n.VY)((e=>{let{message:t}=e;return t}),(e=>{let{type:t}=e;return{...t,duration:3e3}})),T=(0,r.useRef)((0,G.debounce)((e=>{w((()=>S.filter((t=>{let{id:a,title:r,description:n,additionalLabels:i}=t;const l=`${a} ${r} ${n}`.toLowerCase();return Array.isArray(i)&&i.length>0&&l.concat(i.join(" ").toLowerCase()),"string"===typeof i&&l.concat(i.toLowerCase()),l.includes(e.toLowerCase())}))))})));(0,r.useEffect)((()=>{h?T.current(h):w(S)}),[h,S]);return r.createElement(r.Suspense,{fallback:r.createElement(U.FullPageLoader,null)},r.createElement(W.Rg,{options:U.STEP_OPTIONS,enabled:a,steps:U.SCORECARD_LIST_HELP_STEPS,onExit:()=>{E(!1)},initialStep:0}),(0,G.isEmpty)(S)?r.createElement(j,null):r.createElement("div",{className:"column h-100"},r.createElement("div",{className:"row p-16"},r.createElement("div",{className:"row p-45 center",style:{paddingLeft:"35%"}},r.createElement("div",{className:"column w-30"},r.createElement(c.I,{className:"search-input",value:h,onChange:e=>{let{value:t}=e;N(t)},placeholder:l.Z.t("Search")}))),r.createElement("div",{className:"w-100"},r.createElement(o.J,{end:!0},r.createElement(s.P,{type:"button",component:r.createElement(ae,null),icon:r.createElement(u.Z,null)},l.Z.t("Help")),r.createElement(d.u,{content:l.Z.t("Switch to {{viewType}} view",{viewType:"grid"===C?l.Z.t("list"):l.Z.t("grid")})},r.createElement(m.z,{onClick:()=>{try{if("grid"===C)return void y("list");y("grid")}catch(t){var e;b({message:null!==(e=t.message)&&void 0!==e?e:t.toString(),type:{critical:!0}})}},className:"change-view-button",dataTest:"scorecard-view-orientation",icon:"grid"===C?r.createElement(v.Z,null):r.createElement(g.Z,null)})),r.createElement(m.z,{dataTest:"new-scorecard-button",className:"add-scorecard-button",onClick:()=>{e(),t((e=>({...e,previous:"/"}))),_.push("/add")},primary:!0,icon:r.createElement(p.Z,null)},l.Z.t("Add New Scorecard"))))),r.createElement("div",{style:{padding:"0 16px"}},r.createElement(L,null)),(0,G.isEmpty)(f)?r.createElement("div",{className:"flex-1"},r.createElement(Y,{keyword:h})):r.createElement(ie,{scorecards:f,pageSize:"grid"===C?8:5,listComponent:"grid"===C?X:re})))}function ce(){return function(){const[e]=(0,i.yu)(U.DATA_MIGRATION_CHECK,{global:!0}),t=(0,V.k6)();(0,r.useEffect)((()=>{e||t.replace("/migrate")}),[t,e])}(),r.createElement(le,null)}}}]);
//# sourceMappingURL=8808.919b8391.chunk.js.map